var Scroll=!1,Height=$(document).height(),title="",user,pw,status,username,mailfrom,mailto,msg,config,usrconfig="",configlang,xtitle=document.title,slider,slider2,dialogs=[],waitdialog,messid=0,appstate={first:!0,pushurl:""!=location.pathname?!1:!0},results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{}},searchvals={text:"",last:"","package":1,inittext:"",initfacets:{}},facetvals={datapool:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",typ:"total",formats:{}},statevals={ppnlist:[],
language:"",layout:"",theme:""},favors={},favormails={},idleTimer,time2warn=1080,time2kill=120,timer=!1,urlport=location.protocol+"//";$.cookie("theme")&&$("[rel='"+$.cookie("theme")+"']").parent().addClass("active");$.is_Empty=function(a){if(null==a)return!0;if(0<a.length)return!1;if(0===a.length||"object"!==typeof a)return!0;for(var b in a)if(hasOwnProperty.call(a,b))return!1;return!0};
$.load_config=function(){$.post("/ajax/config",function(a){config=a;$.set_language(config.language,!0);time2warn=60*config.time2warn;time2kill=60*config.time2kill;0==!usrconfig&&(timer=!0,$.startTimer());$.is_Empty(searchvals.initfacets)?facetvals.datapool=config.datapool:(facetvals=searchvals.initfacets,searchvals.initfacets={});$(".facetpool").parents(".dropdown").find(".btn").val(facetvals.datapool);"local"==facetvals.datapool.toLowerCase()?($(".datapoollocal").removeClass("hide"),$(".datapoolglobal").addClass("hide")):
($(".datapoollocal").addClass("hide"),$(".datapoolglobal").removeClass("hide"));""!=searchvals.inittext&&$.when($.new_search("initfacets",searchvals.inittext)).done(function(){searchvals.inittext=""})},"JSON")};
$.user_message=function(a,b,c){void 0==c&&(c=3E3);var e=0<dialogs.length?dialogs[dialogs.length-1].getData("name"):0<results.hits?"results":"statusbar",d="success"==b?"panel-success":"panel-danger";messid++;$("#"+e+"_messagebar").append($("<div id='message"+messid+"' class='alert-message "+b+"' data-alert></div>"));$("#message"+messid).hide().html("<div class='panel "+d+"'><div class='panel-heading'>"+a+"</div></div>").fadeIn("fast");$("#message"+messid).delay(c).fadeOut("slow",function(){$(this).remove()})};
$.focus_first=function(){768<=$(window).width()?$('[type="text"]:input:enabled:visible:first').focus():$("button:enabled:visible:first").focus()};
$.set_facet=function(a,b,c){"datapool"==a&&(facetvals={datapool:c,yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",typ:"total",formats:{}},$.new_search("init",searchvals.text));"year"==a&&($(".num_TYPTOTAL").html(""),$(".num_TYPPRINT").html(""),$(".num_TYPELECTR").html(""),$('input[name="facetonline"][value=total]').prop("checked",!0),facetvals.typ="total",facetvals.formats={},$(".numformat").html(""),$("input.facetformat:checkbox").attr("checked",!1),$.new_search("facet_year"));
"typ"==a&&(facetvals[a]=b,facetvals.formats={},$(".numformat").html(""),$("input.facetformat:checkbox").attr("checked",!1),$.new_search("facet_typ"));"format"==a&&(c?(facetvals.formats[b]=c,$.new_search("facet_format_checked")):(delete facetvals.formats[b],$.new_search("facet_format_unchecked")))};$.link_search=function(a,b){""!=b&&(""!=a&&(b=a+':"'+b+'"'),$.close_dialogs(),$.new_search("link",b))};
$.push_state=function(){if(appstate.pushurl||appstate.first){if(0<=searchvals.text.search(":"))var a=searchvals.text.split(":"),b=a[0],a=a[1];else b="",a=searchvals.text;var c=$.is_Empty(statevals)?{facetvals:facetvals,statevals:{language:config.language,theme:config.theme,layout:config.layout,ppnlist:{}}}:{facetvals:facetvals,statevals:{language:config.language,theme:config.theme,layout:config.layout,ppnlist:statevals.ppnlist}};"*"==a&&(a="{star}");var e=urlport+window.location.host+"/"+encodeURIComponent(a),
e=e+(""!=b?"/"+b:"/{}")+("/"+window.btoa(unescape(encodeURIComponent(JSON.stringify(c)))));appstate.first?(window.history.replaceState({text:searchvals.text,facets:facetvals,states:statevals},a+" | "+xtitle,e),appstate.first=!1):window.history.pushState({text:searchvals.text,facets:facetvals,states:statevals},a+" | "+xtitle,e)}};$.navbar_search=function(a){a=$(a).val();$.new_search("init",a)};
$.new_search=function(a,b){if("facet_"!=a.substr(0,6).toLowerCase()){searchvals.last=searchvals.text;searchvals.text=void 0==b||""==b?"*":b.trim();if("cmd:"==searchvals.text.substr(0,4).toLowerCase()){$.command(searchvals.text.substr(4));$("#searchtext_xs").val(searchvals.last);$("#searchtext_md").val(searchvals.last);searchvals.text=searchvals.last;$.focus_first();return}$("#searchtext_xs").val(searchvals.text);$("#searchtext_md").val(searchvals.text);"initfacets"!=a&&(facetvals.yearrange="",facetvals.yearmin=
"",facetvals.yearmax="",facetvals.yearminstart="",facetvals.yearmaxstart="",facetvals.typ="total",facetvals.formats={},$("#hiddenyearstart").val(""),$("#hiddenyearend").val(""))}Scroll=!1;searchvals["package"]=1;$.open_wait();$.search_results(a,function(){0==results.hits&&$.user_message(configlang.NOHITS,"warning");$.close_wait();document.title=searchvals.text+" | "+xtitle;$.push_state();appstate.pushurl=!0;$.focus_first()});return $.Deferred().resolve()};
$.search_next_pack=function(a){Scroll=!1;$("#loading").removeClass("hideLoading").addClass("displayLoading");searchvals["package"]++;$.search_results("adddata",function(){$("#loading").removeClass("displayLoading").addClass("hideLoading");a()})};
$.search_results=function(a,b){$.ajax({url:"/ajax/search/",method:"POST",data:{search:searchvals.text,"package":searchvals["package"],facets:JSON.stringify(facetvals)},dataType:"JSON",success:function(c){results.hits=c.hits;results.hitspack=c.hitspack;results.qtime=c.qtime;$(".TOTALRECS").html($.format_hits(results.hits));2<=searchvals["package"]?(results.ppnlist=results.ppnlist.concat(jQuery.map(c.ppnlist,function(a,b){return a.toString()})),results.hitscurr=results.ppnlist.length,$("#resultsonly").append(c.results).fadeIn("fast"),
50<=results.hitspack?$("#loading").fadeIn("fast").removeClass("collapse"):$("#loading").fadeOut("fast").addClass("collapse")):(window.scrollTo(0,0),results.ppnlist=jQuery.map(c.ppnlist,function(a,b){return a.toString()}),results.hitscurr=results.ppnlist.length,0==results.hitspack?"facet_"!=a.substr(0,6).toLowerCase()?($("#results").fadeOut("fast").addClass("collapse"),$("#loading").fadeOut("fast").addClass("collapse"),$("#start").fadeIn("fast").removeClass("collapse"),$("#btn_facets").addClass("hidden-xs"),
$("#statusbar").removeClass("collapse"),$("#version_start").fadeIn("fast").removeClass("collapse"),$("#version_search").fadeOut("fast").addClass("collapse")):$("#resultsonly").fadeOut("fast",function(){$("#statusbar").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$.number_facets(c,a);$("#resultsonly").fadeIn("fast").removeClass("collapse")}):($(".alert-message").remove(),$("#statusbar").addClass("collapse"),$("#start").fadeOut("fast").addClass("collapse"),
$("#version_start").fadeOut("fast").addClass("collapse"),$("#version_search").fadeIn("fast").removeClass("collapse"),"facet_"!=a.substr(0,6).toLowerCase()?$("#results").fadeOut("fast",function(){$("#resultsonly").html(c.results);$.create_facets(c);$("#facets").fadeIn("fast").removeClass("collapse");$("#results").fadeIn("fast").removeClass("collapse")}):$("#resultsonly").fadeOut("fast",function(){$("#resultsonly").html(c.results);$.number_facets(c,a);$("#resultsonly").fadeIn("fast").removeClass("collapse")}),
50<=results.hitspack?$("#loading").fadeIn("fast").removeClass("collapse"):$("#loading").fadeOut("fast").addClass("collapse"),$("#btn_facets").removeClass("hidden-xs")));Scroll=!1;50==results.hitspack&&(Scroll=!0);b()}})};
$.opened_fullview=function(a,b){(0<$("#general_"+b).find("#linkresolver_"+b).length||0<$("#general_"+b).find("#linkresolvercontainer_"+b).length)&&$.when($.ajax({url:"/ajax/linkresolver/",method:"POST",data:{ppn:a},dataType:"JSON"})).then(function(a){var e="";$.each(a,function(a,b){e+="<a href='"+b+"' target='_"+a+"'><button class='col-xs-12 col-sm-6 col-md-4 btn btn-default btn-exemplar'>Volltext ("+configlang[a.toUpperCase()]+")</button></a>"});""!=e&&(0<$("#linkresolvercontainer_"+b).parent().length?
$("#linkresolvercontainer_"+b).html("<div>"+configlang.ACCESS+"</div><div class='container-fluid'><div class='row'>"+e+"</div></div>"):$("#linkresolver_"+b).html(e))});$.when($.ajax({url:"/ajax/searchsimularpubs/",method:"POST",data:{ppn:a},dataType:"JSON"})).then(function(a){0<a.hitspack?$("#simularpubscontent_"+b).html(a.results):$("#simularpubscontent_"+b).html("<div class='col-xs-12'><div class='well'>"+configlang.NOSIMULARHITS+"</div></div>")});$.when($.ajax({url:"/ajax/exportlink/",method:"POST",
data:{ppnlist:JSON.stringify(a),format:"zotero"},dataType:"JSON"})).then(function(a){$.each(a,function(a,b){$(".Z3988").attr("title",b)})})};$.correctCover=function(a,b){a.onerror="";$(a).replaceWith("<span class='gbvicon'>"+b+"</span>")};
$.create_facets=function(a){facetvals.yearmin=parseInt(a.yearmin);facetvals.yearmax=parseInt(a.yearmax);if(facetvals.yearmin<facetvals.yearmax&&""!=facetvals.yearmin&&void 0!=facetvals.yearmin&&""!=facetvals.yearmax&&void 0!=facetvals.yearmax){var b={range:{min:facetvals.yearmin,max:facetvals.yearmax},start:[facetvals.yearmin,facetvals.yearmax],connect:!0,behaviour:"drag",step:1};facetvals.yearminstart=facetvals.yearmin;facetvals.yearmaxstart=facetvals.yearmax;"undefined"!=typeof slider&&slider.noUiSlider.destroy();
slider=document.getElementById("pubyear");noUiSlider.create(slider,b);slider.noUiSlider.on("update",function(a,b){$(".yearstart").html(Math.floor(a[0]));$(".yearend").html(Math.floor(a[1]));$(".yearstart2").html(Math.floor(a[0]));$(".yearend2").html(Math.floor(a[1]))});slider.noUiSlider.on("change",function(a,b){facetvals.yearminstart=Math.floor(a[0]);facetvals.yearmaxstart=Math.floor(a[1]);facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]";$.set_facet("year","",facetvals.yearrange)});
$(".FACETYEARTOTAL").fadeIn("fast").removeClass("collapse")}else $(".FACETYEARTOTAL").fadeOut("fast").addClass("collapse");$("#onlines").html("");b=parseInt(a.online["true"])+parseInt(a.online["false"]);$("#onlines").append("<div class='radio'><label><input class='facettyp' name='facetonline' class='TYPTOTAL'  value='total' type='radio' checked=checked><span class='lbl_TYPTOTAL'>"+configlang.TYPTOTAL+"</span></label><span class='num_TYPTOTAL numtyp badge counter pull-right'>"+b+"</span></div>");$("#onlines").append("<div class='radio'><label><input class='facettyp' name='facetonline' class='TYPPRINT'  value='false' type='radio'><span class='lbl_TYPPRINT'>"+
configlang.TYPPRINT+"</span></label><span class='num_TYPPRINT numtyp badge counter pull-right'>"+a.online["false"]+"</span></div>");$("#onlines").append("<div class='radio'><label><input class='facettyp' name='facetonline' class='TYPELECTR' value='true'  type='radio'><span class='lbl_TYPELECTR'>"+configlang.TYPELECTR+"</span></label><span class='num_TYPELECTR numtyp badge counter pull-right'>"+a.online["true"]+"</span></div>");$(".facettyp").change(function(){$.set_facet("typ",$(this).val(),this.checked)});
$(".datapool").change(function(){$.set_facet("datapool",$(this).val(),this.checked)});var c="";$.each(a.formats,function(a,b){c+="<div class='checkbox'><label><input class='facetformat' id='"+a.replace(/ /g,"")+"' value='"+a+"' type='checkbox'><span class='lbl_"+a.replace(/ /g,"")+"'>"+configlang[a.replace(/ /g,"").toUpperCase()]+"</span></label><span class='num_"+a.replace(/ /g,"")+" numformat badge counter pull-right'>"+b+"</span></div>"});$("#formats").html(c);$(".facetformat").change(function(){$.set_facet("format",
$(this).val(),this.checked)})};$.number_facets=function(a,b){void 0!=a&&("facet_year"==b.toLowerCase()&&($(".num_TYPTOTAL").html(a.online.total),$(".num_TYPPRINT").html(a.online["false"]),$(".num_TYPELECTR").html(a.online["true"])),"facet_format_checked"!=b.toLowerCase()&&"facet_format_unchecked"!=b.toLowerCase()&&($(".numformat").html(""),0<Object.keys(a.formats).length&&$.each(a.formats,function(a,b){$(".num_"+a.replace(/ /g,"")).html(b)})))};
$.format_hits=function(a){return 1E6<a?String(Math.round(a/1E4)/100).replace(".",",")+" Mio. ":1E3<a?String(Math.round(a/10)/100).replace(".",",")+" Tsd. ":a};$.command=function(a){$.post("/ajax/command",{cmd:a},function(b){$.user_message("Befehl "+a+" erfolgreich ausgef&uuml;hrt","success");$.focus_first()},"json")};
$.open_fullview=function(a,b,c,e){void 0===b&&(b=results.ppnlist);void 0===e&&(e=a);void 0===c&&(c="main");"main"!=c&&(b=jQuery.map(b,function(a,b){return a.toString()}));var d=dialogs.length,f=a in favors?configlang.CHECKLISTREMOVE:configlang.CHECKLIST,g=a in favors?"fa fa-star-o":"fa fa-star",h="publications"==c?$("#related_"+e).html():$("#"+e+" div.panel-heading").html(),l=new BootstrapDialog({message:$('<div id="fullbody_'+d+'"></div>').load("/ajax/fullview/"+a+"/"+d),title:h,size:BootstrapDialog.SIZE_WIDE,
closable:!0,buttons:[{id:"prevbtn",icon:"glyphicon glyphicon-chevron-left",cssClass:"btn-default fullview-button-left",action:function(e){0<b.indexOf(a)?(a=b[b.indexOf(a)-1],$("#fullbody_"+d).slideUp("fast","swing",function(){$("#fullbody_"+d).load("/ajax/fullview/"+a+"/"+d,function(){"publications"==c?e.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):e.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+d).slideDown("fast");
var b=e.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,d)})})):$.user_message(configlang.FIRSTOBJECT,"warning")}},{id:"nextbtn",icon:"glyphicon glyphicon-chevron-right",cssClass:"btn-default fullview-button-left",action:function(e){"main"==
c&&b.indexOf(a)<results.hits-1&&b.indexOf(a)==results.hitscurr-1?$.search_next_pack(function(){b=results.ppnlist;a=b[b.indexOf(a)+1];$("#fullbody_"+d).slideUp("fast","swing",function(){$("#fullbody_"+d).load("/ajax/fullview/"+a+"/"+d,function(){"publications"==c?e.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):e.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+d).slideDown("fast");var b=e.getModalFooter().find(".checklist");
a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,d)})})}):b.indexOf(a)<b.length-1?(a=b[b.indexOf(a)+1],$("#fullbody_"+d).slideUp("fast","swing",function(){$("#fullbody_"+d).load("/ajax/fullview/"+a+"/"+d,function(){"publications"==c?e.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+
a).html()):e.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+d).slideDown("fast");var b=e.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,d)})})):$.user_message(configlang.LASTOBJECT,
"warning")}},{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-envelope",label:" "+configlang.MAIL,action:function(b){favormails[a]=$("#mail_"+d).wrap("<p/>").parent().html();""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail([a])}):$.open_mail([a])}},{icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,action:function(b){$.open_export([a])}},{icon:g,cssClass:"btn-default checklist",
label:' <span class="text">'+f+"</span>",action:function(b){b=$(this);a in favors?(delete favors[a],delete favormails[a],$.user_message(configlang.CHECKLISTREMOVESUCCESS,"success"),b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star")):(favors[a]=$("#"+a).clone().removeClass("medium col-xs-12 col-sm-6 col-md-4 col-lg-3","col-md-6").addClass("merk col-md-6"),$(favors[a]).find("a").attr("href","javascript:$.open_fullview('"+a+"',Object.keys(favors));"),
favormails[a]=$("#mail_"+d).wrap("<p/>").parent().html(),$.user_message(configlang.CHECKLISTSUCCESS,"success"),b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o"));$.update_favors()}}],onhidden:function(){dialogs.pop();statevals.ppnlist.pop();$.push_state()},onshown:function(){dialogs.push(l);$.is_Empty(statevals)&&(statevals={});$.is_Empty(statevals.ppnlist)&&(statevals.ppnlist=[]);statevals.ppnlist.push({ppn:a,ppnlist:b,typ:c,
parentppn:e});$.push_state();$.opened_fullview(a,d)}});l.realize();l.getModalHeader().addClass("preview-header");l.setData("ppn",a);l.setData("name","fullview_"+d);l.open()};
$.open_assistant=function(){var a=dialogs.length,b=new BootstrapDialog({message:$('<div id="assistant_'+a+'"></div>').load("/ajax/assistant/"+a),title:configlang.ASSISTANT,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}}],onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","assistant_"+a);b.open()};
$.update_favors=function(){$("#favors").html("");if(0<Object.keys(favors).length){var a=0;$.each(favors,function(b,c){a++;1==a%2&&$("#favors").append("<div class='row'>");$("#favors").append(c);0==a%2&&$("#favors").append("</div>")});1==a%2&&$("#favors").append("</div>")}else $("#favors").append("<div class='col-xs-12'>"+configlang.CHECKLISTEMPTY+"</div>")};
$.open_favors=function(){var a="",b="",c=new BootstrapDialog({message:'<div class="row" id="favors"></div><div id="favor_messagebar"></div>',title:"Merkliste "+config.softwarename,closable:!0,size:BootstrapDialog.SIZE_WIDE,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close()}},{icon:"glyphicon glyphicon-envelope",label:" "+configlang.MAIL,action:function(a){""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail(Object.keys(favors))}):
$.open_mail(Object.keys(favors))}},{icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,action:function(a){$.open_export(Object.keys(favors))}},{icon:"fa fa-eraser",label:" "+configlang.CHECKLISTCLEAR,action:function(c){favors={};a="success";b=configlang.CHECKLISTCLEARSUCCESS;c.close()}}],onhidden:function(){dialogs.pop();""!=a&&$.user_message(b,a);$.focus_first()},onshown:function(){dialogs.push(c);$.update_favors()}});c.realize();c.getModalHeader().addClass("preview-header");c.setData("name",
"favors");c.open()};
$.open_mail=function(a){if(""!=usrconfig){void 0!=usrconfig.email&&""!=usrconfig.email||$.user_message(configlang.PROVIDEMAIL,"warning");var b=usrconfig.email,c=(usrconfig.firstname+" "+usrconfig.lastname).trim(),e=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="mailto" class="col-sm-3 control-label">'+configlang.MAILRECIPIENT+'</label><div class="col-sm-9"><input type="mail" class="form-control" id="mailto" placeholder="'+configlang.MAILRECIPIENT+'"></div></div><div class="form-group"><label for="msg" class="col-sm-3 control-label">'+
configlang.YOURMESSAGE+'</label><div class="col-sm-9"><textarea class="form-control" rows="5" id="msg" placeholder="'+configlang.YOURMESSAGE+'"></textarea></div></div><div id="mail_messagebar"></div></div>',title:configlang.SENDMAIL,closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){status=-1;a.close()}},{icon:"glyphicon glyphicon-log-in",label:" "+configlang.SENDMAIL,cssClass:"fullview-button-color",action:function(d){username=$("#username").val();
mailfrom=$("#mailfrom").val();mailto=$("#mailto").val();msg=$("#msg").val();if(""==mailto)return $.user_message(configlang.REQUIREDFIELD,"warning"),$("#mailto").focus(),-1;if(!$.validateEmail(mailto))return $.user_message(configlang.MAILWRONG,"warning"),$("#mailto").focus(),-1;$.post("/ajax/mailto",{ppnlist:JSON.stringify(a),username:JSON.stringify(c),mailfrom:b,mailto:mailto,msg:JSON.stringify(msg),fullbody:JSON.stringify(favormails)},function(a){"0"<=a&&($.user_message(configlang.MAILSUCCESS,"success"),
d.close())})}}],onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(e);"1"==config.devmode&&($("#username").val(config.devusername),$("#mailfrom").val(config.devusermail),$("#mailto").val(config.devusermail),$("#msg").val(config.devusermailtext));$("#username").focus()}});e.realize();e.getModalHeader().addClass("preview-header");e.setData("name","mail");e.open()}};
$.open_export=function(a){exportdialog=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label class="col-sm-2">Format</label><div class="col-sm-10"><div class="radio"><label><input type="radio" name="export" id="refworks" value="refworks" checked>refWorks</label></div><div class="radio"><label><input type="radio" name="export" id="citavi" value="citavi">Citavi</label></div><div class="radio"><label><input type="radio" name="export" id="endnote" value="endnote">Endnote</label></div><div class="radio"><label><input type="radio" name="export" id="bibtex" value="bibtex">BibTeX</label></div></div><div id="export_messagebar"></div></div></div>',title:configlang.EXPORT,
closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){status=-1;a.close()}},{icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,cssClass:"fullview-button-color",action:function(b){var c=$("input[name=export]:checked").val();"refworks"==c?$.post("/ajax/exportlink",{ppnlist:JSON.stringify(a),format:c},function(a){""!=a&&$.each(a,function(a,b){window.open(b,"_blank")})},"json"):$.each(a,function(a,b){window.open(urlport+window.location.host+
"/exportfile/"+b+"/"+c,"_blank")});b.close()}}],onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(exportdialog)}});exportdialog.realize();exportdialog.getModalHeader().addClass("preview-header");exportdialog.setData("name","export");exportdialog.open()};
$.open_wait=function(){waitdialog=new BootstrapDialog({message:'<div class="outercircle"></div><div class="innercircle"></div>',cssClass:"wait",animate:!1,closable:!1});waitdialog.realize();waitdialog.getModalHeader().hide();waitdialog.getModalFooter().hide();waitdialog.open()};$.close_wait=function(){waitdialog.close()};
$.login=function(a,b){var c="",e="",d="",f="",g=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="kennung" class="col-sm-3 control-label">'+configlang.USERNAME+'</label><div class="col-sm-9"><input type="text" class="form-control" id="kennung" placeholder="'+configlang.USERNAME+'"></div></div><div class="form-group"><label for="passwort" class="col-sm-3 control-label">'+configlang.PASSWORD+'</label><div class="col-sm-9"><input type="password" class="form-control" id="passwort" placeholder="'+
configlang.PASSWORD+'"></div></div><div id="login_messagebar"></div></div>',title:"Login "+config.softwarename,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-log-in",label:" "+configlang.LOGIN,cssClass:"fullview-button-color",action:function(a){user=$("#kennung").val();pw=$("#passwort").val();if(""==user||""==pw)return $.user_message(configlang.REQUIREDTWOFIELDS,"warning"),""==user?$("#kennung").focus():
$("#passwort").focus(),-1;$.post("/ajax/login",{user:user,pw:pw},function(b){"-1"!=b?(a.close(),$(".nologinarea").addClass("hide"),$(".loginarea").removeClass("hide"),usrconfig=b,timer=!0,$.startTimer(),c="success",e=configlang.LOGINSUCCESS.replace("{firstname}",b.firstname).replace("{lastname}",b.lastname),b.collectable&&(d="warning",f=configlang.COLLECTABLEREMARK)):($.user_message(configlang.LOGINERROR,"warning"),$("#kennung").focus(),usrconfig="");$.focus_first()},"json")}}],onhidden:function(){dialogs.pop();
""!=c&&$.user_message(e,c);""!=d&&$.user_message(f,d,1E4);b()},onshown:function(){dialogs.push(g);"1"==config.devmode&&($("#kennung").val(config.devuser),$("#passwort").val(config.devpassword));$("#kennung").focus();void 0!=a&&""!=a&&$.user_message(configlang[a],"warning")}});g.realize();g.getModalHeader().addClass("preview-header");g.setData("name","login");g.open()};$.loginonly=function(){$.login("",function(){})};
$.logout=function(){var a=new BootstrapDialog({message:"<div>"+configlang.LOGOUTREALLY.replace("{system}",config.softwarename)+'<div id="logout_messagebar"></div></div>',title:"Logout "+config.softwarename,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-log-out",label:" "+configlang.LOGOUT,cssClass:"fullview-button-color",action:function(a){$.post("/ajax/logout",function(c){a.close();$(".nologinarea").removeClass("hide");
$(".loginarea").addClass("hide");$.reset_session()},"json")}}],onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(a)}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","logout");a.open()};
$.open_facets=function(){var a=new BootstrapDialog({message:'<div><div id="FACETYEARTOTAL2"><div class="well"><div>'+configlang.FACETYEAR+' <span class="yearstart2 inlineedit"> </span> - <span class="yearend2 inlineedit"> </span></div><div id="pubyear2"> </div></div></div><div id="FACETTYPTOTAL2"><div class="well"><div class="FACETTYP">'+configlang.FACETTYP+'</div><div id="onlines2"></div></div></div><div id="FACETFORMATTOTAL2"><div class="well">'+configlang.FACETFORMAT+'<div id="formats2"></div></div><div id="facets_messagebar"></div></div>',
title:'<span class="TOTALRECS">'+results.hits+"</span> "+configlang.RESULTFILTER,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}}],onshown:function(b){dialogs.push(a);$(".yearstart2.inlineedit").inlineEdit($('<input name="temp_start" type="text" maxlength="4" size="4" />'),$("#hiddenyearstart"));$(".yearend2.inlineedit").inlineEdit($('<input name="temp_end" type="text" maxlength="4" size="4" />'),$("#hiddenyearend"));
facetvals.yearmin<facetvals.yearmax&&""!=facetvals.yearmin&&void 0!=facetvals.yearmin&&""!=facetvals.yearmax&&void 0!=facetvals.yearmax&&(b={range:{min:facetvals.yearmin,max:facetvals.yearmax},start:[facetvals.yearminstart,facetvals.yearmaxstart],connect:!0,behaviour:"drag",step:1},"undefined"!=typeof slider2&&slider2.noUiSlider.destroy(),slider2=document.getElementById("pubyear2"),noUiSlider.create(slider2,b),slider2.noUiSlider.on("update",function(a,b){$(".yearstart").html(Math.floor(a[0]));$(".yearend").html(Math.floor(a[1]));
$(".yearstart2").html(Math.floor(a[0]));$(".yearend2").html(Math.floor(a[1]))}),slider2.noUiSlider.on("change",function(a,b){facetvals.yearminstart=Math.floor(a[0]);facetvals.yearmaxstart=Math.floor(a[1]);facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]";$.set_facet("year","",facetvals.yearrange);slider.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart])}));$("#onlines").clone().attr("id","onlines2").replaceAll($("#onlines2"));$("#formats").clone().attr("id",
"formats2").replaceAll($("#formats2"));$(".facettyp").change(function(){$.set_facet("typ",$(this).val(),this.checked)});$(".facetformat").change(function(){$.set_facet("format",$(this).val(),this.checked)})},onhide:function(a){$("#onlines2").clone().attr("id","onlines").replaceAll($("#onlines"));$("#formats2").clone().attr("id","formats").replaceAll($("#formats"));$(".facettyp").change(function(){$.set_facet("typ",$(this).val(),this.checked)});$(".facetformat").change(function(){$.set_facet("format",
$(this).val(),this.checked)})},onhidden:function(){dialogs.pop()}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","facets");a.open()};
$.open_user=function(a){a=$('<div id="userbody"></div>').load("/ajax/userview/"+a);if("ERROR:"==$.trim(a).substr(0,6).toUpperCase())$.user_message($.trim(a).slice(6),"warning");else{var b=new BootstrapDialog({message:a,title:configlang.AREA+" "+usrconfig.firstname+" "+usrconfig.lastname,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-triangle-bottom",label:" "+
configlang.OK,cssClass:"fullview-button-color",action:function(a){a.close();$.focus_first()}}],onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","user");b.open()}};
$.update_favs=function(){if("undefined"!==typeof Storage){var a=sessionStorage.favs?$.parseJSON(sessionStorage.favs):{};$(".fav").remove();$.each(a,function(a,c){$('<li><a id="'+a+'" class="fav" href="javascript:$.open_fullview(\''+a+"')\">"+c+"</a></li>").insertBefore(".favdivider1")});1<Object.keys(a).length?($(".favdivider1").removeClass("hide"),$(".compare").removeClass("hide")):($(".favdivider1").addClass("hide"),$(".compare").addClass("hide"));0<Object.keys(a).length?($(".nofavs").addClass("hide"),
$(".favdivider2").removeClass("hide"),$(".favstore").removeClass("hide"),$(".favdivider3").removeClass("hide"),$(".favclear").removeClass("hide")):($(".nofavs").removeClass("hide"),$(".favdivider2").addClass("hide"),$(".favstore").addClass("hide"),$(".favdivider3").addClass("hide"),$(".favclear").addClass("hide"))}};
$.set_layout=function(a){config.layout=a;$.post("/ajax/layout",{layout:a},function(a){$("#resultsonly").fadeOut("fast",function(){$("#resultsonly").html(a.results);window.scrollTo(0,0);$.focus_first();$("#resultsonly").fadeIn("fast").removeClass("collapse")})},"json");$.user_message(configlang.VIEWCHANGED.replace("{col}",12/a),"success")};
$.set_language=function(a,b){$.post("/ajax/language",{language:a},function(c){configlang=c;$(".search_text").attr("placeholder",configlang.YOURSEARCH);$(".lang_datapoollocal").html(configlang.DATAPOOLLOCAL);$(".lang_datapoolglobal").html(configlang.DATAPOOLGLOBAL);$(".ger").html(configlang.GER);$(".eng").html(configlang.ENG);$(".col1").html(configlang.COL1);$(".col2").html(configlang.COL2);$(".col3").html(configlang.COL3);$(".col4").html(configlang.COL4);$(".RESULTFILTER").html(configlang.RESULTFILTER);
$(".FACETYEAR").html(configlang.FACETYEAR);$(".FACETTYP").html(configlang.FACETTYP);$(".FACETFORMAT").html(configlang.FACETFORMAT);$(".lbl_TYPTOTAL").html(configlang.TYPTOTAL);$(".lbl_TYPPRINT").html(configlang.TYPPRINT);$(".lbl_TYPELECTR").html(configlang.TYPELECTR);$(".imprint").html(configlang.IMPRINT);$.each($(".facetformat"),function(){$(".lbl_"+this.id).html(configlang[this.id.replace(/ /g,"").toUpperCase()])});$(".myarea").attr("title",configlang.MYAREA);$(".myarea2").html('<i class="fa fa-user"></i> '+
configlang.MYAREA);$(".userrentals").html(configlang.USERRENTALS);$(".userorders").html(configlang.USERORDERS);$(".userreservations").html(configlang.USERRESERVATIONS);$(".userfees").html(configlang.USERFEES);$(".usersearches").html(configlang.USERSEARCHES);$(".userstore").html('<i class="glyphicon glyphicon-save"></i> '+configlang.USERSTORE);$(".favorites").attr("title",configlang.CHECKLIST);$(".selecttheme").attr("title",configlang.SELECTTHEME);$(".selectview").attr("title",configlang.SELECTVIEW);
$(".selectlanguage").attr("title",configlang.SELECTLANGUAGE);$(".selectdatapool").attr("title",configlang.SELECTDATAPOOL);$(".startsearch").attr("title",configlang.STARTSEARCH);$(".filterresults").attr("title",configlang.RESULTFILTER);"ger"==a&&($("#welcome_eng").addClass("hide"),$("#welcome_ger").removeClass("hide"));"eng"==a&&($("#welcome_eng").removeClass("hide"),$("#welcome_ger").addClass("hide"));config.language=a;b||$.user_message(configlang.LANGUAGECHANGED,"success");$.focus_first()},"json")};
$.shelve=function(a,b,c){var e=b="",d;for(d in c)"action"!=d&&"typ"!=d&&"id"!=d&&""!=c[d]&&(""==e&&(e=d.replace(/\d/g,"")),""!=e&&e!=d.replace(/\d/g,"")&&(e=d.replace(/\d/g,""),b+="<br />"),b+=c[d].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;")+"<br />");b+='<br /><div id="shelve_messagebar"></div>';c=$("#"+a+" div.panel-heading").html();void 0==c&&(c=$("#related_"+a).html());var f=new BootstrapDialog({message:b,title:c,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,
action:function(a){a.close();$.focus_first()}}],onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(f)}});f.realize();f.getModalHeader().addClass("preview-header");f.setData("name","shelve");f.open()};
$.reservation=function(a,b,c){var e=b="",d;for(d in c)"action"!=d&&"typ"!=d&&"id"!=d&&""!=c[d]&&(""==e&&(e=d.replace(/\d/g,"")),""!=e&&e!=d.replace(/\d/g,"")&&(e=d.replace(/\d/g,""),b+="<br />"),b+=c[d].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;")+"<br />");b+='<br /><div id="reservation_messagebar"></div>';d=$("#"+a+" div.panel-heading").html();void 0==d&&(d=$("#related_"+a).html());var f="",g="",h=new BootstrapDialog({message:b,title:d,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",
label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.RESERVATION,cssClass:"fullview-button-color",action:function(a){""==usrconfig?$.login("LOGINFIRST",function(){$.post("/ajax/request",{uri:c.id},function(b){0>b.status?(f="warning",g=configlang.PROCESSSTOPPED+"<br />"+b.error):(f="success",g=configlang.RESERVATIONSUCCESS);a.close()},"json")}):$.post("/ajax/request",{uri:c.id},function(b){0>b.status?(f="warning",g=configlang.PROCESSSTOPPED+
"<br />"+b.error):(f="success",g=configlang.RESERVATIONSUCCESS);a.close()},"json")}}],onhidden:function(){dialogs.pop();""!=f&&$.user_message(g,f)},onshown:function(){dialogs.push(h)}});h.realize();h.getModalHeader().addClass("preview-header");h.setData("name","reservation");h.open()};
$.order=function(a,b,c){if(void 0!=c.id){var e=b="",d;for(d in c)"action"!=d&&"typ"!=d&&"id"!=d&&""!=c[d]&&(""==e&&(e=d.replace(/\d/g,"")),""!=e&&e!=d.replace(/\d/g,"")&&(e=d.replace(/\d/g,""),b+="<br />"),b+=c[d].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;")+"<br />");b+='<br /><div id="order_messagebar"></div>';d=$("#"+a+" div.panel-heading").html();void 0==d&&(d=$("#related_"+a).html());var f="",g="",h=new BootstrapDialog({message:b,title:d,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",
label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.ORDER,cssClass:"fullview-button-color",action:function(a){""==usrconfig?$.login("LOGINFIRST",function(){$.post("/ajax/request",{uri:c.id},function(b){0>b.status?(f="warning",g=configlang.PROCESSSTOPPED+"<br />"+b.error):(f="success",g=configlang.ORDERSUCCESS);a.close()},"json")}):$.post("/ajax/request",{uri:c.id},function(b){0>b.status?(f="warning",g=configlang.PROCESSSTOPPED+"<br />"+
b.error):(f="success",g=configlang.ORDERSUCCESS);a.close()},"json")}}],onhidden:function(){dialogs.pop();""!=f&&$.user_message(g,f)},onshown:function(){dialogs.push(h)}});h.realize();h.getModalHeader().addClass("preview-header");h.setData("name","order");h.open()}};
$.mailorder=function(a,b,c){var e="",d="",f=$("#"+a+" div.panel-heading").html();void 0==f&&(f=$("#related_"+a).html());var g=new BootstrapDialog({message:$('<div id="mailorderviewbody"></div>').load("/ajax/mailorderview/"+a+"/"+b),title:f,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.ORDER,cssClass:"fullview-button-color",action:function(b){var f=$("input[name=mailto]:checked").val();
void 0==f&&(f=$("#mailto").attr("value"));if(void 0==f)return $.user_message("Die MailTo-Adresse konnte nicht ermittelt werden!","warning"),-1;var g=$("input[name=mailfrom]:checked").val();void 0==g&&(g=$("#mailfrom").attr("value"));if(void 0==g)return $.user_message("Die MailFrom-Adresse konnte nicht ermittelt werden!","warning"),-1;if(""==usrconfig)$.login("LOGINFIRST",function(){var n={},k=$("input[name=volume]").val();void 0!=k&&(n.volume=k);k=$("#mail_"+(dialogs.length-2)).wrap("<p/>").parent().html();
$.post("/ajax/mailorderto",{exemplar:JSON.stringify(c),fullbody:JSON.stringify(k),ppn:a,mailto:f,mailfrom:g,userinput:JSON.stringify(n)},function(a){0>a.status?$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning"):(e="success",d=configlang.ORDERSUCCESS,b.close())},"json")});else{var m={},k=$("input[name=volume]").val();void 0!=k&&(m.volume=k);k=$("#mail_"+(dialogs.length-2)).wrap("<p/>").parent().html();$.post("/ajax/mailorderto",{exemplar:JSON.stringify(c),fullbody:JSON.stringify(k),
ppn:a,mailto:f,mailfrom:g,userinput:JSON.stringify(m)},function(a){0>a.status?$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning"):(e="success",d=configlang.ORDERSUCCESS,b.close())},"json")}}}],onhidden:function(){dialogs.pop();""!=e&&$.user_message(d,e)},onshown:function(){dialogs.push(g)}});g.realize();g.getModalHeader().addClass("preview-header");g.setData("name","mailorder");g.open()};
$.cancel=function(a){$.post("/ajax/cancel",{uri:a},function(a){0>a.status?$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning"):$.user_message(configlang.CANCELSUCCESS,"success")},"json")};$.renew=function(a){$.post("/ajax/renew",{uri:a},function(a){$.close_dialogs();$.open_user("userrentals");0>a.status?$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning"):$.user_message(configlang.RENEWSUCCESS,"success")},"json")};
$.close_dialogs=function(){for(var a=dialogs.length-1;0<=a;a--)dialogs[a].close()};
$.reset_session=function(){$.close_dialogs();$.post("/ajax/sessclear",function(a){$("#searchtext_xs").val("");$("#searchtext_md").val("");$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide");$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$("#start").fadeIn("fast").removeClass("collapse");$(".fav").remove();$(".favdivider1").addClass("hide");$(".compare").addClass("hide");
$(".nofavs").removeClass("hide");$(".favdivider2").addClass("hide");$(".favstore").addClass("hide");$(".favdivider3").addClass("hide");$(".favclear").addClass("hide");window.history.replaceState("","",urlport+window.location.host);view="3";results.hits=0;Scroll=!1;usrconfig="";config.layout=3;messid=0;results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{}};searchvals={text:"",last:"","package":1,inittext:"",initfacets:{}};facetvals={datapool:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",
yearmaxstart:"",typ:"total",formats:{}};favors={};$.load_config();timer=!1;$(document.body).unbind();window.location.href=urlport+window.location.host})};
$.store_search=function(){window.scrollTo(0,0);""==usrconfig?$.user_message(unescape("Achtung<br />Bitte dazu zun%E4chst am System angemelden!"),"warning"):$.post("/ajax/storeusersearch",{search:searchvals.text,user:usrconfig.username,facets:window.btoa(unescape(encodeURIComponent(JSON.stringify(facetvals))))},function(a){0>a.status?$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning"):$.user_message("Erfolg","success")},"json")};
$.pop_search=function(a,b){$.close_dialogs();searchvals.initfacets=b;0<Object.keys(searchvals.initfacets).length?(facetvals=searchvals.initfacets,searchvals.initfacets={}):facetvals.datapool=config.datapool;$(".facetpool").parents(".dropdown").find(".btn").val(facetvals.datapool);$(".datapool").html(configlang["DATAPOOL"+facetvals.datapool.toUpperCase()]);appstate.pushurl=!1;$.new_search("initfacets",a);return $.Deferred().resolve()};
$.startTimer=function(){$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",$.resetTimer);$.resetTimer()};$.resetTimer=function(){clearTimeout(idleTimer);idleTimer=setTimeout($.whenUserAlmostIdle,1E3*time2warn)};
$.whenUserAlmostIdle=function(){clearTimeout(idleTimer);idleTimer=setTimeout($.whenUserIdle,1E3*time2kill);var a=new BootstrapDialog({message:unescape('Sie werden in <span class="customer-link" id="countdown">'+(time2kill-1)+"</span> Sekunden automatisch abgemeldet"),title:"Automatische Abmeldung",closable:!1,type:BootstrapDialog.TYPE_DANGER,onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(a);$.startCountdown(time2kill-2,$("#countdown"));$(document.body).unbind();$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",
$.whenUserStopsAlmostIdle)}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","almostidledialog");a.open()};$.whenUserStopsAlmostIdle=function(){dialogs[dialogs.length-1].close();$(document.body).unbind();$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",$.resetTimer);$.resetTimer()};
$.whenUserIdle=function(){$.user_message(configlang.IDLEHAPPENED,"warning");$.post("/ajax/logout",function(a){$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide")},"json");$.reset_session()};$.startCountdown=function(a,b){var c=a;setInterval(function(){b.html(c);0>--c&&(c=a)},1E3)};
$.fn.inlineEdit=function(a,b){$.detectIE()||$(this).click(function(){var c=$(this);c.hide();c.after(a);a.focus();"temp_start"==a.attr("name")&&(""!=facetvals.yearminstart?a.val(facetvals.yearminstart):a.val(facetvals.yearmin));"temp_end"==a.attr("name")&&(""!=facetvals.yearmaxstart?a.val(facetvals.yearmaxstart):a.val(facetvals.yearmax));a.keypress(function(a){13!=a.keypress&&13!=a.keyCode||$.focus_first()});a.blur(function(){""!=$(this).val()&&($(this).val()<facetvals.yearmin||$(this).val()>facetvals.yearmax||
"temp_start"==$(this).attr("name")&&$(this).val()>facetvals.yearmaxstart||"temp_end"==$(this).attr("name")&&$(this).val()<facetvals.yearminstart?(window.scrollTo(0,0),$.user_message(configlang.CORRECTPERIOD.replace("{PERIOD}",facetvals.yearmin+"-"+facetvals.yearmax)),$(this).val("")):(b.val($(this).val()).change(),c.text($(this).val())));$(this).remove();c.show()})})};
$.detectIE=function(a){a=window.navigator.userAgent;var b=a.indexOf("MSIE ");if(0<b)return parseInt(a.substring(b+5,a.indexOf(".",b)),10);if(0<a.indexOf("Trident/"))return b=a.indexOf("rv:"),parseInt(a.substring(b+3,a.indexOf(".",b)),10);b=a.indexOf("Edge/");return 0<b?parseInt(a.substring(b+5,a.indexOf(".",b)),10):!1};$.validateEmail=function(a){return/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(a)};
$(function(){$.load_config();$.update_favs();$(".facetpool li a").click(function(){var a=$(this).data("value").toLowerCase();"local"==a?($(".datapoollocal").removeClass("hide"),$(".datapoolglobal").addClass("hide")):($(".datapoollocal").addClass("hide"),$(".datapoolglobal").removeClass("hide"));$.set_facet("datapool","",a)});$(".lang li a").click(function(){"ger"==$(this).data("value")?($(".lang_ger").removeClass("hide"),$(".lang_eng").addClass("hide")):($(".lang_ger").addClass("hide"),$(".lang_eng").removeClass("hide"));
$.set_language($(this).data("value"),!1)});$(".layout li a").click(function(){$.set_layout($(this).data("value"))});$(".theme li a").click(function(){$.cookie("theme",$(this).attr("data-type")+"|"+$(this).attr("data-rel"),{expires:365,path:"/"});config.theme=$(this).attr("data-type")+"|"+$(this).attr("data-rel");"customer"==$(this).attr("data-type")?$("#activetheme").attr("href",urlport+window.location.host+"/assets/css/"+$(this).attr("data-rel")+".css"):"system"==$(this).attr("data-type")?$("#activetheme").attr("href",
urlport+window.location.host+"/systemassets/lukida/css/"+$(this).attr("data-rel")+".css"):"bootstrap"==$(this).attr("data-type")&&$("#activetheme").attr("href",urlport+window.location.host+"/systemassets/bootstrap_3.3.7/css/"+$(this).attr("data-rel")+".min.css");$("#theme li").removeClass("active");$("#theme [data-rel='"+$(this).attr("data-rel")+"']").parent().addClass("active");$.focus_first()});$(window).scroll(function(){Scroll&&$(window).scrollTop()+500>=$(document).height()-$(window).height()&&
$.search_next_pack(function(){})});window.scrollTo(0,0);$(".typeahead").typeahead({ajax:"/ajax/getwords",onSelect:function(a){$.new_search("init",a.value)}});window.onpopstate=function(a){$.close_dialogs();$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");null!=a.state&&0<Object.keys(a.state).length?$.when($.pop_search(a.state.text,a.state.facets)).done(function(){document.title=a.state.text+
" | "+xtitle}):($("#start").fadeIn("fast").removeClass("collapse"),$("#searchtext_xs").val(""),$("#searchtext_md").val(""))};$(".yearstart.inlineedit").inlineEdit($('<input name="temp_start" type="text" maxlength="4" size="4" />'),$("#hiddenyearstart"));$(".yearend.inlineedit").inlineEdit($('<input name="temp_end" type="text" maxlength="4" size="4" />'),$("#hiddenyearend"));$("#hiddenyearstart").change(function(){facetvals.yearminstart=$("#hiddenyearstart").val();facetvals.yearrange="["+facetvals.yearminstart+
" TO "+facetvals.yearmaxstart+"]";$.set_facet("year");slider.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]);void 0!=slider2&&slider2.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart])});$("#hiddenyearend").change(function(){facetvals.yearmaxstart=$("#hiddenyearend").val();facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]";$.set_facet("year");slider.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]);void 0!=slider2&&slider2.noUiSlider.set([facetvals.yearminstart,
facetvals.yearmaxstart])});$.focus_first()});
