var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(b.call(c,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))return;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var e=a.split(".");a=1===e.length;d=e[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<e.length-1;g++){var f=e[g];if(!(f in d))return;d=d[f]}e=e[e.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[e]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,e,{configurable:!0,writable:!0,value:b}):b!==c&&(void 0===$jscomp.propertyToPolyfillSymbol[e]&&($jscomp.propertyToPolyfillSymbol[e]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(e):
$jscomp.POLYFILL_PREFIX+e),e=$jscomp.propertyToPolyfillSymbol[e],$jscomp.defineProperty(d,e,{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(b,c){return $jscomp.findInternal(this,b,c).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(e,g){this.$jscomp$symbol$id_=e;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(e){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(e||"")+"_"+c++,e)};return d},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,e={next:function(){if(!d&&c<a.length){var g=c++;return{value:b(g,a[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var e=d.length;c=c||0;for(0>c&&(c=Math.max(c+e,0));c<e;c++){var g=d[c];if(g===b||Object.is(g,b))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");
var Scroll=!1,Height=$(document).height(),title="",user,pw,status,username,mailfrom,mailto,msg,config,usrconfig="",configlang,xtitle=document.title,slider1,slider2,slider3,dialogs=[],waitdialog,messid=0,appstate={first:!0},querystate=!1,results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{},spell:{},status:0},searchvals={text:"",last:"",package:1,inittext:"",initfacets:{}},facetvals={datapool:"",iln:"",phonetic:!1,yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",yearminbase:"",
yearmaxbase:"",typ:"total",formats:{},sort:"scoredesc"},statevals={ppnlist:[],language:"",layout:""},favors={},favormails={},favorprint={},idleTimer,time2warn=1080,time2kill=120,timer=!1,maxrenewals=0,urlport=location.protocol+"//",linkresolver=!1,linkresolverclass="col-xs-12 col-sm-6 col-md-4",delay=function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}(),marcCheck=!0,formate={Article:1,Book:2,Journal:4,Serial_Volume:8,Sound_Recording:16,Musical_Score:32,Microform:64,Map:128,
Motion_Picture:256,Monograph_Series:512,Manuscript:1024,unknown:2048,Game:4096,Data_Media:8192,Projected_Medium:16384,Mixed_Materials:32768,Picture:65536},formats={Article:!1,Book:!1,Journal:!1,"Serial Volume":!1,"Sound Recording":!1,"Musical Score":!1,Microform:!1,Map:!1,"Motion Picture":!1,"Monograph Series":!1,Manuscript:!1,unknown:!1,Game:!1,"Data Media":!1,"Projected Medium":!1,"Mixed Materials":!1,Picture:!1},formatslanguagesort=[],view={},filters=[],settings={title:"",author:"",subject:"",
class:"",publisher:"",toc:"",id:"",series:"",isn:""},settingsname,isMobile=window.matchMedia("only screen and (max-width: 760px)").matches,intervalID="",$JSONData,answer={status:"",message:""},resolver={fullview:null,google:null,link:null,simular:null,export:null},SettingsTooltip=!1;$.is_Empty=function(a){if(null==a)return!0;if(0<a.length)return!1;if(0===a.length||"object"!==typeof a)return!0;for(var b in a)if(hasOwnProperty.call(a,b))return!1;return!0};$.focus_first=function(){};
$.show_tooltips=function(){SettingsTooltip=!0;$(".countSettings").tooltip("show");setTimeout($.remove_tooltips,4E3);intervalID=setInterval(function(){$(".countSettings").animate({opacity:"0.5"}).delay(1E3).animate({opacity:"1"})},3E3)};$.remove_tooltips=function(){$(".countSettings").tooltip("hide");$(".countFavors").tooltip("hide")};$.close_wait=function(){waitdialog.close()};$.openInNewTab=function(a){window.open(a,"_blank").focus()};$.validateEmail=function(a){return/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(a)};
$.cleanArray=function(a){for(var b=0;b<a.length;b++)void 0==a[b].trim()||""==a[b].trim()?(a.splice(b,1),b--):a[b]=a[b].trim();return a};$.SetQuery=function(){querystate?0<results.hits?($("#querybar_querybar").hide(),$("#results_querybar").show()):($("#querybar_querybar").show(),$("#results_querybar").hide()):($("#querybar_querybar").hide(),$("#results_querybar").hide())};
$.command=function(a){"library"==a.toLowerCase()?window.location.href=urlport+window.location.host+"/librarymodule":"query"==a.toLowerCase()?(querystate=!querystate,$.SetQuery()):$.post("/ajax/command",{cmd:a},function(b){$.user_message("Befehl "+a+" erfolgreich ausgef&uuml;hrt","success");$.focus_first()},"json")};
$.user_message=function(a,b,c){void 0==c&&(c=5E3);0<dialogs.length?"success"==b?($.show_message(a,b,c,messloc=dialogs[dialogs.length-1].getData("name")),1<dialogs.length&&$.show_message(a,b,c,messloc=dialogs[dialogs.length-2].getData("name")),2<dialogs.length&&$.show_message(a,b,c,messloc=dialogs[dialogs.length-3].getData("name"))):$.show_message(a,b,c,messloc=dialogs[dialogs.length-1].getData("name")):0<results.hits?$.show_message(a,b,c,"results"):$.show_message(a,b,c,"statusbar")};
$.show_message=function(a,b,c,d){var e="success"==b?"panel-success":"panel-danger";messid++;$("#"+d+"_messagebar").append($("<div id='message"+messid+"' class='alert-message "+b+"' data-alert></div>"));$("#message"+messid).hide().html("<div class='panel "+e+"'><div class='panel-heading'>"+a+"</div></div>").fadeIn("fast");$("#message"+messid).delay(c).fadeOut("slow",function(){$(this).remove()})};
$.set_layout=function(a,b){config.layout=a;$.post("/ajax/layout",{layout:a},function(c){$("#resultsonly").fadeOut("fast",function(){$("#resultsonly").html(c.results);window.scrollTo(0,0);$.focus_first();$("#resultsonly").fadeIn("fast").removeClass("collapse")})},"json");b&&($.user_message(configlang.VIEWCHANGED.replace("{col}",12/a),"success"),$.push_state())};$.show_answer=function(){""!=answer.message&&$.user_message(answer.message,answer.status);answer.message="";answer.status=""};
$.set_language=function(a,b){config.language=a;$.post("/ajax/language",{language:a},function(c){configlang=c;$(".search_text").attr("placeholder",configlang.YOURSEARCH);$(".ger").html(configlang.GER);$(".eng").html(configlang.ENG);$(".col1").html(configlang.COL1);$(".col2").html(configlang.COL2);$(".col3").html(configlang.COL3);$(".col4").html(configlang.COL4);$(".RESULTFILTER").html(configlang.RESULTFILTER);$(".lbl_facetyear").html(configlang.FACETYEAR);$(".lbl_facettyp").html(configlang.FACETTYP);
$(".lbl_facetformat").html(configlang.FACETFORMAT);$(".lbl_typtotal").html(configlang.TYPTOTAL);$(".lbl_typprint").html(configlang.TYPPRINT);$(".lbl_typelectr").html(configlang.TYPELECTR);$(".lbl_year").html(configlang.YEAR);$(".lbl_score").html(configlang.SCORE);$(".lbl_sorting").html(configlang.SORTING);$(".imprint").html(configlang.IMPRINT);$(".about").html(configlang.ABOUT);$(".dataprotection").html(configlang.DATAPROTECTION);$(".disabilityaccess").html(configlang.DISABILITYACCESS);$.each($(".facetformat"),
function(){$(".lbl_"+this.id.replace(/ /g,"").toUpperCase()).html(configlang[this.id.replace(/ /g,"").toUpperCase()])});$(".ubinfo").attr("title",configlang.INFORMATIONS);$(".myarea").attr("title",configlang.MYAREA);$(".myarea2").html('<i class="fa fa-user"></i> '+configlang.MYAREA);$(".usercollectables").html(configlang.USERCOLLECTABLES);$(".userrentals").html(configlang.USERRENTALS);$(".userordermails").html(configlang.USERORDERMAILS);$(".userorders").html(configlang.USERORDERS);$(".userreservations").html(configlang.USERRESERVATIONS);
$(".userfees").html(configlang.USERFEES);$(".usersearches").html(configlang.USERSEARCHES);$(".userstore").html('<i class="glyphicon glyphicon-save"></i> '+configlang.USERSTORE);$(".favorites").attr("title",configlang.CHECKLIST);$(".selectview").attr("title",configlang.SELECTVIEW);$(".selectlanguage").attr("title",configlang.SELECTLANGUAGE);$(".selectdatapool").attr("title",configlang.SELECTDATAPOOL);$(".startsearch").attr("title",configlang.STARTSEARCH);$(".settings").attr("title",configlang.SETTINGS);
$(".filterresults").attr("title",configlang.RESULTFILTER);$(".countSettings").attr("title",configlang.SETTINGSACTIVE);$(".countSettings").attr("data-original-title",configlang.SETTINGSACTIVE).tooltip("fixTitle");SettingsTooltip&&$.show_tooltips();$(".selectdiscoverydatapool").length&&($(".selectdiscoverydatapool").find('[value=""]').html(configlang.DATAPOOLGLOBAL),$(".selectdiscoverydatapool").find('[value=""]').attr("data-tokens",configlang.ALL),$(".selectdiscoverydatapool").selectpicker("refresh"),
$("[data-optgroup='1']").first().find(".text").html(configlang.ALL));$(".facetpool li a span").each(function(){var d=$(this).parent().data("value").toLowerCase();$(this).html(configlang["DATAPOOL"+d.toUpperCase()])});$(".lang_datapool").html(" "+configlang["DATAPOOL"+facetvals.datapool.toUpperCase()]);formatslanguagesort=[];$.each(formats,function(d,e){formatslanguagesort.push({id:d,val:configlang[d.replace(/ /g,"").toUpperCase()]})});formatslanguagesort.sort(function(d,e){d=d.val.toLowerCase();e=
e.val.toLowerCase();return d<e?-1:d>e?1:0});"ger"==a&&($(".showeng").addClass("hide"),$(".showger").removeClass("hide"));"eng"==a&&($(".showeng").removeClass("hide"),$(".showger").addClass("hide"));$.focus_first()},"json");b&&($.user_message(configlang.LANGUAGECHANGED,"success"),$.push_state())};$.mark_check=function(a){$(".check_"+a).each(function(b){$(this).prop("checked",marcCheck)});marcCheck=!marcCheck;$(".btn-check-all").blur()};
$.openLink=function(a){$.post("/ajax/statsclient",{typ:"Link",name:a,range:"year"});window.open(a,"_blank")};$.toggle_area=function(a){$(":focus").blur();$("."+a+"up").toggleClass("collapse");$("."+a+"down").toggleClass("collapse");view.hasOwnProperty(a)||(view[a]=!1);view[a]?$(".discover"+a).slideUp("fast").addClass("collapse"):$(".discover"+a).slideDown("fast").removeClass("collapse");view[a]=!view[a]};$.close_dialogs=function(){for(var a=dialogs.length-1;0<=a;a--)dialogs[a].close()};
$.correctCover=function(a,b){a.onerror="";$(a).replaceWith("<span class='gbvicon'>"+b+"</span>")};
$.init_client=function(a){if(!$.is_Empty(a)){var b={};a.replace(/([^=&]+)=([^&]*)/g,function(c,d,e){b[decodeURIComponent(d)]=decodeURIComponent(e)});void 0!=b.g&&(statevals.language="g"==b.g.substring(0,1)?"ger":"eng",statevals.layout=12/b.g.substring(1,2));void 0!=b.ft&&("2"==b.ft&&(searchvals.initfacets.typ="total"),"1"==b.ft&&(searchvals.initfacets.typ="true"),"0"==b.ft&&(searchvals.initfacets.typ="false"));void 0!=b.fs&&("0"==b.fs&&(searchvals.initfacets.sort="scoredesc"),"1"==b.fs&&(searchvals.initfacets.sort=
"yeardesc"),"2"==b.fs&&(searchvals.initfacets.sort="yearasc"),$.format_sort(searchvals.initfacets.sort));void 0!=b.fp&&"1"==b.fp&&(searchvals.initfacets.phonetic=!0);searchvals.initfacets.yearminbase=void 0!=b.fb?parseInt(b.fb.substring(0,4)):"";searchvals.initfacets.yearmaxbase=void 0!=b.fb?parseInt(b.fb.substring(4,8)):"";searchvals.initfacets.yearmin=void 0!=b.fy?parseInt(b.fy.substring(0,4)):"";searchvals.initfacets.yearminstart=void 0!=b.fy?parseInt(b.fy.substring(4,8)):"";searchvals.initfacets.yearmaxstart=
void 0!=b.fy?parseInt(b.fy.substring(8,12)):"";searchvals.initfacets.yearmax=void 0!=b.fy?parseInt(b.fy.substring(12,16)):"";searchvals.initfacets.yearrange=void 0!=b.fy?"["+parseInt(b.fy.substring(4,8))+" TO "+parseInt(b.fy.substring(8,12))+"]":"";searchvals.initfacets.formats={};void 0!=b.fd&&(searchvals.initfacets.datapool=b.fd);void 0!=b.ff&&0<parseInt(b.ff)&&(searchvals.initfacets.formats={},$.each(formate,function(c){formate[c]&b.ff&&(searchvals.initfacets.formats[c.replace("_"," ")]=!0)}))}};
$.load_config=function(){$.post("/ajax/config",{screen:JSON.stringify({Width:screen.width,Height:screen.height}),platform:JSON.stringify(platform)},function(a){config=a;""!=statevals.language&&(config.language=statevals.language);$.set_language(config.language,!1);""!=statevals.layout&&$.set_layout(statevals.layout,!1);time2warn=60*config.time2warn;time2kill=60*config.time2kill;maxrenewals=parseInt(config.maxrenewals);0==!usrconfig&&(timer=!0,$.startTimer());a=0;$.is_Empty(searchvals.initfacets)?
(appstate.first=!1,facetvals.datapool=config.datapool):(appstate.first=!0,void 0!=searchvals.initfacets.datapool&&"global"==searchvals.initfacets.datapool&&a++,void 0!=searchvals.initfacets.phonetic&&1==searchvals.initfacets.phonetic&&a++,1E3==searchvals.initfacets.yearminbase&&searchvals.initfacets.yearmaxbase==(new Date).getFullYear()||a++,facetvals=searchvals.initfacets,searchvals.initfacets={});void 0==facetvals.datapool&&(facetvals.datapool=config.datapool);$(".facetpool").parents(".dropdown").find(".btn").val(facetvals.datapool);
"local"==facetvals.datapool.toLowerCase()?($(".datapoollocal").removeClass("hide"),$(".datapoolglobal").addClass("hide")):($(".datapoollocal").addClass("hide"),$(".datapoolglobal").removeClass("hide"));""!=searchvals.inittext&&(0==a?(a="",$.remove_tooltips(),clearInterval(intervalID)):SettingsTooltip=!0,$(".countSettings").html(a.toString()),$.when($.new_search("initfacets",searchvals.inittext)).done(function(){searchvals.inittext=""}));$(".search_clear").toggle(!!$(".search_text").val())},"JSON")};
$.url_clean=function(a){return encodeURIComponent(a.replace(/"/g,"%22").replace(/\//g,"{slash}").replace(/</g,"{st}").replace(/>/g,"{gt}").replace(/:/g,"{colon}").replace(/\*/g,"{star}").replace(/!/g,"{exma}").replace(/\?/g,"{quma}"))};
$.build_url_title=function(){var a=urlport+window.location.host,b=""==searchvals.text.trim()?"{no}":searchvals.text;a+="/"+$.url_clean(b);var c=searchvals.text;b="g="+config.language.substring(0,1)+12/config.layout;""!=facetvals.yearmin.toString()&&""!=facetvals.yearminstart.toString()&&""!=facetvals.yearmaxstart.toString()&&""!=facetvals.yearmax.toString()&&void 0!=facetvals.yearmin&&void 0!=facetvals.yearminstart&&void 0!=facetvals.yearmaxstart&&void 0!=facetvals.yearmax&&(b+="&fy="+facetvals.yearmin.toString()+
facetvals.yearminstart.toString()+facetvals.yearmaxstart.toString()+facetvals.yearmax.toString(),c+=" ["+facetvals.yearminstart.toString()+"-"+facetvals.yearmaxstart.toString()+"]");"true"==facetvals.typ&&(b+="&ft=1",c+=" | "+configlang.TYPELECTR);"false"==facetvals.typ&&(b+="&ft=0",c+=" | "+configlang.TYPPRINT);if("total"==facetvals.typ||""==facetvals.typ)b+="&ft=2";if(void 0==facetvals.yearminbase||""==facetvals.yearminbase)facetvals.yearminbase=1E3;if(void 0==facetvals.yearmaxbase||""==facetvals.yearmaxbase)facetvals.yearmaxbase=
(new Date).getFullYear();b+="&fb="+facetvals.yearminbase.toString()+facetvals.yearmaxbase.toString();b+="&fd="+facetvals.datapool;"global"==facetvals.datapool&&(c+=" | "+configlang.DATAPOOLGLOBAL);b+="&fp="+(facetvals.phonetic?"1":"0");facetvals.phonetic&&(c+=" | "+configlang.PHONETIC);if("scoredesc"==facetvals.sort||void 0==facetvals.sort)b+="&fs=0";"yeardesc"==facetvals.sort&&(b+="&fs=1",c+=" | "+configlang.YEAR+" v");"yearasc"==facetvals.sort&&(b+="&fs=2",c+=" | "+configlang.YEAR+" ^");var d=0;
$.each(facetvals.formats,function(e){d|=formate[e.replace(" ","_")];c+=" | "+configlang[e.replace(" ","").toUpperCase()]});b+="&ff="+d;return{text:c,url:a+("/"+b),sets:b}};$.push_state=function(){buildstate=$.build_url_title();appstate.first||window.history.pushState({search:searchvals.text,text:buildstate.text,sets:buildstate.sets},buildstate.text.substring(0,100)+" | "+xtitle,buildstate.url);document.title=buildstate.text+" | "+xtitle;appstate.first=!1};
$.replace_state=function(a){void 0==a&&(a="");buildstate=""!=a?{text:"id:"+a,url:urlport+window.location.host+"/id%7Bcolon%7D"+a,sets:{}}:$.build_url_title();window.history.replaceState({search:searchvals.text,text:buildstate.text,sets:buildstate.sets},buildstate.text.substring(0,100)+" | "+xtitle,buildstate.url);document.title=buildstate.text+" | "+xtitle};$.startCountdown=function(a,b){var c=a;setInterval(function(){b.html(c);0>--c&&(c=a)},1E3)};
$.startTimer=function(){$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",$.resetTimer);$.resetTimer()};$.resetTimer=function(){clearTimeout(idleTimer);idleTimer=setTimeout($.whenUserAlmostIdle,1E3*time2warn)};
$.whenUserAlmostIdle=function(){clearTimeout(idleTimer);idleTimer=setTimeout($.whenUserIdle,1E3*time2kill);var a=new BootstrapDialog({message:unescape('Sie werden in <span class="customer-link" id="countdown">'+(time2kill-1)+"</span> Sekunden automatisch abgemeldet"),title:"Automatische Abmeldung",closable:!1,type:BootstrapDialog.TYPE_DANGER,onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(a);$.startCountdown(time2kill-2,$("#countdown"));$(document.body).unbind();$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",
$.whenUserStopsAlmostIdle)}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","almostidledialog");a.open()};$.whenUserStopsAlmostIdle=function(){dialogs[dialogs.length-1].close();$(document.body).unbind();$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",$.resetTimer);$.resetTimer()};
$.whenUserIdle=function(){$.user_message(configlang.IDLEHAPPENED,"warning");$.post("/ajax/logout",function(a){$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide")},"json");$.reset_session()};
$.reset_session=function(){$.close_dialogs();$.post("/ajax/sessclear",function(a){$("#searchtext_xs").val("");$("#searchtext_md").val("");$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide");$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$("#start").fadeIn("fast").removeClass("collapse");$(".fav").remove();$(".favdivider1").addClass("hide");$(".compare").addClass("hide");
$(".nofavs").removeClass("hide");$(".favdivider2").addClass("hide");$(".favstore").addClass("hide");$(".favdivider3").addClass("hide");$(".favclear").addClass("hide");window.history.replaceState("","",urlport+window.location.host);view="3";results.hits=0;Scroll=!1;usrconfig="";config.layout=3;messid=0;results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{}};searchvals={text:"",last:"",package:1,inittext:"",initfacets:{}};facetvals={datapool:"",iln:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",
yearmaxstart:"",typ:"total",formats:{}};favors={};$.load_config();timer=!1;$(document.body).unbind();window.location.href=urlport+window.location.host})};
$.clear_search=function(){$.close_dialogs();$("#searchtext_xs").val("");$("#searchtext_md").val("");$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$("#start").fadeIn("fast").removeClass("collapse");$("#version_start").fadeIn("fast").removeClass("collapse");$("#version_search").fadeOut("fast").addClass("collapse");results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{},spell:{},status:0};
searchvals={text:"",last:"",package:1,inittext:"",initfacets:{}};facetvals.yearrange="";facetvals.yearmin="";facetvals.yearmax="";facetvals.yearminstart="";facetvals.yearmaxstart="";facetvals.typ="total";facetvals.formats={};facetvals.sort="scoredesc";$.replace_state();$.focus_first()};
$.new_search=function(a,b){if("facet_"!=a.substr(0,6).toLowerCase()&&"onpop"!=a){searchvals.last=searchvals.text;void 0==b||""==b?searchvals.text="*":(searchvals.text=b.trim().replace(/,/g,", ").replace(/  /g," "),b=b.trim().replace(/,/g,", ").replace(/  /g," "));if("cmd:"==searchvals.text.substr(0,4).toLowerCase()){$.command(searchvals.text.substr(4));$("#searchtext_xs").val(searchvals.last);$("#searchtext_md").val(searchvals.last);searchvals.text=searchvals.last;$.focus_first();return}$("#searchtext_xs").val(b);
$("#searchtext_md").val(b);facetvals.yearrange="[1000 TO "+(new Date).getFullYear()+"]";facetvals.yearmin=1E3;facetvals.yearmax=(new Date).getFullYear();facetvals.yearminstart=1E3;facetvals.yearmaxstart=(new Date).getFullYear();facetvals.typ="total";facetvals.formats={};facetvals.sort="scoredesc"}Scroll=!1;searchvals.package=1;searchvals.search=searchvals.text;$.open_wait();$.search_results(a,function(){$.close_wait();0==results.hits&&$.spell_suggestion();$.push_state();$.focus_first()})};
$.search_results=function(a,b){$.ajax({url:"/ajax/search/",method:"POST",data:{search:searchvals.search,package:searchvals.package,facets:JSON.stringify(facetvals)},dataType:"JSON",success:function(c){$JSONData=c;$JSONData.hasOwnProperty("status")&&0==$JSONData.status?(results.status=$JSONData.status,results.hits=$JSONData.hits,results.hitspack=$JSONData.hitspack,results.qtime=$JSONData.qtime,results.spell=$JSONData.spell,c=$.trim($JSONData.query),c+=" <a href='"+c+"' target='_blank'><span class='fa fa-external-link'></span></a>",
0<results.hits?($("#querybar_query").html(""),$("#results_query").html(c)):($("#querybar_query").html(c),$("#results_query").html("")),$.SetQuery(),$(".TOTALRECS").html($.format_hits(results.hits)),2<=searchvals.package?(results.ppnlist=results.ppnlist.concat(jQuery.map($JSONData.ppnlist,function(d,e){return d.toString()})),results.hitscurr=results.ppnlist.length,$("#resultsonly").append($JSONData.results).fadeIn("fast"),50<=results.hitspack?$("#loading").fadeIn("fast").removeClass("collapse"):$("#loading").fadeOut("fast").addClass("collapse")):
(window.scrollTo(0,0),results.ppnlist=jQuery.map($JSONData.ppnlist,function(d,e){return d.toString()}),results.hitscurr=results.ppnlist.length,0==results.hitspack?"facet_"!=a.substr(0,6).toLowerCase()?($("#results").fadeOut("fast").addClass("collapse"),$("#loading").fadeOut("fast").addClass("collapse"),$("#start").fadeIn("fast").removeClass("collapse"),$("#btn_facets").addClass("hidden-xs"),$("#statusbar").removeClass("collapse"),$("#version_start").fadeIn("fast").removeClass("collapse"),$("#version_search").fadeOut("fast").addClass("collapse")):
$("#resultsonly").fadeOut("fast",function(){$("#statusbar").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$.number_facets(a);$("#resultsonly").fadeIn("fast").removeClass("collapse")}):($(".alert-message").remove(),$("#statusbar").addClass("collapse"),$("#start").fadeOut("fast").addClass("collapse"),$("#version_start").fadeOut("fast").addClass("collapse"),$("#version_search").fadeIn("fast").removeClass("collapse"),"facet_"!=a.substr(0,6).toLowerCase()?
$("#results").fadeOut("fast",function(){$("#resultsonly").html($JSONData.results);$.create_facets($JSONData);$("#facets").fadeIn("fast").removeClass("collapse");$("#results").fadeIn("fast").removeClass("collapse")}):$("#resultsonly").fadeOut("fast",function(){$("#resultsonly").html($JSONData.results);$.number_facets(a);$("#resultsonly").fadeIn("fast").removeClass("collapse")}),50<=results.hitspack?$("#loading").fadeIn("fast").removeClass("collapse"):$("#loading").fadeOut("fast").addClass("collapse"),
$("#btn_facets").removeClass("hidden-xs"))),Scroll=!1,50==results.hitspack&&(Scroll=!0)):results.status=$JSONData.status;b()}})};$.search_next_pack=function(a){Scroll=!1;$("#loading").removeClass("hideLoading").addClass("displayLoading");searchvals.package++;$.search_results("adddata",function(){$("#loading").removeClass("displayLoading").addClass("hideLoading");a()})};
$.facet_search=function(a,b){$.close_dialogs();searchvals.initfacets=b;0<Object.keys(searchvals.initfacets).length?(facetvals=searchvals.initfacets,searchvals.initfacets={}):facetvals.datapool=config.datapool;$(".facetpool").parents(".dropdown").find(".btn").val(facetvals.datapool);$(".datapool").html(configlang["DATAPOOL"+facetvals.datapool.toUpperCase()]);$.new_search("initfacets",decodeURIComponent(escape(atob(a))))};
$.link_search=function(a,b){""!=b&&("foreignid"==a?b=a+"("+$.trim(b).trim("'")+")":"id"==a||"ppnlink"==a||"norm"==a?b=a+"("+b+")":"year"==a?b=a+"("+b.replace(/[^a-z0-9]/gi,"")+")":"text"!=a&&(b=a+"('"+b+"')"),$.close_dialogs(),$.new_search("link",b))};$.navbar_search=function(a){a=$(a).val();$.new_search("init",a)};
$.spell_suggestion=function(){var a=searchvals.search;if(2<=results.spell.length)for(count=0;count<results.spell.length/2;){if(-1!=searchvals.text.toLowerCase().indexOf(results.spell[2*count])){var b=new RegExp(results.spell[2*count],"ig"),c=results.spell[2*count+1].suggestion[0].word.replace(/\b[a-z]/g,function(d){return d.toUpperCase()});a=a.replace(b,c)}count++}"0"!=results.status?$.user_message(configlang.INDEXERROR.replace("{status}",results.status),"warning",5E3):($.user_message(configlang.NOHITS,
"warning",5E3),"local"==facetvals.datapool&&(b=urlport+window.location.host,c=""==searchvals.text.trim()?"{no}":searchvals.text,b+="/"+$.url_clean(c)+"/fd=global",$.user_message(configlang.SEARCHGLOBAL.replace("{}","<a style='color:red' href=\""+b+'"><b>'+configlang.COMMUNITYLIBRARIES.replace("<br >"," ").replace("<br>"," ").replace("<br />"," ")+"</b></a> <span class='fa fa-link'></span>"),"success",15E3)));a!=searchvals.text&&$.user_message(configlang.DIDYOUMEAN.replace("{}","<a style='color:red' href=\""+
urlport+window.location.host+"/"+a+'"><b>'+a+"</b></a> <span class='fa fa-link'></span>"),"success",15E3)};$.close_resolvers=function(){null!=resolver.fullview&&(resolver.fullview.abort(),resolver.fullview=null);null!=resolver.google&&(resolver.google.abort(),resolver.google=null);null!=resolver.link&&(resolver.link.abort(),resolver.link=null);null!=resolver.simular&&(resolver.simular.abort(),resolver.simular=null);null!=resolver.export&&(resolver.export.abort(),resolver.export=null)};
$.opened_fullview=function(a,b){$.close_resolvers();$.exportlink(a,function(){$.replace_state(a);$.googleresolver(b,function(){$.linkresolver(a,b,function(){$.simularpublications(a,b,function(){})})})})};
$.googleresolver=function(a,b){if(config.googlecover||config.googlepreview){var c=$("#isbn_"+a).data("isbn");""!=c&&void 0!=c?resolver.google=$.ajax({url:"https://books.google.com/books?bibkeys=ISBN%3A"+c+"&jscmd=viewapi&callback=listEntries",method:"POST",crossDomain:!0,dataType:"jsonp",success:function(d){$.each(d,function(e,g){g.hasOwnProperty("embeddable")&&g.hasOwnProperty("thumbnail_url")&&g.hasOwnProperty("info_url")&&$("#isbn_"+a).html("<a target='_blank' href='"+g.info_url+"'><img class='img-responsive' src='"+
g.thumbnail_url+"' title='"+configlang.GOOGLEBOOKS+"' data-tooltip='tooltip' data-placement='buttom'></a>");g.hasOwnProperty("preview")&&"partial"==g.preview&&g.hasOwnProperty("preview_url")&&$("#isbn_"+a).append("<p></p><a target='_blank' href='"+g.preview_url+"'><img src='systemassets/lukida/img/google_preview_"+config.language+".gif'></a>")});$("#isbn_"+a).val(d);b()}}):b()}else b()};
$.linkresolver=function(a,b,c){linkresolver?(0<$("#linkresolvercontainer_"+b).length?$("#linkresolvercontainer_"+b).html("<div class='container-fluid'><div class='row'><div class='"+linkresolverclass+"'><div class='outercircle'></div><div class='innercircle'></div></div></div></div>"):$("#linkresolver_"+b).html("<div class='"+linkresolverclass+"'><div class='outercircle'></div><div class='innercircle'></div></div>"),resolver.link=$.ajax({url:"/ajax/linkresolver/",method:"POST",data:{ppn:a},dataType:"JSON",
success:function(d){var e="";$.each(d,function(g,f){e+="<button onclick='$.openLink(\""+f+"\")' class='"+linkresolverclass+" btn btn-default btn-exemplar'>"+configlang.FULLTEXT+" ("+configlang[g.toUpperCase()]+")</button>"});""!=e?0<$("#linkresolvercontainer_"+b).length?$("#linkresolvercontainer_"+b).html("<div>"+configlang.ACCESS+"</div><div class='container-fluid'><div class='row'>"+e+"</div></div>"):$("#linkresolver_"+b).html(e):($("#linkresolvercontainer_"+b).html(""),$("#linkresolver_"+b).html(""));
c()}})):($("#linkresolvercontainer_"+b).html(""),$("#linkresolver_"+b).html(""),c())};$.simularpublications=function(a,b,c){config.simularpubs?resolver.simular=$.ajax({url:"/ajax/searchsimularpubs/",method:"POST",data:{ppn:a},dataType:"JSON",success:function(d){0<d.hitspack?$("#simularpubscontent_"+b).html(d.results):$("#simularpubscontent_"+b).html("<div class='col-xs-12'><div class='well'>"+configlang.NOSIMULARHITS+"</div></div>");c()}}):c()};
$.exportlink=function(a,b){resolver.export=$.ajax({url:"/ajax/exportlink/",method:"POST",data:{ppnlist:JSON.stringify(a),format:"zotero"},dataType:"JSON",success:function(c){$.each(c,function(d,e){$(".Z3988").attr("title",e)});b()}})};
$.update_favs=function(){if("undefined"!==typeof Storage){var a=sessionStorage.favs?$.parseJSON(sessionStorage.favs):{};$(".fav").remove();$.each(a,function(b,c){$('<li><a id="'+b+'" class="fav" href="javascript:$.open_fullview(\''+b+"')\">"+c+"</a></li>").insertBefore(".favdivider1")});1<Object.keys(a).length?($(".favdivider1").removeClass("hide"),$(".compare").removeClass("hide")):($(".favdivider1").addClass("hide"),$(".compare").addClass("hide"));0<Object.keys(a).length?($(".nofavs").addClass("hide"),
$(".favdivider2").removeClass("hide"),$(".favstore").removeClass("hide"),$(".favdivider3").removeClass("hide"),$(".favclear").removeClass("hide")):($(".nofavs").removeClass("hide"),$(".favdivider2").addClass("hide"),$(".favstore").addClass("hide"),$(".favdivider3").addClass("hide"),$(".favclear").addClass("hide"))}};
$.update_favors=function(){$("#favors").html("");if(0<Object.keys(favors).length){var a=0;$.each(favors,function(b,c){a++;1==a%2&&$("#favors").append("<div class='row'>");$("#favors").append(c);0==a%2&&$("#favors").append("</div>")});1==a%2&&$("#favors").append("</div>");$(".countFavors").html(Object.keys(favors).length.toString());$(".countFavors").tooltip("show");setTimeout($.remove_tooltips,1E4);intervalID=setInterval(function(){$(".countFavors").animate({opacity:"0.5"}).delay(1E3).animate({opacity:"1"})},
3E3)}else $("#favors").append("<div class='col-xs-12'>"+configlang.CHECKLISTEMPTY+"</div>"),$(".countFavors").html(""),$(".countFavors").tooltip("hide")};
$.create_facets=function(){facetvals.yearminstart=parseInt($JSONData.yearmin);facetvals.yearmaxstart=parseInt($JSONData.yearmax);facetvals.yearmin=""!=facetvals.yearmin?facetvals.yearmin:facetvals.yearminstart;facetvals.yearmax=""!=facetvals.yearmax?facetvals.yearmax:facetvals.yearmaxstart;$.create_main_sliders({range:{min:facetvals.yearmin,max:facetvals.yearmax},start:[facetvals.yearminstart,facetvals.yearmaxstart],connect:!0,behaviour:"drag",step:1},function(){$(".editable").editable();$(".yearstart").on("shown",
function(a,b){b.input.$input.val($(".yearstart").html())});$(".yearend").on("shown",function(a,b){b.input.$input.val($(".yearend").html())});$(".yearstart").on("save",function(a,b){facetvals.yearminstart=Math.floor(b.newValue);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider1.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),slider2.noUiSlider.set([facetvals.yearminstart,
facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});$(".yearend").on("save",function(a,b){facetvals.yearmaxstart=Math.floor(b.newValue);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider1.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),slider2.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),
$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});$(".FACETYEARTOTAL").fadeIn("fast").removeClass("collapse")});$.create_facets_typ();$.create_facets_formats()};
$.create_main_sliders=function(a,b){"undefined"!=typeof slider1&&slider1.noUiSlider.destroy();slider1=document.getElementById("pubyear1");noUiSlider.create(slider1,a);"undefined"!=typeof slider2&&slider2.noUiSlider.destroy();slider2=document.getElementById("pubyear2");noUiSlider.create(slider2,a);slider1.noUiSlider.on("update",function(c,d){$(".yearstart").html(Math.floor(c[0]));$(".yearend").html(Math.floor(c[1]))});slider2.noUiSlider.on("update",function(c,d){$(".yearstart").html(Math.floor(c[0]));
$(".yearend").html(Math.floor(c[1]))});slider1.noUiSlider.on("change",function(c,d){facetvals.yearminstart=Math.floor(c[0]);facetvals.yearmaxstart=Math.floor(c[1]);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider2.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});slider2.noUiSlider.on("change",
function(c,d){facetvals.yearminstart=Math.floor(c[0]);facetvals.yearmaxstart=Math.floor(c[1]);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider1.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});b()};
$.create_facets_typ=function(){$(".onlines").html("");var a=parseInt($JSONData.online["true"])+parseInt($JSONData.online["false"]);$("#onlines1").append("<div class='radio'><label><input class='facettyp' name='facetonline1' class='TYPTOTAL'  value='total' type='radio'><span class='lbl_typtotal'>"+configlang.TYPTOTAL+"</span></label><span class='num_TYPTOTAL numtyp badge counter pull-right'>"+a+"</span></div>");$("#onlines1").append("<div class='radio'><label><input class='facettyp' name='facetonline1' class='TYPPRINT'  value='false' type='radio'><span class='lbl_typprint'>"+
configlang.TYPPRINT+"</span></label><span class='num_TYPPRINT numtyp badge counter pull-right'>"+$JSONData.online["false"]+"</span></div>");$("#onlines1").append("<div class='radio'><label><input class='facettyp' name='facetonline1' class='TYPELECTR' value='true'  type='radio'><span class='lbl_typelectr'>"+configlang.TYPELECTR+"</span></label><span class='num_TYPELECTR numtyp badge counter pull-right'>"+$JSONData.online["true"]+"</span></div>");$("#onlines2").append("<div class='radio'><label><input class='facettyp' name='facetonline2' class='TYPTOTAL'  value='total' type='radio'><span class='lbl_typtotal'>"+
configlang.TYPTOTAL+"</span></label><span class='num_TYPTOTAL numtyp badge counter pull-right'>"+a+"</span></div>");$("#onlines2").append("<div class='radio'><label><input class='facettyp' name='facetonline2' class='TYPPRINT'  value='false' type='radio'><span class='lbl_typprint'>"+configlang.TYPPRINT+"</span></label><span class='num_TYPPRINT numtyp badge counter pull-right'>"+$JSONData.online["false"]+"</span></div>");$("#onlines2").append("<div class='radio'><label><input class='facettyp' name='facetonline2' class='TYPELECTR' value='true'  type='radio'><span class='lbl_typelectr'>"+
configlang.TYPELECTR+"</span></label><span class='num_TYPELECTR numtyp badge counter pull-right'>"+$JSONData.online["true"]+"</span></div>");$("#onlines1").find("input[value='"+facetvals.typ+"']").prop("checked",!0);$("#onlines2").find("input[value='"+facetvals.typ+"']").prop("checked",!0);$(".facettyp").change(function(){$.set_facet("typ",$(this).val(),this.checked);"onlines1"==$(this).closest(".onlines").attr("id")&&$("#onlines2").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);
"onlines2"==$(this).closest(".onlines").attr("id")&&$("#onlines1").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);$.create_facets_formats()})};
$.create_facets_formats=function(){var a="",b="",c="",d="",e="",g=Math.ceil(formatslanguagesort.length/2);$.each(formatslanguagesort,function(f,k){valcount=void 0!==$JSONData.formats[k.id]?$JSONData.formats[k.id]:"";b=k.val;a="<div class='checkbox'><label><input class='facetformat' id='"+k.id+"' value='"+k.id+"' type='checkbox'><span class='lbl_"+k.id.replace(/ /g,"").toUpperCase()+"'>"+b+"</span></label><span class='num_"+k.id.replace(/ /g,"").toUpperCase()+" numformat badge counter pull-right'>"+
valcount+"</span></div>";c+=a;b=12<k.val.length?k.val.substring(0,12)+".":k.val;a="<div class='checkbox'><label><input class='facetformat' id='"+k.id+"' value='"+k.id+"' type='checkbox'><span class='lbl_"+k.id.replace(/ /g,"").toUpperCase()+"'>"+b+"</span></label><span class='num_"+k.id.replace(/ /g,"").toUpperCase()+" numformat badge counter pull-right'>"+valcount+"</span></div>";f<g?d+=a:e+=a});$("#formats1").html(c);$("#formats2").html("<div class='row'><div class='col-xs-6'>"+d+"</div><div class='col-xs-6'>"+
e+"</div></div>");$.each(facetvals.formats,function(f,k){$("#formats1").find("input[value='"+f+"']").prop("checked",!0);$("#formats2").find("input[value='"+f+"']").prop("checked",!0)});$(".facetformat").change(function(){"formats1"==$(this).closest(".formats").attr("id")&&$("#formats2").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);"formats2"==$(this).closest(".formats").attr("id")&&$("#formats1").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);$.set_facet("format",
$(this).val(),this.checked)})};
$.set_facet=function(a,b,c){"datapool"==a&&(facetvals={datapool:c,iln:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",yearminbase:"",yearmaxbase:"",typ:"total",formats:{}},$.new_search("init",searchvals.text));"phonetic"==a&&(facetvals.phonetic=c,$.new_search("init",searchvals.text));"iln"==a&&(facetvals={datapool:"",iln:c,yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",yearminbase:"",yearmaxbase:"",typ:"total",formats:{}},$.new_search("init",searchvals.text));
"year"==a&&($(".num_TYPTOTAL").html(""),$(".num_TYPPRINT").html(""),$(".num_TYPELECTR").html(""),$('input[name="facetonline"][value=total]').prop("checked",!0),facetvals.typ="total",facetvals.formats={},$(".numformat").html(""),$("input.facetformat:checkbox").attr("checked",!1),$.new_search("facet_year"));"typ"==a&&(facetvals[a]=b,facetvals.formats={},$(".numformat").html(""),$("input.facetformat:checkbox").attr("checked",!1),$.new_search("facet_typ"));"format"==a&&(c?(facetvals.formats[b]=c,$.new_search("facet_format_checked")):
(delete facetvals.formats[b],$.new_search("facet_format_unchecked")));$.post("/ajax/statsclient",{typ:"Facet",name:a,range:"day"})};
$.number_facets=function(a){void 0!=$JSONData&&("facet_year"==a.toLowerCase()&&($(".num_TYPTOTAL").html($JSONData.online.total),$(".num_TYPPRINT").html($JSONData.online["false"]),$(".num_TYPELECTR").html($JSONData.online["true"])),"facet_format_checked"!=a.toLowerCase()&&"facet_format_unchecked"!=a.toLowerCase()&&"facet_sort"!=a.toLowerCase()&&($(".numformat").html(""),0<Object.keys($JSONData.formats).length&&$.each($JSONData.formats,function(b,c){$(".num_"+b.replace(/ /g,"").toUpperCase()).html(c)})))};
$.format_hits=function(a){return 1E6<a?String(Math.round(a/1E4)/100).replace(".",",")+" Mio. ":1E3<a?String(Math.round(a/10)/100).replace(".",",")+" Tsd. ":a};$.set_sort=function(a){a!=facetvals.sort&&($.format_sort(a),facetvals.sort=a,$.new_search("facet_sort"))};$.format_sort=function(a){$(".sort"+facetvals.sort).removeClass("navbar-button-color").addClass("btn-default");$(".sort"+a).removeClass("btn-default").addClass("navbar-button-color")};
$.setup_settings=function(){$("#communitylibraries").prop("checked","global"==facetvals.datapool);$("#phoneticSwitch").prop("checked",1==facetvals.phonetic);void 0!=slider3&&""!=facetvals.yearminbase&&""!=facetvals.yearmaxbase&&slider3.noUiSlider.set([facetvals.yearminbase,facetvals.yearmaxbase]);$.each(settings,function(a,b){void 0!=b&&""!=b?(filters.includes(a)||filters.push(a),$("#"+a+"FilterValue").editable("setValue",b)):(filters.includes(a)&&filters.splice(filters.indexOf(a),1),$("#"+a+"FilterValue").editable("setValue",
""))})};$.update_settings=function(a){var b=0;$("#communitylibraries").is(":checked")?(facetvals.datapool="global",b++):facetvals.datapool="local";$("#phoneticSwitch").is(":checked")&&b++;facetvals.phonetic=$("#phoneticSwitch").is(":checked");0==b?(SettingsTooltip=!1,b="",$.remove_tooltips(),clearInterval(intervalID)):$.show_tooltips();$(".countSettings").html(b.toString());a()};
$.open_fullview=function(a,b,c,d){void 0===b&&(b=results.ppnlist);void 0===d&&(d=a);void 0===c&&(c="main");"main"!=c&&(b=jQuery.map(b,function(h,n){return h.toString()}));var e=dialogs.length,g=a in favors?configlang.CHECKLISTREMOVE:configlang.CHECKLIST,f=a in favors?"fa fa-star-o":"fa fa-star",k="publications"==c?$("#related_"+d).html():$("#"+d+" div.panel-heading").html(),l=new BootstrapDialog({message:'<div id="fullbody_'+e+'"><div class="outercircle"></div><div class="innercircle"></div></div>',
title:'<div id="fullheader_'+e+'">'+k+"</div>",size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{id:"prevbtn",icon:"glyphicon glyphicon-chevron-left",cssClass:"btn-default fullview-button-left hidden-xs hidden-sm",action:function(h){$(this).blur();0<b.indexOf(a)?(a=b[b.indexOf(a)-1],$("#fullbody_"+e).slideUp("fast","swing",function(){$.set_fullviewppn(a,e,c,function(){$("#fullbody_"+e).slideDown("fast")})})):$.user_message(configlang.FIRSTOBJECT,"warning")}},{id:"nextbtn",icon:"glyphicon glyphicon-chevron-right",
cssClass:"btn-default fullview-button-left hidden-xs hidden-sm",action:function(h){$(this).blur();"main"==c&&b.indexOf(a)<results.hits-1&&b.indexOf(a)==results.hitscurr-1?$.search_next_pack(function(){b=results.ppnlist;a=b[b.indexOf(a)+1];$("#fullbody_"+e).slideUp("fast","swing",function(){$.set_fullviewppn(a,e,c,function(){$("#fullbody_"+e).slideDown("fast")})})}):b.indexOf(a)<b.length-1?(a=b[b.indexOf(a)+1],$("#fullbody_"+e).slideUp("fast","swing",function(){$.set_fullviewppn(a,e,c,function(){$("#fullbody_"+
e).slideDown("fast")})})):$.user_message(configlang.LASTOBJECT,"warning")}},{label:" "+configlang.CANCEL,icon:"glyphicon glyphicon-menu-up",cssClass:"btn-default hidden-xs hidden-sm",action:function(h){h.close();$.focus_first()}},{id:"qrcodebtn_"+e,label:" "+configlang.QRCODE,icon:"fa fa-qrcode",cssClass:"btn-default hidden-xs hidden-sm",action:function(h){$(this).blur();$.open_qrcode()}},{id:"printbtn_"+e,label:" "+configlang.PRINT,icon:"fa fa-print",cssClass:"btn-default hidden-xs hidden-sm",action:function(h){$(this).blur();
h=window.open();h.document.write("<html><head><title>"+xtitle+"</title></head><body><p><img src='"+config.printlogo+"' style='max-width:300px;' />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>"+config.softwarename+" - "+urlport+window.location.host+"</b></span></p>");h.document.write("<table>"+$.getfullbody()+"</table>");h.document.write("</body></html");h.document.close();h.focus();h.print();h.close()}},{id:"mailbtn_"+e,label:" "+configlang.MAIL,icon:"glyphicon glyphicon-envelope",cssClass:"btn-default hidden-xs hidden-sm",
action:function(h){$(this).blur();favormails[a]="<table>"+$.getfullbody()+"</table>";""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail([a])}):$.open_mail([a])}},{id:"exportbtn_"+e,label:" "+configlang.EXPORT,icon:"glyphicon glyphicon-export",cssClass:"btn-default hidden-xs hidden-sm",action:function(h){$(this).blur();$.open_export([a])}},{id:"checklistbtn_"+e,label:' <span class="text">'+g+"</span>",icon:f,cssClass:"btn-default checklist hidden-xs hidden-sm",action:function(h){$(this).blur();
a in favors?(delete favors[a],delete favormails[a],delete favorprint[a],$.user_message(configlang.CHECKLISTREMOVESUCCESS,"success"),h='<span class="bootstrap-dialog-button-icon fa fa-star"></span> <span class="text">'+configlang.CHECKLIST+"</span>"):(favors[a]=$("#"+a).clone().removeClass("medium col-xs-12 col-sm-6 col-md-4 col-lg-3","col-md-6").addClass("merk col-md-6"),$(favors[a]).find("a").attr("href","javascript:$.open_fullview('"+a+"',Object.keys(favors));"),favormails[a]="<table>"+$.getfullbody()+
"</table>",favorprint[a]="<table>"+$.getfullbody()+"</table>",$.user_message(configlang.CHECKLISTSUCCESS,"success"),h='<span class="bootstrap-dialog-button-icon fa fa-star-o"></span> <span class="text">'+configlang.CHECKLISTREMOVE+"</span>");$("#checklistbtn_"+e).html(h);$("#checklistbtn_xs_"+e).html(h);$.update_favors()}},{id:"prevbtn_xs_"+e,icon:"glyphicon glyphicon-chevron-left",cssClass:"btn-default fullview-button-left hidden-md hidden-lg col-xs-2 col-sm-1 NoLeftMargin",action:function(h){$(this).blur();
0<b.indexOf(a)?(a=b[b.indexOf(a)-1],$("#fullbody_"+e).slideUp("fast","swing",function(){$.set_fullviewppn(a,e,c,function(){$("#fullbody_"+e).slideDown("fast")})})):$.user_message(configlang.FIRSTOBJECT,"warning")}},{id:"nextbtn_xs_"+e,icon:"glyphicon glyphicon-chevron-right",cssClass:"btn-default fullview-button-left hidden-md hidden-lg col-xs-2 col-sm-1 NoLeftMargin",action:function(h){$(this).blur();"main"==c&&b.indexOf(a)<results.hits-1&&b.indexOf(a)==results.hitscurr-1?$.search_next_pack(function(){b=
results.ppnlist;a=b[b.indexOf(a)+1];$("#fullbody_"+e).slideUp("fast","swing",function(){$.set_fullviewppn(a,e,c,function(){$("#fullbody_"+e).slideDown("fast")})})}):b.indexOf(a)<b.length-1?(a=b[b.indexOf(a)+1],$("#fullbody_"+e).slideUp("fast","swing",function(){$.set_fullviewppn(a,e,c,function(){$("#fullbody_"+e).slideDown("fast")})})):$.user_message(configlang.LASTOBJECT,"warning")}},{id:"checklistbtn_xs_"+e,label:' <span class="text">'+g+"</span>",icon:f,cssClass:"btn-default checklist hidden-md hidden-lg col-xs-4 col-sm-4 LeftOffset2",
action:function(h){$(this).blur();a in favors?(delete favors[a],delete favormails[a],delete favorprint[a],$.user_message(configlang.CHECKLISTREMOVESUCCESS,"success"),h='<span class="bootstrap-dialog-button-icon fa fa-star"></span> <span class="text">'+configlang.CHECKLIST+"</span>"):(favors[a]=$("#"+a).clone().removeClass("medium col-xs-12 col-sm-6 col-md-4 col-lg-3","col-md-6").addClass("merk col-md-6"),$(favors[a]).find("a").attr("href","javascript:$.open_fullview('"+a+"',Object.keys(favors));"),
favormails[a]="<table>"+$.getfullbody()+"</table>",favorprint[a]="<table>"+$.getfullbody()+"</table>",$.user_message(configlang.CHECKLISTSUCCESS,"success"),h='<span class="bootstrap-dialog-button-icon fa fa-star-o"></span> <span class="text">'+configlang.CHECKLISTREMOVE+"</span>");$("#checklistbtn_"+e).html(h);$("#checklistbtn_xs_"+e).html(h);$.update_favors()}},{label:" "+configlang.CANCEL,icon:"glyphicon glyphicon-menu-up",cssClass:"btn-default hidden-md hidden-lg col-xs-4 col-sm-2 LeftOffset2",
action:function(h){h.close();$.focus_first()}},{id:"qrcodebtn_xs_"+e,label:" QR",icon:"fa fa-qrcode",cssClass:"btn-default hidden-md hidden-lg col-xs-2 col-sm-2 NoLeftMargin",action:function(h){$(this).blur();$.open_qrcode()}},{id:"exportbtn_xs_"+e,label:" "+configlang.EXPORT,icon:"glyphicon glyphicon-export",cssClass:"btn-default hidden-md hidden-lg col-xs-4 col-sm-2 LeftOffset2",action:function(h){$(this).blur();$.open_export([a])}},{id:"printbtn_xs_"+e,label:" "+configlang.PRINT,icon:"fa fa-print",
cssClass:"btn-default hidden-md hidden-lg col-xs-3 col-sm-2 NoLeftMargin",action:function(h){$(this).blur();h=window.open();h.document.write("<html><head><title>"+xtitle+"</title></head><body><p><img src='"+config.printlogo+"' style='max-width:300px;' />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>"+config.softwarename+" - "+urlport+window.location.host+"</b></span></p>");h.document.write("<table>"+$.getfullbody()+"</table>");h.document.write("</body></html");h.document.close();h.focus();
h.print();h.close()}},{id:"mailbtn_xs_"+e,label:" "+configlang.MAIL,icon:"glyphicon glyphicon-envelope",cssClass:"btn-default hidden-md hidden-lg col-xs-3 col-sm-2 LeftOffset2",action:function(h){$(this).blur();favormails[a]="<table>"+$.getfullbody()+"</table>";""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail([a])}):$.open_mail([a])}}],onhidden:function(){dialogs.pop();$.show_answer();statevals.ppnlist.pop();$.replace_state()},onshown:function(){dialogs.push(l);$.set_fullviewppn(a,
e,c,function(){$.is_Empty(statevals)&&(statevals={});$.is_Empty(statevals.ppnlist)&&(statevals.ppnlist=[]);statevals.ppnlist.push({ppn:a,ppnlist:b,typ:c,parentppn:d})})}});l.realize();l.getModalHeader().addClass("preview-header");l.setData("ppn",a);l.setData("name","fullview_"+e);l.open()};
$.set_fullviewppn=function(a,b,c,d){$.set_buttons(a,b,"disable");$.close_resolvers();resolver.fullview=$.ajax({url:"/ajax/fullview/"+a+"/"+b,method:"GET",crossDomain:!0,success:function(e){"publications"==c?$("#fullheader_"+b).html($("#related_"+a).html()):$("#fullheader_"+b).html($("#"+a+" div.panel-heading").html());$("#fullbody_"+b).html(e);d();$.set_buttons(a,b,"enable");$.opened_fullview(a,b)}})};
$.set_buttons=function(a,b,c){void 0==c&&(c="enable");"disable"==c&&(config.button_checklist?($("#checklistbtn_"+b).prop("disabled",!0),$("#checklistbtn_xs_"+b).prop("disabled",!0)):($("#checklistbtn_"+b).hide(),$("#checklistbtn_xs_"+b).hide()),config.button_export?($("#exportbtn_"+b).prop("disabled",!0),$("#exportbtn_xs_"+b).prop("disabled",!0)):($("#exportbtn_"+b).hide(),$("#exportbtn_xs_"+b).hide()),config.button_qrcode?($("#qrcodebtn_"+b).prop("disabled",!0),$("#qrcodebtn_xs_"+b).prop("disabled",
!0)):($("#qrcodebtn_"+b).hide(),$("#qrcodebtn_xs_"+b).hide()),config.button_mail?($("#mailbtn_"+b).prop("disabled",!0),$("#mailbtn_xs_"+b).prop("disabled",!0)):($("#mailbtn_"+b).hide(),$("#mailbtn_xs_"+b).hide()),config.button_print?($("#printbtn_"+b).prop("disabled",!0),$("#printbtn_xs_"+b).prop("disabled",!0)):($("#printbtn_"+b).hide(),$("#printbtn_xs_"+b).hide()));"enable"==c&&(config.button_checklist&&($("#checklistbtn_"+b).prop("disabled",!1),$("#checklistbtn_xs_"+b).prop("disabled",!1)),config.button_export&&
($("#exportbtn_"+b).prop("disabled",!1),$("#exportbtn_xs_"+b).prop("disabled",!1)),config.button_mail&&($("#mailbtn_"+b).prop("disabled",!1),$("#mailbtn_xs_"+b).prop("disabled",!1)),config.button_qrcode&&($("#qrcodebtn_"+b).prop("disabled",!1),$("#qrcodebtn_xs_"+b).prop("disabled",!1)),config.button_print&&($("#printbtn_"+b).prop("disabled",!1),$("#printbtn_xs_"+b).prop("disabled",!1)));a=a in favors?'<span class="bootstrap-dialog-button-icon fa fa-star-o"></span> <span class="text">'+configlang.CHECKLISTREMOVE+
"</span>":'<span class="bootstrap-dialog-button-icon fa fa-star"></span> <span class="text">'+configlang.CHECKLIST+"</span>";$("#checklistbtn_"+b).html(a);$("#checklistbtn_xs_"+b).html(a)};
$.open_settings=function(){var a=dialogs.length;(new Date).getFullYear();void 0!=facetvals.yearminbase&&void 0!=facetvals.yearmaxbase&&""!=facetvals.yearminbase&&""!=facetvals.yearmaxbase||(new Date).getFullYear();var b=JSON.stringify(settings),c=facetvals.datapool,d=facetvals.phonetic,e="["+facetvals.yearminbase+" TO "+facetvals.yearmaxbase+"]",g=new BootstrapDialog({message:$('<div id="settings_'+a+'"></div>').load("/ajax/settings/"+a,function(){}),title:configlang.SETTINGS,size:BootstrapDialog.SIZE_WIDE,
closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(f){f.close();$.focus_first()}},{icon:"fa fa-check",label:" OK",cssClass:"fullview-button-color",action:function(f){$(this).blur();$.update_settings(function(){facetvals.typ="total";facetvals.formats={};facetvals.yearmin=facetvals.yearminbase;facetvals.yearmax=facetvals.yearmaxbase;facetvals.yearminstart=facetvals.yearminbase;facetvals.yearmaxstart=facetvals.yearmaxbase;facetvals.yearrange="["+facetvals.yearminbase+
" TO "+facetvals.yearmaxbase+"]";b==JSON.stringify(settings)&&e==facetvals.yearrange&&c==facetvals.datapool&&d==facetvals.phonetic||$.new_search("init",$("#searchtext_md").val());f.close()})}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){"global"==facetvals.datapool&&$("#communitylibraries").prop("checked",!0);1==facetvals.phonetic&&$("#phoneticSwitch").prop("checked",!0);dialogs.push(g)}});g.realize();g.getModalHeader().addClass("preview-header");g.setData("name","settings");
g.open()};
$.open_settingsstore=function(a){var b=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="settingsname" class="col-sm-3 control-label">'+configlang.DESCRIPTION+'</label><div class="col-sm-9"><input type="text" class="form-control" id="settingsname" placeholder="'+configlang.DESCRIPTION+'"></div></div><div id="settingsstore_messagebar"></div></div>',title:configlang.STORE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(c){c.close();
$.focus_first();settingsname=""}},{icon:"glyphicon glyphicon-triangle-bottom",label:" "+configlang.OK,cssClass:"fullview-button-color",action:function(c){settingsname=$("#settingsname").val();c.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer();a()},onshown:function(){$("#settingsname").focus();dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","settingsstore");b.open()};
$.open_settingsview=function(a){var b=new BootstrapDialog({message:$('<div id="settingsview"></div>').load("/ajax/settingsview/",function(){}),title:configlang.LOAD,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(c){c.close();$.focus_first();settingsname=""}},{icon:"fa fa-trash-o",label:" "+configlang.DELETE,action:function(c){var d=0,e=[];$(".check_settingsload").each(function(g){1==$(this).prop("checked")&&(d++,e.push($(this).data("id")))});0==
d?$.user_message(configlang.NOOPTION,"warning"):($.open_suredialog(function(g){1==g&&$.post("/ajax/settingsdelete",{ids:JSON.stringify(e)},function(f){"0"<=f&&($("#settings_messagebar").append($("<div id='message0' class='alert-message success' data-alert></div>")),$("#message0").hide().html("<div class='panel panel-success'><div class='panel-heading'>"+configlang.SETTINGSDELETESUCCESS+"</div></div>").fadeIn("fast"),$("#message0").delay(3E3).fadeOut("slow",function(){$(this).remove()}))})}),c.close())}},
{icon:"glyphicon glyphicon-open",label:" "+configlang.LOAD,cssClass:"fullview-button-color",action:function(c){var d=0,e="";$(".check_settingsload").each(function(g){1==$(this).prop("checked")&&(d++,e=$(this).data("id"))});0==d?$.user_message(configlang.NOOPTION,"warning"):2<=d?$.user_message(configlang.ONLYONEOPTION,"warning"):($.post("/ajax/settingsload",{id:e},function(g){"0"<=g&&(settings=g.settings.settings,facetvals=g.settings.facetvals,answer.status="success",answer.message=configlang.SETTINGSLOADSUCCESS)},
"json"),c.close())}}],onhidden:function(){dialogs.pop();$.show_answer();a()},onshown:function(){$("#settingsname").focus();dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","settingsview");b.open()};
$.open_favors=function(){var a=new BootstrapDialog({message:'<div class="row" id="favors"></div><div id="favor_messagebar"></div>',title:configlang.CHECKLIST+" "+config.softwarename,closable:!0,size:BootstrapDialog.SIZE_WIDE,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(b){b.close()}},{id:"print",icon:"fa fa-print",label:" "+configlang.PRINT,action:function(b){$(this).blur();if(0<Object.keys(favorprint).length){b=window.open();b.document.write("<html><head><title>"+
xtitle+"</title></head><body><p><img src='"+urlport+window.location.host+"/"+config.printlogo+"' style='max-width:300px;' />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>"+config.softwarename+" - "+urlport+window.location.host+"</b></span></p>");for(var c=Object.keys(favorprint),d=0,e=c.length;d<e;d++)b.document.write(favorprint[c[d]]),d<e-1&&b.document.write("<hr>");b.document.write("</body></html");b.document.close();b.focus();b.print();b.close()}}},{id:"mail",icon:"glyphicon glyphicon-envelope",
label:" "+configlang.MAIL,action:function(b){$(this).blur();""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail(Object.keys(favors))}):$.open_mail(Object.keys(favors))}},{id:"export",icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,action:function(b){$(this).blur();$.open_export(Object.keys(favors))}},{icon:"fa fa-eraser",label:" "+configlang.CHECKLISTCLEAR,action:function(b){$(this).blur();favors={};favorprint={};favormail={};answer.status="success";answer.message=
configlang.CHECKLISTCLEARSUCCESS;$.update_favors();b.close()}}],onhidden:function(){dialogs.pop();$.show_answer();$.focus_first()},onshown:function(){dialogs.push(a);$.update_favors()}});a.realize();a.getModalHeader().addClass("preview-header");config.button_export||a.getButton("export").hide();config.button_mail||a.getButton("mail").hide();config.button_print||a.getButton("print").hide();a.setData("name","favors");a.open()};
$.open_suredialog=function(a){var b=!1,c=new BootstrapDialog({title:configlang.AREYOUSURE,message:configlang.AREYOUSURE,size:BootstrapDialog.SIZE_SMALL,closable:!0,buttons:[{icon:"fa fa-ban",label:" "+configlang.NO,action:function(d){d.close();b=!1}},{icon:"fa fa-check",label:" "+configlang.YES,action:function(d){d.close();b=!0}}],onhidden:function(){a(b)}});c.realize();c.getModalHeader().addClass("preview-header");c.setData("name","sure");c.open()};
$.open_user=function(a){a=$('<div id="userbody"></div>').load("/ajax/userview/"+a);if("ERROR:"==$.trim(a).substr(0,6).toUpperCase())$.user_message($.trim(a).slice(6),"warning");else{var b=new BootstrapDialog({message:a,title:configlang.AREA+" "+usrconfig.firstname+" "+usrconfig.lastname,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(c){c.close();$.focus_first()}},{icon:"glyphicon glyphicon-triangle-bottom",label:" "+
configlang.OK,cssClass:"fullview-button-color",action:function(c){c.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","user");b.open()}};
$.open_qrcode=function(){var a=window.location.href,b=new BootstrapDialog({message:'<div class="form-horizontal"><h4>'+configlang.QRCODELONG+':</h4><div id="qrcodeCanvas"></div><div id="qrcode_messagebar"></div></div>',title:configlang.QRCODE,size:BootstrapDialog.SIZE_SMALL,closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(c){status=-1;c.close()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshow:function(){},onshown:function(){$("#qrcodeCanvas").qrcode({text:a});
dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","qrcode");b.open()};
$.open_mail=function(a){if(""!=usrconfig){void 0!=usrconfig.email&&""!=usrconfig.email||$.user_message(configlang.PROVIDEMAIL,"warning");var b=usrconfig.email,c=(usrconfig.firstname+" "+usrconfig.lastname).trim(),d=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="mailto" class="col-sm-3 control-label">'+configlang.MAILRECIPIENT+'</label><div class="col-sm-9"><input type="mail" class="form-control" id="mailto" placeholder="'+configlang.MAILRECIPIENT+'"></div></div><div class="form-group"><label for="msg" class="col-sm-3 control-label">'+
configlang.YOURMESSAGE+'</label><div class="col-sm-9"><textarea class="form-control" rows="5" id="msg" placeholder="'+configlang.YOURMESSAGE+'"></textarea></div></div><div id="mail_messagebar"></div></div>',title:configlang.SENDMAIL,closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(e){status=-1;e.close()}},{icon:"glyphicon glyphicon-log-in",label:" "+configlang.SENDMAIL,cssClass:"fullview-button-color",action:function(e){$(this).blur();$.close_resolvers();
username=$("#username").val();mailfrom=$("#mailfrom").val();mailto=$("#mailto").val();msg=$("#msg").val();if(""==mailto)return $.user_message(configlang.REQUIREDFIELD,"warning"),$("#mailto").focus(),-1;if(!$.validateEmail(mailto))return $.user_message(configlang.MAILWRONG,"warning"),$("#mailto").focus(),-1;$.post("/ajax/mailto",{ppnlist:JSON.stringify(a),username:JSON.stringify(c),mailfrom:b,mailto:mailto,msg:JSON.stringify(msg),fullbody:JSON.stringify(favormails)},function(g){"0"<=g&&($.user_message(configlang.MAILSUCCESS,
"success"),e.close())})}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(d);$("#username").focus()}});d.realize();d.getModalHeader().addClass("preview-header");d.setData("name","mail");d.open()}};
$.open_export=function(a){exportdialog=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label class="col-sm-2">Format</label><div class="col-sm-10"><div class="radio"><label><input type="radio" name="export" id="refworks" value="refworks" checked>refWorks</label></div><div class="radio"><label><input type="radio" name="export" id="citavi" value="citavi">Citavi</label></div><div class="radio"><label><input type="radio" name="export" id="endnote" value="endnote">Endnote</label></div><div class="radio"><label><input type="radio" name="export" id="bibtex" value="bibtex">BibTeX</label></div></div><div id="export_messagebar"></div></div></div>',title:configlang.EXPORT,
closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(b){$(this).blur();status=-1;b.close()}},{icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,cssClass:"fullview-button-color",action:function(b){$(this).blur();var c=$("input[name=export]:checked").val();"refworks"==c?$.post("/ajax/exportlink",{ppnlist:JSON.stringify(a),format:c},function(d){""!=d&&$.each(d,function(e,g){window.open(g,"_blank")})},"json"):window.open(urlport+window.location.host+
"/exportfilelist/"+a+"/"+c,"_blank");b.close()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(exportdialog)}});exportdialog.realize();exportdialog.getModalHeader().addClass("preview-header");exportdialog.setData("name","export");exportdialog.open()};
$.open_wait=function(){waitdialog=new BootstrapDialog({message:'<div class="outercircle"></div><div class="innercircle"></div>',cssClass:"wait",animate:!1,closable:!1});waitdialog.realize();waitdialog.getModalHeader().hide();waitdialog.getModalFooter().hide();waitdialog.open()};
$.open_password=function(){var a=new BootstrapDialog({message:$('<div id="passwordview"></div>').load("/ajax/passwordview/",function(){}),title:configlang.CHANGEPASSWORD,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(b){b.close();$.focus_first()}},{icon:"fa fa-repeat",label:" "+configlang.CHANGEPASSWORD,cssClass:"fullview-button-color",id:"changepwbutton",action:function(b){$(this).blur();old=$("#oldpassword").val().trim();new1=$("#newpasswort1").val().trim();
new2=$("#newpasswort2").val().trim();if(""==old||""==new1||""==new2)return $.user_message(configlang.REQUIREDALLFIELDS,"warning"),""==old?$("#oldpassword").focus():""==newpasswort1?$("#newpasswort1").focus():$("#newpasswort2").focus(),-1;if(new1!=new2)return $.user_message(configlang.PASSWORDSWRONG,"warning"),$("#newpasswort1").val(""),$("#newpasswort2").val(""),$("#newpasswort1").focus(),-1;$.close_resolvers();$.post("/ajax/changepw",{old:old,new:new2},function(c){"-2"!=c.status?(b.close(),answer.status=
"success",answer.message=configlang.PASSWORDSUCCESS):($.user_message(c.error,"warning"),$("#oldpassword").focus())},"json")}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(a);$("#oldpassword").focus();$(".keyenter").keypress(function(b){13==b.which&&($(this).blur(),$("#changepwbutton").focus().click())})}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","password");a.open()};
$.login=function(a,b){var c="",d="",e="",g="",f=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="kennung" class="col-sm-3 control-label">'+configlang.USERNUMBER+'</label><div class="col-sm-9"><input type="text" class="form-control keyenter" id="kennung" placeholder="'+configlang.USERNUMBER+'"></div></div><div class="form-group"><label for="passwort" class="col-sm-3 control-label">'+configlang.PASSWORD+'</label><div class="col-sm-9"><input type="password" class="form-control keyenter" id="passwort" placeholder="'+
configlang.PASSWORD+'"></div></div><div id="login_messagebar"></div></div>',title:"Login "+config.softwarename,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(k){k.close();$.focus_first()}},{icon:"glyphicon glyphicon-log-in",label:" "+configlang.LOGIN,cssClass:"fullview-button-color",id:"loginbutton",action:function(k){$(this).blur();user=$("#kennung").val().trim();pw=$("#passwort").val().trim();if(""==user||""==pw)return $.user_message(configlang.REQUIREDTWOFIELDS,
"warning"),""==user?$("#kennung").focus():$("#passwort").focus(),-1;$.open_wait();$.close_resolvers();$.post("/ajax/login",{user:user,pw:pw},function(l){$.close_wait();"-1"!=l?(k.close(),$(".nologinarea").addClass("hide"),$(".loginarea").removeClass("hide"),usrconfig=l,timer=!0,$.startTimer(),answer.status="success",answer.message=configlang.LOGINSUCCESS.replace("{firstname}",l.firstname).replace("{lastname}",l.lastname),l.message&&(c="warning",d=l.messagetext),l.note&&(e="warning",g=l.note),b()):
($.user_message(configlang.LOGINERROR,"warning"),$("#kennung").focus(),usrconfig="");$.focus_first()},"json")}}],onhidden:function(){dialogs.pop();$.show_answer();""!=c&&$.user_message(d,c,1E4);""!=e&&$.user_message(g,e,1E4)},onshown:function(){dialogs.push(f);"1"==config.devmode&&($("#kennung").val(config.devuser),$("#passwort").val(config.devpassword));$("#kennung").focus();$(".keyenter").keypress(function(k){13==k.which&&($(this).blur(),$("#loginbutton").focus().click())});void 0!=a&&""!=a&&$.user_message(configlang[a],
"warning")}});f.realize();f.getModalHeader().addClass("preview-header");f.setData("name","login");f.open()};$.loginonly=function(){$.login("",function(){})};
$.logout=function(){var a=new BootstrapDialog({message:"<div>"+configlang.LOGOUTREALLY.replace("{system}",config.softwarename)+'<div id="logout_messagebar"></div></div>',title:"Logout "+config.softwarename,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(b){b.close();$.focus_first()}},{icon:"glyphicon glyphicon-log-out",label:" "+configlang.LOGOUT,cssClass:"fullview-button-color",action:function(b){$.open_wait();$.close_resolvers();$.post("/ajax/logout",
function(c){$.close_wait();b.close();$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide");$.reset_session()},"json")}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(a)}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","logout");a.open()};
$.shelve=function(a,b,c,d){c=a="";for(var e in d)"action"!=e&&"typ"!=e&&"id"!=e&&"iln"!=e&&"class"!=e&&""!=d[e]&&(""==c&&(c=e.replace(/\d/g,"")),""!=c&&c!=e.replace(/\d/g,"")&&(c=e.replace(/\d/g,""),a+="<br />"),a+=d[e].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;"),"list"!=c&&(a+="<br />"));a+='<br /><div id="shelve_messagebar"></div>';d=$("#"+b+" div.panel-heading").html();void 0==d&&(d=$("#related_"+b).html());var g=new BootstrapDialog({message:a,title:d,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",
label:" "+configlang.CANCEL,action:function(f){f.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(g)}});g.realize();g.getModalHeader().addClass("preview-header");g.setData("name","shelve");g.open()};
$.reservation=function(a,b,c,d){if(void 0!=d.id){var e=c="";for(f in d)if("action"!=f&&"typ"!=f&&"id"!=f&&"iln"!=f&&"class"!=f&&""!=d[f])if(""==e&&(e=f.replace(/\d/g,"")),""!=e&&e!=f.replace(/\d/g,"")&&("radio"!=e&&(c+="<br />"),e=f.replace(/\d/g,"")),"radio"==e)if("radio0"==f)c+=d[f]+"<br />";else{var g=d[f].split("|");c+="<div class='radio'><label><input type='radio' value='"+g[0]+"' name='counter'>"+g[1]+"</label></div>"}else"hidden"==e?c+="<input class='hidden' type='text' value='"+d[f]+"' name='counter'>":
(c+=d[f].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;"),"list"!=e&&(c+="<br />"));c+='<div id="reservation_messagebar"></div>';var f=$("#"+b+" div.panel-heading").html();void 0==f&&(f=$("#related_"+b).html());var k=new BootstrapDialog({message:c,title:f,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(l){l.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.RESERVATION,cssClass:"fullview-button-color",action:function(l){$(this).blur();
var h="";if($("input[name='counter']").length)if($("input[name='counter']").is(":hidden"))h=$("input[name='counter']:hidden").val();else{if(!$("input[name='counter']").is(":checked")){$.user_message(configlang.SELECTDESK,"warning");return}h=$("input[name='counter']:checked").val()}$.request(a,d.id,configlang.RESERVATIONSUCCESS,h,"reserve",function(n){"warning"==n.status?($.user_message(n.message,n.status),n.message="",n.status=""):l.close()})}}],onhidden:function(){dialogs.pop();$.show_answer()},
onshown:function(){dialogs.push(k)}});k.realize();k.getModalHeader().addClass("preview-header");k.setData("name","reservation");k.open()}};
$.order=function(a,b,c,d){if(void 0!=d.id){var e=c="";for(f in d)if("action"!=f&&"typ"!=f&&"id"!=f&&"iln"!=f&&"class"!=f&&""!=d[f])if(""==e&&(e=f.replace(/\d/g,"")),""!=e&&e!=f.replace(/\d/g,"")&&("radio"!=e&&(c+="<br />"),e=f.replace(/\d/g,"")),"radio"==e)if("radio0"==f)c+=d[f]+"<br />";else{var g=d[f].split("|");c+="<div class='radio'><label><input type='radio' value='"+g[0]+"' name='counter'>"+g[1]+"</label></div>"}else"hidden"==e?c+="<input class='hidden' type='text' value='"+d[f]+"' name='counter'>":
(c+=d[f].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;"),"list"!=e&&(c+="<br />"));c+='<div id="order_messagebar"></div>';var f=$("#"+b+" div.panel-heading").html();void 0==f&&(f=$("#related_"+b).html());var k=new BootstrapDialog({message:c,title:f,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(l){l.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.ORDER,cssClass:"fullview-button-color",action:function(l){$(this).blur();var h=
"";if($("input[name='counter']").length)if($("input[name='counter']").is(":hidden"))h=$("input[name='counter']:hidden").val();else{if(!$("input[name='counter']").is(":checked")){$.user_message(configlang.SELECTDESK,"warning");return}h=$("input[name='counter']:checked").val()}$.request(a,d.id,configlang.ORDERSUCCESS,h,"order",function(n){"warning"==n.status?($.user_message(n.message,n.status),n.message="",n.status=""):l.close()})}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(k)}});
k.realize();k.getModalHeader().addClass("preview-header");k.setData("name","order");k.open()}};
$.request=function(a,b,c,d,e,g){$.close_resolvers();""==usrconfig?$.login("LOGINFIRST",function(){$.post("/ajax/request",{iln:a,uri:b,desk:d,action:e},function(f){0>f.status?(answer.status="warning",answer.message=configlang.PROCESSSTOPPED+"<br />"+f.error):(answer.status="success",answer.message=c);g(answer)},"json")}):$.post("/ajax/request",{iln:a,uri:b,desk:d,action:e},function(f){0>f.status?(answer.status="warning",answer.message=configlang.PROCESSSTOPPED+"<br />"+f.error):(answer.status="success",
answer.message=c);g(answer)},"json")};$.getfullbody=function(){var a="",b=dialogs.length;do $("#biblio_"+b).length&&(tmp=$("#biblio_"+b).clone(),$(tmp).find("[data-toggle='popover']").remove(),a=$(tmp).html()),b--;while(""==a&&0<=b);return a};
$.mailorder=function(a,b,c,d){a=$("#"+b+" div.panel-heading").html();void 0==a&&(a=$("#related_"+b).html());var e="ORDER",g="MAILORDER",f="Magazinbestellung";$.close_resolvers();var k=new BootstrapDialog({message:$('<div id="mailorderviewbody"></div>').load("/ajax/mailorderview/"+b+"/"+c,function(l,h,n){e=$(l).wrapAll($("<div>")).parent().find("#mailbutton").attr("value").toString();g=$(l).wrapAll($("<div>")).parent().find("#mailtyp").attr("value").toString();f=$(l).wrapAll($("<div>")).parent().find("#mailsubject").attr("value").toString();
k.getButton("mailbtn").html("<span class='bootstrap-dialog-button-icon fa fa-map-marker'></span> "+e)}),title:a,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(l){l.close();$.focus_first()}},{id:"mailbtn",icon:"fa fa-map-marker",label:" "+configlang.ORDER,cssClass:"fullview-button-color",action:function(l){$(this).blur();var h=$("input[name=mailto]:checked").val(),n=$("input[name=mailto]:checked").parent().text();void 0==h&&(h=$("#mailto").attr("value"));
void 0==n&&(n=$("#mailto").data("label"));if(void 0==h)return $.user_message("Die MailTo-Adresse konnte nicht ermittelt werden!","warning"),-1;var r=$("input[name=mailfrom]:checked").val();void 0==r&&(r=$("#mailfrom").attr("value"));if(void 0==r)return $.user_message("Die MailFrom-Adresse konnte nicht ermittelt werden!","warning"),-1;if(""==usrconfig)$.login("LOGINFIRST",function(){var t={},m=$("input[name=volume]").val();void 0!=m&&(t.volume=m);m=$("#msg").val();void 0==m&&(m=$("input[name=msg]:checked").val());
void 0!=m&&(t.msg=m);m=$("#msg2").val();void 0==m&&(m=$("input[name=msg2]:checked").val());void 0!=m&&(t.msg2=m);m=$("#msg3").val();void 0==m&&(m=$("input[name=msg3]:checked").val());void 0!=m&&(t.msg3=m);$("div[name=userinput]").find(":input").each(function(){t[$(this).attr("name")]=$(this).val()});m="<table>"+$.getfullbody()+"</table>";$.post("/ajax/mailorderto",{exemplar:JSON.stringify(d),fullbody:JSON.stringify(m),ppn:b,epn:c,mailto:h,mailtoname:n,mailfrom:r,userinput:JSON.stringify(t),mailtyp:g,
mailsubject:f,userconfig:JSON.stringify(usrconfig)},function(u){if(0>u.status){if(-3==u.status)return $.user_message(u.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+u.error,"warning")}else answer.status="success",answer.message=configlang.ORDERSUCCESS,l.close()},"json")});else{var q={},p=$("input[name=volume]").val();void 0!=p&&(q.volume=p);p=$("#msg").val();void 0==p&&(p=$("input[name=msg]:checked").val());void 0!=p&&(q.msg=p);p=$("#msg2").val();void 0==p&&(p=$("input[name=msg2]:checked").val());
void 0!=p&&(q.msg2=p);p=$("#msg3").val();void 0==p&&(p=$("input[name=msg3]:checked").val());void 0!=p&&(q.msg3=p);$("div[name=userinput]").find(":input").each(function(){q[$(this).attr("name")]=$(this).val()});p="<table>"+$.getfullbody()+"</table>";$.post("/ajax/mailorderto",{exemplar:JSON.stringify(d),fullbody:JSON.stringify(p),ppn:b,epn:c,mailto:h,mailtoname:n,mailfrom:r,userinput:JSON.stringify(q),mailtyp:g,mailsubject:f,userconfig:JSON.stringify(usrconfig)},function(t){if(0>t.status){if(-3==t.status)return $.user_message(t.error,
"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+t.error,"warning")}else answer.status="success",answer.message=configlang.ORDERSUCCESS,l.close()},"json")}}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(l){dialogs.push(k)}});k.realize();k.getModalHeader().addClass("preview-header");k.setData("name","mailorder");k.open()};
$.special=function(a,b,c,d){a=$("#"+b+" div.panel-heading").html();void 0==a&&(a=$("#related_"+b).html());var e="SPECIAL",g="SPECIALORDER",f="Magazinbestellung";$.close_resolvers();var k=new BootstrapDialog({message:$('<div id="specialviewbody"></div>').load("/ajax/specialview/"+b+"/"+c,function(l,h,n){e=$(l).wrapAll($("<div>")).parent().find("#specialbutton").attr("value").toString();g=$(l).wrapAll($("<div>")).parent().find("#specialtyp").attr("value").toString();f=$(l).wrapAll($("<div>")).parent().find("#specialsubject").attr("value").toString();
k.getButton("specialbtn").html("<span class='bootstrap-dialog-button-icon fa fa-map-marker'></span> "+e)}),title:a,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(l){l.close();$.focus_first()}},{id:"specialbtn",icon:"fa fa-map-marker",label:" "+configlang.SPECIAL,cssClass:"fullview-button-color",action:function(l){$(this).blur();var h=$("input[name=special1]:checked").val();void 0==h&&(h=$("#special1").attr("value"));void 0==h&&(h=$("#special1").val());
if(void 0==h)return $.user_message("Special1 konnte nicht ermittelt werden!","warning"),-1;var n=$("input[name=special2]:checked").val();void 0==n&&(n=$("#special2").attr("value"));void 0==n&&(n=$("#special2").val());if(void 0==n)return $.user_message("Special2 konnte nicht ermittelt werden!","warning"),-1;var r=$("input[name=special3]:checked").val();void 0==r&&(r=$("#special3").attr("value"));void 0==r&&(r=$("#special3").val());if(void 0==r)return $.user_message("Special3 konnte nicht ermittelt werden!",
"warning"),-1;var q=$("input[name=special4]:checked").val();void 0==q&&(q=$("#special4").attr("value"));void 0==q&&(q=$("#special4").val());if(void 0==q)return $.user_message("Special4 konnte nicht ermittelt werden!","warning"),-1;var p=$("input[name=special5]:checked").val();void 0==p&&(p=$("#special5").attr("value"));void 0==p&&(p=$("#special5").val());if(void 0==p)return $.user_message("Special5 konnte nicht ermittelt werden!","warning"),-1;if(""==usrconfig)$.login("LOGINFIRST",function(){var m=
{exemplar:d,userinput:{special1:h,special2:n,special3:r,special4:q,special5:p},specialsubject:f,userconfig:usrconfig,epn:c};$.post("/ajax/libraryspecial",{action:g,ppnlist:JSON.stringify(b),fields:JSON.stringify(m)},function(u){if(0>u.status){if(-3==u.status)return $.user_message(u.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+u.error,"warning")}else answer.status="success",answer.message=configlang.SPECIALSUCCESS,u.more&&(answer.message+="<br />"+u.more),l.close()},"json")});
else{var t={exemplar:d,userinput:{special1:h,special2:n,special3:r,special4:q,special5:p},specialsubject:f,userconfig:usrconfig,epn:c};$.post("/ajax/libraryspecial",{action:g,ppnlist:JSON.stringify(b),fields:JSON.stringify(t)},function(m){if(0>m.status){if(-3==m.status)return $.user_message(m.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+m.error,"warning")}else answer.status="success",answer.message=configlang.SPECIALSUCCESS,m.more&&(answer.message+="<br />"+m.more),l.close()},
"json")}}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(l){dialogs.push(k)}});k.realize();k.getModalHeader().addClass("preview-header");k.setData("name","special");k.open()};
$.cancel=function(a,b,c){$.close_resolvers();$.post("/ajax/cancel",{iln:a,uri:b},function(d){if(0>d.status){if(-3==d.status)return $.user_message(d.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+d.error,"warning")}else $("#reservation_"+c).hide(),$.user_message(configlang.CANCELSUCCESS,"success")},"json")};
$.renew=function(){$.close_resolvers();$(".status_renew").html("");$(".check_renew").each(function(a){if(1==$(this).prop("checked")){$(this).prop("checked",!1);a=$(this).data("item");var b=a.substring(Math.max(a.lastIndexOf(":"),a.lastIndexOf("$"))+1),c=$(this).data("iln");$.post("/ajax/renew",{iln:c,uri:a},function(d){if(-3==d.status)return $.user_message(d.error,"warning"),!1;-2==d.status?($("#status_renew_"+b).html('<font color="red"><a href="#" data-toggle="tooltip" title="'+d.error+'"><i class="fa fa-exclamation" aria-hidden="true"></i></font>'),
$("#checkbox_renew_"+b).html("")):($("#status_renew_"+b).html('<font color="green"><i class="fa fa-check" aria-hidden="true"></i></font>'),"endtime"in d&&$("#return_renew_"+b).html(d.endtime),"renewals"in d&&(0<maxrenewals?($("#renewals_renew_"+b).html(d.renewals+" / "+maxrenewals),parseInt(d.renewals)>=maxrenewals&&$("#checkbox_renew_"+b).html("")):$("#renewals_renew_"+b).html(d.renewals)),"reminder"in d&&$("#reminder_renew_"+b).html(d.reminder))},"json")}});$(".btn-renew").blur()};
$(function(){$.load_config();$.update_favs();$(".lang li a").click(function(){"ger"==$(this).data("value")?($(".lang_ger").removeClass("hide"),$(".lang_eng").addClass("hide")):($(".lang_ger").addClass("hide"),$(".lang_eng").removeClass("hide"));$.set_language($(this).data("value"),!0)});$(".layout li a").click(function(){$.set_layout($(this).data("value"),!0)});$(window).scroll(function(){Scroll&&$(window).scrollTop()+500>=$(document).height()-$(window).height()&&$.search_next_pack(function(){})});
window.scrollTo(0,0);var a=$(".typeahead");a.typeahead({source:function(b,c){if(void 0==b||""==b.trim())return c({});$.get("/ajax/getwords",{query:JSON.stringify(b)},function(d){return c(d)},"json")},autoSelect:!1,delay:300,afterSelect:function(b){$.new_search("init",b)}});a.keydown(function(b){if(13==b.keyCode||9==b.keyCode){b=$(".navbar:visible").find(".search_text").val().trim();var c=$("ul.typeahead.dropdown-menu:visible").find("li.active").text();void 0!=c&&(c=c.trim());c?c==b?$.new_search("init",
b):$.new_search("init",c):$.new_search("init",b);event.preventDefault()}});window.onpopstate=function(b){$.close_dialogs();$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");null!=b.state&&0<Object.keys(b.state).length&&""!=b.state.search?(appstate.first=!0,searchvals.inittext=b.state.search,$.init_client(b.state.sets),$.load_config()):($("#start").fadeIn("fast").removeClass("collapse"),
$("#searchtext_xs").val(""),$("#searchtext_md").val(""))};$(".search_text").keyup(function(){$(".search_clear").toggle(!!$(this).val())});$(".search_clear").click(function(){$(".search_text").val("").focus();$(this).hide()});$.focus_first()});
