var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(c=c||0;c<e;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
var Scroll=!1,Height=$(document).height(),title="",user,pw,status,username,mailfrom,mailto,msg,config,usrconfig="",configlang,xtitle=document.title,slider1,slider2,slider3,dialogs=[],waitdialog,messid=0,appstate={first:!0},querystate=!1,results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{},spell:{},status:0},searchvals={text:"",last:"",package:1,inittext:"",initfacets:{}},facetvals={datapool:"",iln:"",phonetic:!1,yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",yearminbase:"",
yearmaxbase:"",typ:"total",formats:{},sort:"scoredesc"},statevals={ppnlist:[],language:"",layout:""},favors={},favormails={},favorprint={},idleTimer,time2warn=1080,time2kill=120,timer=!1,maxrenewals=0,urlport=location.protocol+"//",linkresolver=!1,delay=function(){var a=0;return function(b,c){clearTimeout(a);a=setTimeout(b,c)}}(),marcCheck=!0,formate={Article:1,Book:2,Journal:4,Microform:8,Sound_Recording:16,Serial_Volume:32,Musical_Score:64,Mixed_Materials:128,Data_Media:256,Motion_Picture:512,electronic_Resource:1024,
Map:2048,unknown:4096,Game:8192,Manuscript:16384},formats={Article:!1,Book:!1,Journal:!1,Microform:!1,"Sound Recording":!1,"Serial Volume":!1,"Musical Score":!1,"Mixed Materials":!1,"Data Media":!1,"Motion Picture":!1,"electronic Resource":!1,Map:!1,unknown:!1,Game:!1,Manuscript:!1},formatslanguagesort=[],view={},filters=[],settings={title:"",author:"",subject:"",class:"",publisher:"",toc:"",id:"",series:"",isn:""},settingsname,isMobile=window.matchMedia("only screen and (max-width: 760px)").matches,
intervalID="",$JSONData,answer={status:"",message:""};$.is_Empty=function(a){if(null==a)return!0;if(0<a.length)return!1;if(0===a.length||"object"!==typeof a)return!0;for(var b in a)if(hasOwnProperty.call(a,b))return!1;return!0};$.focus_first=function(){isMobile||$('[type="search"]:input:enabled:visible:first').focus()};$.remove_tooltips=function(){$(".countSettings").tooltip("hide")};$.close_wait=function(){waitdialog.close()};$.validateEmail=function(a){return/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/.test(a)};
$.cleanArray=function(a){for(var b=0;b<a.length;b++)void 0==a[b].trim()||""==a[b].trim()?(a.splice(b,1),b--):a[b]=a[b].trim();return a};$.SetQuery=function(){querystate?0<results.hits?($("#querybar_querybar").hide(),$("#results_querybar").show()):($("#querybar_querybar").show(),$("#results_querybar").hide()):($("#querybar_querybar").hide(),$("#results_querybar").hide())};
$.command=function(a){"library"==a.toLowerCase()?window.location.href=urlport+window.location.host+"/librarymodule":"query"==a.toLowerCase()?(querystate=!querystate,$.SetQuery()):$.post("/ajax/command",{cmd:a},function(b){$.user_message("Befehl "+a+" erfolgreich ausgef&uuml;hrt","success");$.focus_first()},"json")};
$.user_message=function(a,b,c){void 0==c&&(c=5E3);if(0<dialogs.length){var d=dialogs[dialogs.length-1].getData("name");"mail"==d&&(d="fullview_"+(dialogs.length-2).toString())}else d=0<results.hits?"results":"statusbar";var e="success"==b?"panel-success":"panel-danger";messid++;$("#"+d+"_messagebar").append($("<div id='message"+messid+"' class='alert-message "+b+"' data-alert></div>"));$("#message"+messid).hide().html("<div class='panel "+e+"'><div class='panel-heading'>"+a+"</div></div>").fadeIn("fast");
$("#message"+messid).delay(c).fadeOut("slow",function(){$(this).remove()})};$.set_layout=function(a,b){config.layout=a;$.post("/ajax/layout",{layout:a},function(a){$("#resultsonly").fadeOut("fast",function(){$("#resultsonly").html(a.results);window.scrollTo(0,0);$.focus_first();$("#resultsonly").fadeIn("fast").removeClass("collapse")})},"json");b&&($.user_message(configlang.VIEWCHANGED.replace("{col}",12/a),"success"),$.push_state())};
$.show_answer=function(){""!=answer.message&&$.user_message(answer.message,answer.status);answer.message="";answer.status=""};
$.set_language=function(a,b){config.language=a;$.post("/ajax/language",{language:a},function(b){configlang=b;$(".search_text").attr("placeholder",configlang.YOURSEARCH);$(".ger").html(configlang.GER);$(".eng").html(configlang.ENG);$(".col1").html(configlang.COL1);$(".col2").html(configlang.COL2);$(".col3").html(configlang.COL3);$(".col4").html(configlang.COL4);$(".RESULTFILTER").html(configlang.RESULTFILTER);$(".lbl_facetyear").html(configlang.FACETYEAR);$(".lbl_facettyp").html(configlang.FACETTYP);
$(".lbl_facetformat").html(configlang.FACETFORMAT);$(".lbl_typtotal").html(configlang.TYPTOTAL);$(".lbl_typprint").html(configlang.TYPPRINT);$(".lbl_typelectr").html(configlang.TYPELECTR);$(".lbl_year").html(configlang.YEAR);$(".lbl_score").html(configlang.SCORE);$(".lbl_sorting").html(configlang.SORTING);$(".imprint").html(configlang.IMPRINT);$.each($(".facetformat"),function(){$(".lbl_"+this.id.replace(/ /g,"").toUpperCase()).html(configlang[this.id.replace(/ /g,"").toUpperCase()])});$(".myarea").attr("title",
configlang.MYAREA);$(".myarea2").html('<i class="fa fa-user"></i> '+configlang.MYAREA);$(".usercollectables").html(configlang.USERCOLLECTABLES);$(".userrentals").html(configlang.USERRENTALS);$(".userorders").html(configlang.USERORDERS);$(".userreservations").html(configlang.USERRESERVATIONS);$(".userfees").html(configlang.USERFEES);$(".usersearches").html(configlang.USERSEARCHES);$(".userstore").html('<i class="glyphicon glyphicon-save"></i> '+configlang.USERSTORE);$(".favorites").attr("title",configlang.CHECKLIST);
$(".selectview").attr("title",configlang.SELECTVIEW);$(".selectlanguage").attr("title",configlang.SELECTLANGUAGE);$(".selectdatapool").attr("title",configlang.SELECTDATAPOOL);$(".startsearch").attr("title",configlang.STARTSEARCH);$(".settings").attr("title",configlang.SETTINGS);$(".filterresults").attr("title",configlang.RESULTFILTER);$(".selectdiscoverydatapool").length&&($(".selectdiscoverydatapool").find('[value=""]').html(configlang.DATAPOOLGLOBAL),$(".selectdiscoverydatapool").find('[value=""]').attr("data-tokens",
configlang.ALL),$(".selectdiscoverydatapool").selectpicker("refresh"),$("[data-optgroup='1']").first().find(".text").html(configlang.ALL));$(".facetpool li a span").each(function(){var a=$(this).parent().data("value").toLowerCase();$(this).html(configlang["DATAPOOL"+a.toUpperCase()])});$(".lang_datapool").html(" "+configlang["DATAPOOL"+facetvals.datapool.toUpperCase()]);formatslanguagesort=[];$.each(formats,function(a,b){formatslanguagesort.push({id:a,val:configlang[a.replace(/ /g,"").toUpperCase()]})});
formatslanguagesort.sort(function(a,b){a=a.val.toLowerCase();b=b.val.toLowerCase();return a<b?-1:a>b?1:0});"ger"==a&&($(".showeng").addClass("hide"),$(".showger").removeClass("hide"));"eng"==a&&($(".showeng").removeClass("hide"),$(".showger").addClass("hide"));$.focus_first()},"json");b&&($.user_message(configlang.LANGUAGECHANGED,"success"),$.push_state())};$.mark_check=function(a){$(".check_"+a).each(function(a){$(this).prop("checked",marcCheck)});marcCheck=!marcCheck;$(".btn-check-all").blur()};
$.openLink=function(a){$.post("/ajax/statsclient",{typ:"Link",name:a,range:"year"});window.open(a,"_blank")};$.toggle_area=function(a){$("."+a+"up").toggleClass("collapse");$("."+a+"down").toggleClass("collapse");view.hasOwnProperty(a)||(view[a]=!1);view[a]?$(".discover"+a).slideUp("fast").addClass("collapse"):$(".discover"+a).slideDown("fast").removeClass("collapse");view[a]=!view[a]};$.close_dialogs=function(){for(var a=dialogs.length-1;0<=a;a--)dialogs[a].close()};
$.correctCover=function(a,b){a.onerror="";$(a).replaceWith("<span class='gbvicon'>"+b+"</span>")};
$.init_client=function(a){if(!$.is_Empty(a)){var b={};a.replace(/([^=&]+)=([^&]*)/g,function(a,d,e){b[decodeURIComponent(d)]=decodeURIComponent(e)});void 0!=b.g&&(statevals.language="g"==b.g.substring(0,1)?"ger":"eng",statevals.layout=12/b.g.substring(1,2));void 0!=b.ft&&("2"==b.ft&&(searchvals.initfacets.typ="total"),"1"==b.ft&&(searchvals.initfacets.typ="true"),"0"==b.ft&&(searchvals.initfacets.typ="false"));void 0!=b.fs&&("0"==b.fs&&(searchvals.initfacets.sort="scoredesc"),"1"==b.fs&&(searchvals.initfacets.sort=
"yeardesc"),"2"==b.fs&&(searchvals.initfacets.sort="yearasc"),$.format_sort(searchvals.initfacets.sort));searchvals.initfacets.yearminbase=void 0!=b.fb?parseInt(b.fb.substring(0,4)):"";searchvals.initfacets.yearmaxbase=void 0!=b.fb?parseInt(b.fb.substring(4,8)):"";searchvals.initfacets.yearmin=void 0!=b.fy?parseInt(b.fy.substring(0,4)):"";searchvals.initfacets.yearminstart=void 0!=b.fy?parseInt(b.fy.substring(4,8)):"";searchvals.initfacets.yearmaxstart=void 0!=b.fy?parseInt(b.fy.substring(8,12)):
"";searchvals.initfacets.yearmax=void 0!=b.fy?parseInt(b.fy.substring(12,16)):"";searchvals.initfacets.yearrange=void 0!=b.fy?"["+parseInt(b.fy.substring(4,8))+" TO "+parseInt(b.fy.substring(8,12))+"]":"";searchvals.initfacets.formats={};void 0!=b.fd&&(searchvals.initfacets.datapool=b.fd);void 0!=b.ff&&0<parseInt(b.ff)&&(searchvals.initfacets.formats={},$.each(formate,function(a){formate[a]&b.ff&&(searchvals.initfacets.formats[a.replace("_"," ")]=!0)}))}};
$.load_config=function(){$.post("/ajax/config",{screen:JSON.stringify({Width:screen.width,Height:screen.height}),platform:JSON.stringify(platform)},function(a){config=a;""!=statevals.language&&(config.language=statevals.language);$.set_language(config.language,!1);""!=statevals.layout&&$.set_layout(statevals.layout,!1);time2warn=60*config.time2warn;time2kill=60*config.time2kill;maxrenewals=parseInt(config.maxrenewals);0==!usrconfig&&(timer=!0,$.startTimer());a=0;$.is_Empty(searchvals.initfacets)?
appstate.first=!1:(appstate.first=!0,void 0!=searchvals.initfacets.datapool&&"global"==searchvals.initfacets.datapool&&a++,void 0!=searchvals.initfacets.phonetic&&1==searchvals.initfacets.phonetic&&a++,1E3==searchvals.initfacets.yearminbase&&searchvals.initfacets.yearmaxbase==(new Date).getFullYear()||a++,facetvals=searchvals.initfacets,searchvals.initfacets={});void 0==facetvals.datapool&&(facetvals.datapool=config.datapool);$(".facetpool").parents(".dropdown").find(".btn").val(facetvals.datapool);
"local"==facetvals.datapool.toLowerCase()?($(".datapoollocal").removeClass("hide"),$(".datapoolglobal").addClass("hide")):($(".datapoollocal").addClass("hide"),$(".datapoolglobal").removeClass("hide"));if(""!=searchvals.inittext){for(var b=null,c=searchvals.inittext,d=[];null!=c.match(/([A-Za-z0-9]+)\(([^)]+)\)/);)b=c.match(/([A-Za-z0-9]+)\(([^)]+)\)/),-1<"title author subject class toc publisher isn series id".split(" ").indexOf(b[1].toLowerCase())&&(d=b[2].split(","),$.each(d,function(a,b){d[a]=
b.replace(/"/g,"").trim()}),"title"==b[1].toLowerCase()&&(settings.title=d.join("\r\n")),"author"==b[1].toLowerCase()&&(settings.author=d.join("\r\n")),"subject"==b[1].toLowerCase()&&(settings.subject=d.join("\r\n")),"class"==b[1].toLowerCase()&&(settings.class=d.join("\r\n")),"toc"==b[1].toLowerCase()&&(settings.toc=d.join("\r\n")),"publisher"==b[1].toLowerCase()&&(settings.publisher=d.join("\r\n")),"isn"==b[1].toLowerCase()&&(settings.isn=d.join("\r\n")),"series"==b[1].toLowerCase()&&(settings.series=
d.join("\r\n")),"id"==b[1].toLowerCase()&&(settings.id=d.join("\r\n")),a++,-1==filters.indexOf(b[1].toLowerCase())&&filters.push(b[1].toLowerCase()),searchvals.inittext=searchvals.inittext.replace(b[0],"")),c=c.replace(b[0],"");0==a&&(a="");$(".countSettings").html(a.toString());""!=a&&($(".countSettings").tooltip("show"),setTimeout($.remove_tooltips,2E3),intervalID=setInterval(function(){$(".countSettings").animate({opacity:"0.5"}).delay(1E3).animate({opacity:"1"})},3E3));$.when($.new_search("initfacets",
searchvals.inittext)).done(function(){searchvals.inittext=""})}$(".search_clear").toggle(!!$(".search_text").val())},"JSON")};
$.push_state=function(a){void 0===a&&(a="");var b=urlport+window.location.host;if(""!=a){b+="/id%7Bcolon%7D"+a;var c={},d="id:"+a}else{""==searchvals.text.trim()&&(searchvals.text="*");a=searchvals.text.replace(/"/g,"%22").replace(/\//g,"{slash}").replace(/</g,"{st}").replace(/>/g,"{gt}").replace(/:/g,"{colon}").replace(/\*/g,"{star}");b+="/"+encodeURIComponent(a);c="g="+config.language.substring(0,1)+12/config.layout;"true"==facetvals.typ&&(c+="&ft=1");"false"==facetvals.typ&&(c+="&ft=0");if("total"==
facetvals.typ||""==facetvals.typ)c+="&ft=2";""!=facetvals.yearmin.toString()&&""!=facetvals.yearminstart.toString()&&""!=facetvals.yearmaxstart.toString()&&""!=facetvals.yearmax.toString()&&void 0!=facetvals.yearmin&&void 0!=facetvals.yearminstart&&void 0!=facetvals.yearmaxstart&&void 0!=facetvals.yearmax&&(c+="&fy="+facetvals.yearmin.toString()+facetvals.yearminstart.toString()+facetvals.yearmaxstart.toString()+facetvals.yearmax.toString());""!=facetvals.yearminbase.toString()&&""!=facetvals.yearmaxbase.toString()&&
void 0!=facetvals.yearminbase&&void 0!=facetvals.yearmaxbase&&(c+="&fb="+facetvals.yearminbase.toString()+facetvals.yearmaxbase.toString());c+="&fd="+facetvals.datapool;if("scoredesc"==facetvals.sort||void 0==facetvals.sort)c+="&fs=0";"yeardesc"==facetvals.sort&&(c+="&fs=1");"yearasc"==facetvals.sort&&(c+="&fs=2");var e=0;$.each(facetvals.formats,function(a){e|=formate[a.replace(" ","_")]});c+="&ff="+e;b+="/"+c;d=searchvals.text;""!=facetvals.yearminstart.toString()&&facetvals.yearmaxstart.toString()&&
(d+=" ["+facetvals.yearminstart.toString()+"-"+facetvals.yearmaxstart.toString()+"]");"true"==facetvals.typ&&(d+=" | "+configlang.TYPELECTR);"false"==facetvals.typ&&(d+=" | "+configlang.TYPPRINT);$.each(facetvals.formats,function(a){d+=" | "+configlang[a.toUpperCase()]})}appstate.first?(window.history.replaceState({search:searchvals.text,text:d,sets:c},d.substring(0,50)+" | "+xtitle,b),appstate.first=!1):window.history.pushState({search:searchvals.text,text:d,sets:c},d.substring(0,50)+" | "+xtitle,
b);document.title=d+" | "+xtitle};$.startCountdown=function(a,b){var c=a;setInterval(function(){b.html(c);0>--c&&(c=a)},1E3)};$.startTimer=function(){$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",$.resetTimer);$.resetTimer()};$.resetTimer=function(){clearTimeout(idleTimer);idleTimer=setTimeout($.whenUserAlmostIdle,1E3*time2warn)};
$.whenUserAlmostIdle=function(){clearTimeout(idleTimer);idleTimer=setTimeout($.whenUserIdle,1E3*time2kill);var a=new BootstrapDialog({message:unescape('Sie werden in <span class="customer-link" id="countdown">'+(time2kill-1)+"</span> Sekunden automatisch abgemeldet"),title:"Automatische Abmeldung",closable:!1,type:BootstrapDialog.TYPE_DANGER,onhidden:function(){dialogs.pop()},onshown:function(){dialogs.push(a);$.startCountdown(time2kill-2,$("#countdown"));$(document.body).unbind();$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",
$.whenUserStopsAlmostIdle)}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","almostidledialog");a.open()};$.whenUserStopsAlmostIdle=function(){dialogs[dialogs.length-1].close();$(document.body).unbind();$(document.body).bind("mousemove click mouseup mousedown keydown keypress keyup submit change mouseenter scroll resize dblclick",$.resetTimer);$.resetTimer()};
$.whenUserIdle=function(){$.user_message(configlang.IDLEHAPPENED,"warning");$.post("/ajax/logout",function(a){$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide")},"json");$.reset_session()};
$.reset_session=function(){$.close_dialogs();$.post("/ajax/sessclear",function(a){$("#searchtext_xs").val("");$("#searchtext_md").val("");$(".nologinarea").removeClass("hide");$(".loginarea").addClass("hide");$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$("#start").fadeIn("fast").removeClass("collapse");$(".fav").remove();$(".favdivider1").addClass("hide");$(".compare").addClass("hide");
$(".nofavs").removeClass("hide");$(".favdivider2").addClass("hide");$(".favstore").addClass("hide");$(".favdivider3").addClass("hide");$(".favclear").addClass("hide");window.history.replaceState("","",urlport+window.location.host);view="3";results.hits=0;Scroll=!1;usrconfig="";config.layout=3;messid=0;results={hits:0,hitspack:0,hitscurr:0,qtime:"",ppnlist:{}};searchvals={text:"",last:"",package:1,inittext:"",initfacets:{}};facetvals={datapool:"",iln:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",
yearmaxstart:"",typ:"total",formats:{}};favors={};$.load_config();timer=!1;$(document.body).unbind();window.location.href=urlport+window.location.host})};
$.new_search=function(a,b){if("facet_"!=a.substr(0,6).toLowerCase()){searchvals.last=searchvals.text;void 0==b||""==b?searchvals.text="*":(searchvals.text=b.trim().replace(/,/g,", ").replace(/  /g," "),b=b.trim().replace(/,/g,", ").replace(/  /g," "));if("cmd:"==searchvals.text.substr(0,4).toLowerCase()){$.command(searchvals.text.substr(4));$("#searchtext_xs").val(searchvals.last);$("#searchtext_md").val(searchvals.last);searchvals.text=searchvals.last;$.focus_first();return}$("#searchtext_xs").val(b);
$("#searchtext_md").val(b);var c="";b="";c=$.cleanArray(settings.title.split("\n"));0<c.length&&(b+=' title("'+c.join('","')+'")');c=$.cleanArray(settings.author.split("\n"));0<c.length&&(b+=' author("'+c.join('","')+'")');c=$.cleanArray(settings.subject.split("\n"));0<c.length&&(b+=' subject("'+c.join('","')+'")');c=$.cleanArray(settings.class.split("\n"));0<c.length&&(b+=' class("'+c.join('","')+'")');c=$.cleanArray(settings.toc.split("\n"));0<c.length&&(b+=' contents("'+c.join('","')+'")');c=$.cleanArray(settings.publisher.split("\n"));
0<c.length&&(b+=' publisher("'+c.join('","')+'")');c=$.cleanArray(settings.isn.split("\n"));0<c.length&&(b+=' isn("'+c.join('","')+'")');c=$.cleanArray(settings.series.split("\n"));0<c.length&&(b+=' series("'+c.join('","')+'")');c=$.cleanArray(settings.id.split("\n"));0<c.length&&(b+=' id("'+c.join('","')+'")');searchvals.text+=b}Scroll=!1;searchvals.package=1;searchvals.search=searchvals.text;$.open_wait();return $.when($.search_results(a)).then(function(){0==results.hits&&$.spell_suggestion();$.close_wait();
$.push_state();$.focus_first()})};
$.search_results=function(a){return $.ajax({url:"/ajax/search/",method:"POST",data:{search:searchvals.search,package:searchvals.package,facets:JSON.stringify(facetvals)},dataType:"JSON",success:function(b){$JSONData=b;$JSONData.hasOwnProperty("status")&&0==$JSONData.status?(results.status=$JSONData.status,results.hits=$JSONData.hits,results.hitspack=$JSONData.hitspack,results.qtime=$JSONData.qtime,results.spell=$JSONData.spell,b=$.trim($JSONData.query),b+=" <a href='"+b+"' target='_blank'><span class='fa fa-external-link'></span></a>",
0<results.hits?($("#querybar_query").html(""),$("#results_query").html(b)):($("#querybar_query").html(b),$("#results_query").html("")),$.SetQuery(),$(".TOTALRECS").html($.format_hits(results.hits)),2<=searchvals.package?(results.ppnlist=results.ppnlist.concat(jQuery.map($JSONData.ppnlist,function(a,b){return a.toString()})),results.hitscurr=results.ppnlist.length,$("#resultsonly").append($JSONData.results).fadeIn("fast"),50<=results.hitspack?$("#loading").fadeIn("fast").removeClass("collapse"):$("#loading").fadeOut("fast").addClass("collapse")):
(window.scrollTo(0,0),results.ppnlist=jQuery.map($JSONData.ppnlist,function(a,b){return a.toString()}),results.hitscurr=results.ppnlist.length,0==results.hitspack?"facet_"!=a.substr(0,6).toLowerCase()?($("#results").fadeOut("fast").addClass("collapse"),$("#loading").fadeOut("fast").addClass("collapse"),$("#start").fadeIn("fast").removeClass("collapse"),$("#btn_facets").addClass("hidden-xs"),$("#statusbar").removeClass("collapse"),$("#version_start").fadeIn("fast").removeClass("collapse"),$("#version_search").fadeOut("fast").addClass("collapse")):
$("#resultsonly").fadeOut("fast",function(){$("#statusbar").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");$.number_facets(a);$("#resultsonly").fadeIn("fast").removeClass("collapse")}):($(".alert-message").remove(),$("#statusbar").addClass("collapse"),$("#start").fadeOut("fast").addClass("collapse"),$("#version_start").fadeOut("fast").addClass("collapse"),$("#version_search").fadeIn("fast").removeClass("collapse"),"facet_"!=a.substr(0,6).toLowerCase()?
$("#results").fadeOut("fast",function(){$("#resultsonly").html($JSONData.results);$.create_facets($JSONData);$("#facets").fadeIn("fast").removeClass("collapse");$("#results").fadeIn("fast").removeClass("collapse")}):$("#resultsonly").fadeOut("fast",function(){$("#resultsonly").html($JSONData.results);$.number_facets(a);$("#resultsonly").fadeIn("fast").removeClass("collapse")}),50<=results.hitspack?$("#loading").fadeIn("fast").removeClass("collapse"):$("#loading").fadeOut("fast").addClass("collapse"),
$("#btn_facets").removeClass("hidden-xs"))),Scroll=!1,50==results.hitspack&&(Scroll=!0)):results.status=$JSONData.status}})};$.search_next_pack=function(a){Scroll=!1;$("#loading").removeClass("hideLoading").addClass("displayLoading");searchvals.package++;$.when($.search_results("adddata")).then(function(){$("#loading").removeClass("displayLoading").addClass("hideLoading");a()})};
$.facet_search=function(a,b){$.close_dialogs();searchvals.initfacets=b;0<Object.keys(searchvals.initfacets).length?(facetvals=searchvals.initfacets,searchvals.initfacets={}):facetvals.datapool=config.datapool;$(".facetpool").parents(".dropdown").find(".btn").val(facetvals.datapool);$(".datapool").html(configlang["DATAPOOL"+facetvals.datapool.toUpperCase()]);$.new_search("initfacets",decodeURIComponent(escape(atob(a))))};
$.link_search=function(a,b){""!=b&&(b="foreignid"!=a?"id"!=a&&"year"!=a?a+"('"+b+"')":a+"("+b.replace(/[^a-z0-9]/gi,"")+")":a+"("+$.trim(b).trim("'")+")",$.close_dialogs(),$.new_search("link",b))};$.navbar_search=function(a){a=$(a).val();$.new_search("init",a)};
$.spell_suggestion=function(){var a=searchvals.text;if(2<=results.spell.length)for(count=0;count<results.spell.length/2;){if(-1!=searchvals.text.toLowerCase().indexOf(results.spell[2*count])){var b=new RegExp(results.spell[2*count],"ig"),c=results.spell[2*count+1].suggestion[0].word.replace(/\b[a-z]/g,function(a){return a.toUpperCase()});a=a.replace(b,c)}count++}"0"!=results.status?$.user_message(configlang.INDEXERROR.replace("{status}",results.status),"warning",5E3):$.user_message(configlang.NOHITS,
"warning",5E3);a!=searchvals.text&&$.user_message(configlang.DIDYOUMEAN.replace("{}","<a style='color:red' href='"+urlport+window.location.host+"/"+a+"'><b>"+a+"</b></a> <span class='fa fa-link'></span>"),"success",15E3)};$.opened_fullview=function(a,b){$.push_state(a);$.googleresolver(b,function(){$.linkresolver(a,b,function(){$.simularpublications(a,b,function(){$.exportlink(a,function(){})})})})};
$.linkresolver=function(a,b,c){linkresolver?(0<$("#linkresolvercontainer_"+b).length?$("#linkresolvercontainer_"+b).html("<div class='container-fluid'><div class='row'><div class='col-xs-12 col-sm-6 col-md-4'><div class='outercircle'></div><div class='innercircle'></div></div></div></div>"):$("#linkresolver_"+b).html("<div class='col-xs-12 col-sm-6 col-md-4'><div class='outercircle'></div><div class='innercircle'></div></div>"),$.ajax({url:"/ajax/linkresolver/",method:"POST",data:{ppn:a},dataType:"JSON",
success:function(a){var d="";$.each(a,function(a,b){d+="<button onclick='$.openLink(\""+b+"\")' class='col-xs-12 col-sm-6 col-md-4 btn btn-default btn-exemplar'>"+configlang.FULLTEXT+" ("+configlang[a.toUpperCase()]+")</button>"});""!=d?0<$("#linkresolvercontainer_"+b).length?$("#linkresolvercontainer_"+b).html("<div>"+configlang.ACCESS+"</div><div class='container-fluid'><div class='row'>"+d+"</div></div>"):$("#linkresolver_"+b).html(d):($("#linkresolvercontainer_"+b).html(""),$("#linkresolver_"+
b).html(""));c()}})):($("#linkresolvercontainer_"+b).html(""),$("#linkresolver_"+b).html(""),c())};
$.googleresolver=function(a,b){if(config.googlecover||config.googlepreview){var c=$("#isbn_"+a).data("isbn");""!=c&&void 0!=c?$.ajax({url:"https://books.google.com/books?bibkeys=ISBN%3A"+c+"&jscmd=viewapi&callback=listEntries",method:"POST",crossDomain:!0,dataType:"jsonp",success:function(c){$.each(c,function(b,c){c.hasOwnProperty("embeddable")&&c.hasOwnProperty("thumbnail_url")&&c.hasOwnProperty("info_url")&&$("#isbn_"+a).html("<a target='_blank' href='"+c.info_url+"'><img src='"+c.thumbnail_url+
"' title='"+configlang.GOOGLEBOOKS+"' data-tooltip='tooltip' data-placement='buttom'></a>");c.hasOwnProperty("preview")&&"partial"==c.preview&&c.hasOwnProperty("preview_url")&&$("#isbn_"+a).append("<p></p><a target='_blank' href='"+c.preview_url+"'><img src='systemassets/lukida/img/google_preview_"+config.language+".gif'></a>")});$("#isbn_"+a).val(c);b()}}):b()}else b()};
$.simularpublications=function(a,b,c){config.simularpubs?$.ajax({url:"/ajax/searchsimularpubs/",method:"POST",data:{ppn:a},dataType:"JSON",success:function(a){0<a.hitspack?$("#simularpubscontent_"+b).html(a.results):$("#simularpubscontent_"+b).html("<div class='col-xs-12'><div class='well'>"+configlang.NOSIMULARHITS+"</div></div>");c()}}):c()};
$.exportlink=function(a,b){$.ajax({url:"/ajax/exportlink/",method:"POST",data:{ppnlist:JSON.stringify(a),format:"zotero"},dataType:"JSON",success:function(a){$.each(a,function(a,b){$(".Z3988").attr("title",b)});b()}})};
$.update_favs=function(){if("undefined"!==typeof Storage){var a=sessionStorage.favs?$.parseJSON(sessionStorage.favs):{};$(".fav").remove();$.each(a,function(a,c){$('<li><a id="'+a+'" class="fav" href="javascript:$.open_fullview(\''+a+"')\">"+c+"</a></li>").insertBefore(".favdivider1")});1<Object.keys(a).length?($(".favdivider1").removeClass("hide"),$(".compare").removeClass("hide")):($(".favdivider1").addClass("hide"),$(".compare").addClass("hide"));0<Object.keys(a).length?($(".nofavs").addClass("hide"),
$(".favdivider2").removeClass("hide"),$(".favstore").removeClass("hide"),$(".favdivider3").removeClass("hide"),$(".favclear").removeClass("hide")):($(".nofavs").removeClass("hide"),$(".favdivider2").addClass("hide"),$(".favstore").addClass("hide"),$(".favdivider3").addClass("hide"),$(".favclear").addClass("hide"))}};
$.update_favors=function(){$("#favors").html("");if(0<Object.keys(favors).length){var a=0;$.each(favors,function(b,c){a++;1==a%2&&$("#favors").append("<div class='row'>");$("#favors").append(c);0==a%2&&$("#favors").append("</div>")});1==a%2&&$("#favors").append("</div>")}else $("#favors").append("<div class='col-xs-12'>"+configlang.CHECKLISTEMPTY+"</div>")};
$.create_facets=function(){facetvals.yearminstart=parseInt($JSONData.yearmin);facetvals.yearmaxstart=parseInt($JSONData.yearmax);facetvals.yearminstart<facetvals.yearmaxstart&&""!=facetvals.yearminstart&&void 0!=facetvals.yearminstart&&""!=facetvals.yearmaxstart&&void 0!=facetvals.yearmaxstart?(facetvals.yearmin=""!=facetvals.yearmin?facetvals.yearmin:facetvals.yearminstart,facetvals.yearmax=""!=facetvals.yearmax?facetvals.yearmax:facetvals.yearmaxstart,$.create_main_sliders({range:{min:facetvals.yearmin,
max:facetvals.yearmax},start:[facetvals.yearminstart,facetvals.yearmaxstart],connect:!0,behaviour:"drag",step:1},function(){$(".editable").editable();$(".yearstart").on("shown",function(a,b){b.input.$input.val($(".yearstart").html())});$(".yearend").on("shown",function(a,b){b.input.$input.val($(".yearend").html())});$(".yearstart").on("save",function(a,b){facetvals.yearminstart=Math.floor(b.newValue);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange=
"["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider1.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),slider2.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});$(".yearend").on("save",function(a,b){facetvals.yearmaxstart=Math.floor(b.newValue);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+
" TO "+facetvals.yearmaxstart+"]",slider1.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),slider2.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});$(".FACETYEARTOTAL").fadeIn("fast").removeClass("collapse")})):$(".FACETYEARTOTAL").fadeOut("fast").addClass("collapse");$.create_facets_typ();$.create_facets_formats()};
$.create_main_sliders=function(a,b){"undefined"!=typeof slider1&&slider1.noUiSlider.destroy();slider1=document.getElementById("pubyear1");noUiSlider.create(slider1,a);"undefined"!=typeof slider2&&slider2.noUiSlider.destroy();slider2=document.getElementById("pubyear2");noUiSlider.create(slider2,a);slider1.noUiSlider.on("update",function(a,b){$(".yearstart").html(Math.floor(a[0]));$(".yearend").html(Math.floor(a[1]))});slider2.noUiSlider.on("update",function(a,b){$(".yearstart").html(Math.floor(a[0]));
$(".yearend").html(Math.floor(a[1]))});slider1.noUiSlider.on("change",function(a,b){facetvals.yearminstart=Math.floor(a[0]);facetvals.yearmaxstart=Math.floor(a[1]);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider2.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});slider2.noUiSlider.on("change",
function(a,b){facetvals.yearminstart=Math.floor(a[0]);facetvals.yearmaxstart=Math.floor(a[1]);facetvals.yearrange!="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]"&&(facetvals.yearrange="["+facetvals.yearminstart+" TO "+facetvals.yearmaxstart+"]",slider1.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart]),$.set_facet("year","",facetvals.yearrange),$.create_facets_typ(),$.create_facets_formats())});b()};
$.create_facets_typ=function(){$(".onlines").html("");var a=parseInt($JSONData.online["true"])+parseInt($JSONData.online["false"]);$("#onlines1").append("<div class='radio'><label><input class='facettyp' name='facetonline1' class='TYPTOTAL'  value='total' type='radio'><span class='lbl_typtotal'>"+configlang.TYPTOTAL+"</span></label><span class='num_TYPTOTAL numtyp badge counter pull-right'>"+a+"</span></div>");$("#onlines1").append("<div class='radio'><label><input class='facettyp' name='facetonline1' class='TYPPRINT'  value='false' type='radio'><span class='lbl_typprint'>"+
configlang.TYPPRINT+"</span></label><span class='num_TYPPRINT numtyp badge counter pull-right'>"+$JSONData.online["false"]+"</span></div>");$("#onlines1").append("<div class='radio'><label><input class='facettyp' name='facetonline1' class='TYPELECTR' value='true'  type='radio'><span class='lbl_typelectr'>"+configlang.TYPELECTR+"</span></label><span class='num_TYPELECTR numtyp badge counter pull-right'>"+$JSONData.online["true"]+"</span></div>");$("#onlines2").append("<div class='radio'><label><input class='facettyp' name='facetonline2' class='TYPTOTAL'  value='total' type='radio'><span class='lbl_typtotal'>"+
configlang.TYPTOTAL+"</span></label><span class='num_TYPTOTAL numtyp badge counter pull-right'>"+a+"</span></div>");$("#onlines2").append("<div class='radio'><label><input class='facettyp' name='facetonline2' class='TYPPRINT'  value='false' type='radio'><span class='lbl_typprint'>"+configlang.TYPPRINT+"</span></label><span class='num_TYPPRINT numtyp badge counter pull-right'>"+$JSONData.online["false"]+"</span></div>");$("#onlines2").append("<div class='radio'><label><input class='facettyp' name='facetonline2' class='TYPELECTR' value='true'  type='radio'><span class='lbl_typelectr'>"+
configlang.TYPELECTR+"</span></label><span class='num_TYPELECTR numtyp badge counter pull-right'>"+$JSONData.online["true"]+"</span></div>");$("#onlines1").find("input[value='"+facetvals.typ+"']").prop("checked",!0);$("#onlines2").find("input[value='"+facetvals.typ+"']").prop("checked",!0);$(".facettyp").change(function(){$.set_facet("typ",$(this).val(),this.checked);"onlines1"==$(this).closest(".onlines").attr("id")&&$("#onlines2").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);
"onlines2"==$(this).closest(".onlines").attr("id")&&$("#onlines1").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);$.create_facets_formats()})};
$.create_facets_formats=function(){var a="",b="",c="",d="",e="",f=Math.ceil(formatslanguagesort.length/2);$.each(formatslanguagesort,function(k,h){valcount=void 0!==$JSONData.formats[h.id]?$JSONData.formats[h.id]:"";b=h.val;a="<div class='checkbox'><label><input class='facetformat' id='"+h.id+"' value='"+h.id+"' type='checkbox'><span class='lbl_"+h.id.replace(/ /g,"").toUpperCase()+"'>"+b+"</span></label><span class='num_"+h.id.replace(/ /g,"").toUpperCase()+" numformat badge counter pull-right'>"+
valcount+"</span></div>";c+=a;b=12<h.val.length?h.val.substring(0,12)+".":h.val;a="<div class='checkbox'><label><input class='facetformat' id='"+h.id+"' value='"+h.id+"' type='checkbox'><span class='lbl_"+h.id.replace(/ /g,"").toUpperCase()+"'>"+b+"</span></label><span class='num_"+h.id.replace(/ /g,"").toUpperCase()+" numformat badge counter pull-right'>"+valcount+"</span></div>";k<f?d+=a:e+=a});$("#formats1").html(c);$("#formats2").html("<div class='row'><div class='col-xs-6'>"+d+"</div><div class='col-xs-6'>"+
e+"</div></div>");$.each(facetvals.formats,function(a,b){$("#formats1").find("input[value='"+a+"']").prop("checked",!0);$("#formats2").find("input[value='"+a+"']").prop("checked",!0)});$(".facetformat").change(function(){"formats1"==$(this).closest(".formats").attr("id")&&$("#formats2").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);"formats2"==$(this).closest(".formats").attr("id")&&$("#formats1").find("input[value='"+$(this).val()+"']").prop("checked",this.checked);$.set_facet("format",
$(this).val(),this.checked)})};
$.set_facet=function(a,b,c){"datapool"==a&&(facetvals={datapool:c,iln:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",yearminbase:"",yearmaxbase:"",typ:"total",formats:{}},$.new_search("init",searchvals.text));"phonetic"==a&&(facetvals.phonetic=c,$.new_search("init",searchvals.text));"iln"==a&&(facetvals={datapool:"",iln:c,yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",yearminbase:"",yearmaxbase:"",typ:"total",formats:{}},$.new_search("init",searchvals.text));
"year"==a&&($(".num_TYPTOTAL").html(""),$(".num_TYPPRINT").html(""),$(".num_TYPELECTR").html(""),$('input[name="facetonline"][value=total]').prop("checked",!0),facetvals.typ="total",facetvals.formats={},$(".numformat").html(""),$("input.facetformat:checkbox").attr("checked",!1),$.new_search("facet_year"));"typ"==a&&(facetvals[a]=b,facetvals.formats={},$(".numformat").html(""),$("input.facetformat:checkbox").attr("checked",!1),$.new_search("facet_typ"));"format"==a&&(c?(facetvals.formats[b]=c,$.new_search("facet_format_checked")):
(delete facetvals.formats[b],$.new_search("facet_format_unchecked")));$.post("/ajax/statsclient",{typ:"Facet",name:a,range:"day"})};
$.number_facets=function(a){void 0!=$JSONData&&("facet_year"==a.toLowerCase()&&($(".num_TYPTOTAL").html($JSONData.online.total),$(".num_TYPPRINT").html($JSONData.online["false"]),$(".num_TYPELECTR").html($JSONData.online["true"])),"facet_format_checked"!=a.toLowerCase()&&"facet_format_unchecked"!=a.toLowerCase()&&"facet_sort"!=a.toLowerCase()&&($(".numformat").html(""),0<Object.keys($JSONData.formats).length&&$.each($JSONData.formats,function(a,c){$(".num_"+a.replace(/ /g,"").toUpperCase()).html(c)})))};
$.format_hits=function(a){return 1E6<a?String(Math.round(a/1E4)/100).replace(".",",")+" Mio. ":1E3<a?String(Math.round(a/10)/100).replace(".",",")+" Tsd. ":a};$.set_sort=function(a){a!=facetvals.sort&&($.format_sort(a),facetvals.sort=a,$.new_search("facet_sort"))};$.format_sort=function(a){$(".sort"+facetvals.sort).removeClass("navbar-button-color").addClass("btn-default");$(".sort"+a).removeClass("btn-default").addClass("navbar-button-color")};
$.setup_settings=function(){$("#communitylibraries").prop("checked","global"==facetvals.datapool);$("#phoneticSwitch").prop("checked",1==facetvals.phonetic);void 0!=slider3&&""!=facetvals.yearminbase&&""!=facetvals.yearmaxbase&&slider3.noUiSlider.set([facetvals.yearminbase,facetvals.yearmaxbase]);$.each(settings,function(a,b){void 0!=b&&""!=b?(filters.includes(a)||filters.push(a),$("#"+a+"FilterValue").editable("setValue",b)):(filters.includes(a)&&filters.splice(filters.indexOf(a),1),$("#"+a+"FilterValue").editable("setValue",
""))});$.format_filterboxes()};
$.update_settings=function(a){var b=0;$("#communitylibraries").is(":checked")?(facetvals.datapool="global",b++):facetvals.datapool="local";$("#phoneticSwitch").is(":checked")&&b++;facetvals.phonetic=$("#phoneticSwitch").is(":checked");1E3==facetvals.yearminbase&&facetvals.yearmaxbase==(new Date).getFullYear()||b++;settings.title=$("#titleFilterValue").editable("getValue","true").titleFilterValue;settings.author=$("#authorFilterValue").editable("getValue","true").authorFilterValue;settings.subject=
$("#subjectFilterValue").editable("getValue","true").subjectFilterValue;settings.class=$("#classFilterValue").editable("getValue","true").classFilterValue;settings.toc=$("#tocFilterValue").editable("getValue","true").tocFilterValue;settings.publisher=$("#publisherFilterValue").editable("getValue","true").publisherFilterValue;settings.isn=$("#isnFilterValue").editable("getValue","true").isnFilterValue;settings.series=$("#seriesFilterValue").editable("getValue","true").seriesFilterValue;settings.id=
$("#idFilterValue").editable("getValue","true").idFilterValue;$.each(settings,function(a,d){void 0!=d&&""!=d&&b++});0==b&&(b="");$(".countSettings").html(b.toString());""!=b?($(".countSettings").tooltip("show"),setTimeout($.remove_tooltips,2E3),intervalID=setInterval(function(){$(".countSettings").animate({opacity:"0.5"}).delay(1E3).animate({opacity:"1"})},3E3)):clearInterval(intervalID);a()};
$.format_filterboxes=function(){var a=0;$("#FlexFilters li").each(function(){-1<filters.indexOf($(this).data("filter"))?(a++,$(this).removeClass("clear-left clear-right hide"),0==a%2?$(this).addClass("clear-right"):$(this).addClass("clear-left"),$(this).addClass("col-md-6"),filters.length==a&&1==a%2&&$(this).removeClass("col-md-6")):($(this).addClass("hide"),$(this).find(".editable").editable("setValue",""),settings[$(this).data("filter")]="")})};
$.open_fullview=function(a,b,c,d){void 0===b&&(b=results.ppnlist);void 0===d&&(d=a);void 0===c&&(c="main");"main"!=c&&(b=jQuery.map(b,function(a,b){return a.toString()}));var e=dialogs.length,f=a in favors?configlang.CHECKLISTREMOVE:configlang.CHECKLIST,k=a in favors?"fa fa-star-o":"fa fa-star",h="publications"==c?$("#related_"+d).html():$("#"+d+" div.panel-heading").html(),g=new BootstrapDialog({message:$('<div id="fullbody_'+e+'"><div class="outercircle"></div><div class="innercircle"></div>').load("/ajax/fullview/"+
a+"/"+e,function(){config.button_checklist&&(g.getButton("checklist").prop("disabled",!1),g.getButton("checklist_xs").prop("disabled",!1));config.button_export&&(g.getButton("export").prop("disabled",!1),g.getButton("export_xs").prop("disabled",!1));config.button_mail&&(g.getButton("mail").prop("disabled",!1),g.getButton("mail_xs").prop("disabled",!1));config.button_qrcode&&(g.getButton("qrcode").prop("disabled",!1),g.getButton("qrcode_xs").prop("disabled",!1));config.button_print&&(g.getButton("print").prop("disabled",
!1),g.getButton("print_xs").prop("disabled",!1))}),title:h,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{id:"prevbtn",icon:"glyphicon glyphicon-chevron-left",cssClass:"btn-default fullview-button-left hidden-xs hidden-sm",action:function(d){$(this).blur();0<b.indexOf(a)?(a=b[b.indexOf(a)-1],$("#fullbody_"+e).slideUp("fast","swing",function(){$("#fullbody_"+e).load("/ajax/fullview/"+a+"/"+e,function(){"publications"==c?d.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):
d.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+e).slideDown("fast");var b=d.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,e)})})):$.user_message(configlang.FIRSTOBJECT,"warning")}},
{id:"nextbtn",icon:"glyphicon glyphicon-chevron-right",cssClass:"btn-default fullview-button-left hidden-xs hidden-sm",action:function(d){$(this).blur();"main"==c&&b.indexOf(a)<results.hits-1&&b.indexOf(a)==results.hitscurr-1?$.search_next_pack(function(){b=results.ppnlist;a=b[b.indexOf(a)+1];$("#fullbody_"+e).slideUp("fast","swing",function(){$("#fullbody_"+e).load("/ajax/fullview/"+a+"/"+e,function(){"publications"==c?d.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):
d.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+e).slideDown("fast");var b=d.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,e)})})}):b.indexOf(a)<b.length-1?(a=b[b.indexOf(a)+1],
$("#fullbody_"+e).slideUp("fast","swing",function(){$("#fullbody_"+e).load("/ajax/fullview/"+a+"/"+e,function(){"publications"==c?d.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):d.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+e).slideDown("fast");var b=d.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):
(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,e)})})):$.user_message(configlang.LASTOBJECT,"warning")}},{label:" "+configlang.CANCEL,icon:"glyphicon glyphicon-menu-up",cssClass:"btn-default hidden-xs hidden-sm",action:function(a){a.close();$.focus_first()}},{id:"qrcode",label:" "+configlang.QRCODE,icon:"fa fa-qrcode",cssClass:"btn-default hidden-xs hidden-sm",action:function(a){$.open_qrcode()}},{id:"print",
label:" "+configlang.PRINT,icon:"fa fa-print",cssClass:"btn-default hidden-xs hidden-sm",action:function(a){$(this).blur();a=window.open();a.document.write("<html><head><title>"+xtitle+"</title></head><body><p><img src='"+config.printlogo+"' style='max-width:300px;' />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>"+config.softwarename+" - "+urlport+window.location.host+"</b></span></p>");a.document.write($("#tab1_"+e).wrap("<p/>").parent().html());a.document.write("</body></html");a.document.close();
a.focus();a.print();a.close()}},{id:"mail",label:" "+configlang.MAIL,icon:"glyphicon glyphicon-envelope",cssClass:"btn-default hidden-xs hidden-sm",action:function(b){$(this).blur();favormails[a]=$("#tab1_"+e).wrap("<p/>").parent().html();""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail([a])}):$.open_mail([a])}},{id:"export",label:" "+configlang.EXPORT,icon:"glyphicon glyphicon-export",cssClass:"btn-default hidden-xs hidden-sm",action:function(b){$(this).blur();$.open_export([a])}},
{id:"checklist",label:' <span class="text">'+f+"</span>",icon:k,cssClass:"btn-default checklist hidden-xs hidden-sm",action:function(b){$(this).blur();b=$(this);a in favors?(delete favors[a],delete favormails[a],delete favorprint[a],$.user_message(configlang.CHECKLISTREMOVESUCCESS,"success"),b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star")):(favors[a]=$("#"+a).clone().removeClass("medium col-xs-12 col-sm-6 col-md-4 col-lg-3","col-md-6").addClass("merk col-md-6"),
$(favors[a]).find("a").attr("href","javascript:$.open_fullview('"+a+"',Object.keys(favors));"),favormails[a]=$("#tab1_"+e).wrap("<p/>").parent().html(),favorprint[a]=$("#tab1_"+e).wrap("<p/>").parent().html(),$.user_message(configlang.CHECKLISTSUCCESS,"success"),b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o"));$.update_favors()}},{id:"prevbtn_xs",icon:"glyphicon glyphicon-chevron-left",cssClass:"btn-default fullview-button-left hidden-md hidden-lg col-xs-2 col-sm-1 NoLeftMargin",
action:function(d){$(this).blur();0<b.indexOf(a)?(a=b[b.indexOf(a)-1],$("#fullbody_"+e).slideUp("fast","swing",function(){$("#fullbody_"+e).load("/ajax/fullview/"+a+"/"+e,function(){"publications"==c?d.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):d.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+e).slideDown("fast");var b=d.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),
b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,e)})})):$.user_message(configlang.FIRSTOBJECT,"warning")}},{id:"nextbtn_xs",icon:"glyphicon glyphicon-chevron-right",cssClass:"btn-default fullview-button-left hidden-md hidden-lg col-xs-2 col-sm-1 NoLeftMargin",action:function(d){$(this).blur();"main"==c&&b.indexOf(a)<results.hits-1&&b.indexOf(a)==
results.hitscurr-1?$.search_next_pack(function(){b=results.ppnlist;a=b[b.indexOf(a)+1];$("#fullbody_"+e).slideUp("fast","swing",function(){$("#fullbody_"+e).load("/ajax/fullview/"+a+"/"+e,function(){"publications"==c?d.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):d.getModalHeader().find(".bootstrap-dialog-title").html($("#"+a+" div.panel-heading").html());$("#fullbody_"+e).slideDown("fast");var b=d.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),
b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,e)})})}):b.indexOf(a)<b.length-1?(a=b[b.indexOf(a)+1],$("#fullbody_"+e).slideUp("fast","swing",function(){$("#fullbody_"+e).load("/ajax/fullview/"+a+"/"+e,function(){"publications"==c?d.getModalHeader().find(".bootstrap-dialog-title").html($("#related_"+a).html()):d.getModalHeader().find(".bootstrap-dialog-title").html($("#"+
a+" div.panel-heading").html());$("#fullbody_"+e).slideDown("fast");var b=d.getModalFooter().find(".checklist");a in favors?(b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o")):(b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star"));$.opened_fullview(a,e)})})):$.user_message(configlang.LASTOBJECT,"warning")}},{id:"checklist_xs",label:' <span class="text">'+f+"</span>",
icon:k,cssClass:"btn-default checklist hidden-md hidden-lg col-xs-4 col-sm-4 LeftOffset2",action:function(b){$(this).blur();b=$(this);a in favors?(delete favors[a],delete favormails[a],delete favorprint[a],$.user_message(configlang.CHECKLISTREMOVESUCCESS,"success"),b.find(".text").text(configlang.CHECKLIST),b.find(".fa").removeClass("fa-star-o"),b.find(".fa").addClass("fa-star")):(favors[a]=$("#"+a).clone().removeClass("medium col-xs-12 col-sm-6 col-md-4 col-lg-3","col-md-6").addClass("merk col-md-6"),
$(favors[a]).find("a").attr("href","javascript:$.open_fullview('"+a+"',Object.keys(favors));"),favormails[a]=$("#tab1_"+e).wrap("<p/>").parent().html(),favorprint[a]=$("#tab1_"+e).wrap("<p/>").parent().html(),$.user_message(configlang.CHECKLISTSUCCESS,"success"),b.find(".text").text(configlang.CHECKLISTREMOVE),b.find(".fa").removeClass("fa-star"),b.find(".fa").addClass("fa-star-o"));$.update_favors()}},{label:" "+configlang.CANCEL,icon:"glyphicon glyphicon-menu-up",cssClass:"btn-default hidden-md hidden-lg col-xs-4 col-sm-2 LeftOffset2",
action:function(a){a.close();$.focus_first()}},{id:"qrcode_xs",label:" QR",icon:"fa fa-qrcode",cssClass:"btn-default hidden-md hidden-lg col-xs-2 col-sm-2 NoLeftMargin",action:function(a){$.open_qrcode()}},{id:"export_xs",label:" "+configlang.EXPORT,icon:"glyphicon glyphicon-export",cssClass:"btn-default hidden-md hidden-lg col-xs-4 col-sm-2 LeftOffset2",action:function(b){$(this).blur();$.open_export([a])}},{id:"print_xs",label:" "+configlang.PRINT,icon:"fa fa-print",cssClass:"btn-default hidden-md hidden-lg col-xs-3 col-sm-2 NoLeftMargin",
action:function(a){$(this).blur();a=window.open();a.document.write("<html><head><title>"+xtitle+"</title></head><body><p><img src='"+config.printlogo+"' style='max-width:300px;' />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>"+config.softwarename+" - "+urlport+window.location.host+"</b></span></p>");a.document.write($("#tab1_"+e).wrap("<p/>").parent().html());a.document.write("</body></html");a.document.close();a.focus();a.print();a.close()}},{id:"mail_xs",label:" "+configlang.MAIL,icon:"glyphicon glyphicon-envelope",
cssClass:"btn-default hidden-md hidden-lg col-xs-3 col-sm-2 LeftOffset2",action:function(b){$(this).blur();favormails[a]=$("#tab1_"+e).wrap("<p/>").parent().html();""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail([a])}):$.open_mail([a])}}],onhidden:function(){dialogs.pop();$.show_answer();statevals.ppnlist.pop();$.push_state()},onshown:function(){dialogs.push(g);$.is_Empty(statevals)&&(statevals={});$.is_Empty(statevals.ppnlist)&&(statevals.ppnlist=[]);statevals.ppnlist.push({ppn:a,
ppnlist:b,typ:c,parentppn:d});$.opened_fullview(a,e)}});g.realize();g.getModalHeader().addClass("preview-header");config.button_checklist?(g.getButton("checklist").prop("disabled",!0),g.getButton("checklist_xs").prop("disabled",!0)):(g.getButton("checklist").hide(),g.getButton("checklist_xs").hide());config.button_export?(g.getButton("export").prop("disabled",!0),g.getButton("export_xs").prop("disabled",!0)):(g.getButton("export").hide(),g.getButton("export_xs").hide());config.button_qrcode?(g.getButton("qrcode").prop("disabled",
!0),g.getButton("qrcode_xs").prop("disabled",!0)):(g.getButton("qrcode").hide(),g.getButton("qrcode_xs").hide());config.button_mail?(g.getButton("mail").prop("disabled",!0),g.getButton("mail_xs").prop("disabled",!0)):(g.getButton("mail").hide(),g.getButton("mail_xs").hide());config.button_print?(g.getButton("print").prop("disabled",!0),g.getButton("print_xs").prop("disabled",!0)):(g.getButton("print").hide(),g.getButton("print_xs").hide());g.setData("ppn",a);g.setData("name","fullview_"+e);g.open()};
$.open_settings=function(){var a=dialogs.length,b={range:{min:1E3,max:(new Date).getFullYear()},connect:!0,behaviour:"drag",step:1};b.start=void 0!=facetvals.yearminbase&&void 0!=facetvals.yearmaxbase&&""!=facetvals.yearminbase&&""!=facetvals.yearmaxbase?[facetvals.yearminbase,facetvals.yearmaxbase]:[1E3,(new Date).getFullYear()];var c=JSON.stringify(settings),d=facetvals.datapool,e=facetvals.phonetic,f="["+facetvals.yearminbase+" TO "+facetvals.yearmaxbase+"]",k=new BootstrapDialog({message:$('<div id="settings_'+
a+'"></div>').load("/ajax/settings/"+a,function(){}),title:configlang.SETTINGS,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-tasks",label:" "+configlang.MORESETTINGS,id:"moresettings",action:function(a){$(this).blur();$.open_filters(function(){$.format_filterboxes()});$.focus_first()}},{id:"loadsettings",icon:"glyphicon glyphicon-open",label:" "+configlang.LOAD,
action:function(a){$(this).blur();settingsname="";""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_settingsview(function(){$.setup_settings()})}):$.open_settingsview(function(){$.setup_settings()});$.focus_first()}},{id:"savesettings",icon:"glyphicon glyphicon-save",label:" "+configlang.STORE,action:function(a){$(this).blur();settingsname="";""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_settingsstore(function(){""!=settingsname&&$.update_settings(function(){var a=
{settings:settings,facetvals:facetvals};$.post("/ajax/settingsstore",{name:JSON.stringify(settingsname),settings:JSON.stringify(a)},function(a){"0"<=a&&$.user_message(configlang.SETTINGSSTORESUCCESS,"success")})})})}):$.open_settingsstore(function(){""!=settingsname&&$.update_settings(function(){var a={settings:settings,facetvals:facetvals};$.post("/ajax/settingsstore",{name:JSON.stringify(settingsname),settings:JSON.stringify(a)},function(a){"0"<=a&&$.user_message(configlang.SETTINGSSTORESUCCESS,
"success")})})});$.focus_first()}},{icon:"fa fa-eraser",label:" "+configlang.CLEAR,action:function(a){$(this).blur();$("#FlexFilters li").find(".editable").each(function(){$(this).editable("setValue","",!1)});$("#communitylibraries").prop("checked",!1);$("#phoneticSwitch").prop("checked",!1);slider3.noUiSlider.set([1E3,(new Date).getFullYear()]);$.focus_first()}},{icon:"fa fa-check",label:" OK",cssClass:"fullview-button-color",action:function(a){$(this).blur();$.update_settings(function(){facetvals.typ=
"total";facetvals.formats={};facetvals.yearmin=facetvals.yearminbase;facetvals.yearmax=facetvals.yearmaxbase;facetvals.yearminstart=facetvals.yearminbase;facetvals.yearmaxstart=facetvals.yearmaxbase;facetvals.yearrange="["+facetvals.yearminbase+" TO "+facetvals.yearmaxbase+"]";c==JSON.stringify(settings)&&f==facetvals.yearrange&&d==facetvals.datapool&&e==facetvals.phonetic||$.new_search("init",$("#searchtext_md").val());a.close()})}}],onhidden:function(){dialogs.pop();$.show_answer();"undefined"!=
typeof slider3&&slider3.noUiSlider.destroy()},onshow:function(){config.lbs||k.getButton("loadsettings").hide();config.lbs||k.getButton("savesettings").hide()},onshown:function(){slider3=document.getElementById("pubyear3");noUiSlider.create(slider3,b);slider3.style.margin="10px 20px 10px 20px";slider3.noUiSlider.on("update",function(a,b){$(".yearstart2").html(Math.floor(a[0]));$(".yearend2").html(Math.floor(a[1]));facetvals.yearminbase=Math.floor(a[0]);facetvals.yearmaxbase=Math.floor(a[1])});$("#phoneticSwitch").change(function(){$(this).is(":checked")?
($("#FlexFilters li").find(".editable").each(function(){$(this).editable("setValue","",!1)}),k.getButton("moresettings").prop("disabled",!0),filters=[],$.format_filterboxes()):k.getButton("moresettings").prop("disabled",!1)});"global"==facetvals.datapool&&$("#communitylibraries").prop("checked",!0);1==facetvals.phonetic&&($("#phoneticSwitch").prop("checked",!0),k.getButton("moresettings").prop("disabled",!0));$("#titleFilterValue").html(settings.title);$("#authorFilterValue").html(settings.author);
$("#subjectFilterValue").html(settings.subject);$("#classFilterValue").html(settings.class);$("#tocFilterValue").html(settings.toc);$("#publisherFilterValue").html(settings.publisher);$("#isnFilterValue").html(settings.isn);$("#seriesFilterValue").html(settings.series);$("#idFilterValue").html(settings.id);$.format_filterboxes();$.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>';
$.fn.editableform.buttons='<button type="button" onClick="javascript:$(this).closest(\'form\').find(\'textarea, .yearinput\').val(\'\');" class="btn btn-default editbutton"><i class="fa fa-times" aria-hidden="true"></i></button> <button type="submit" class="btn fullview-button-color editbutton editable-submit"><i class="fa fa-check" aria-hidden="true"></i></button>';$(".editable").editable();$(".yearstart2").on("shown",function(a,b){b.input.$input.val($(".yearstart2").html())});$(".yearend2").on("shown",
function(a,b){b.input.$input.val($(".yearend2").html())});$(".yearstart2").on("save",function(a,b){facetvals.yearminstart=Math.floor(b.newValue);slider3.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart])});$(".yearend2").on("save",function(a,b){facetvals.yearmaxstart=Math.floor(b.newValue);slider3.noUiSlider.set([facetvals.yearminstart,facetvals.yearmaxstart])});dialogs.push(k)}});k.realize();k.getModalHeader().addClass("preview-header");k.setData("name","settings");k.open()};
$.open_settingsstore=function(a){var b=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="settingsname" class="col-sm-3 control-label">'+configlang.DESCRIPTION+'</label><div class="col-sm-9"><input type="text" class="form-control" id="settingsname" placeholder="'+configlang.DESCRIPTION+'"></div></div><div id="settingsstore_messagebar"></div></div>',title:configlang.STORE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,
action:function(a){a.close();$.focus_first();settingsname=""}},{icon:"glyphicon glyphicon-triangle-bottom",label:" "+configlang.OK,cssClass:"fullview-button-color",action:function(a){settingsname=$("#settingsname").val();a.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer();a()},onshown:function(){$("#settingsname").focus();dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","settingsstore");b.open()};
$.open_settingsview=function(a){var b=new BootstrapDialog({message:$('<div id="settingsview"></div>').load("/ajax/settingsview/",function(){}),title:configlang.LOAD,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first();settingsname=""}},{icon:"fa fa-trash-o",label:" "+configlang.DELETE,action:function(a){var b=0,c=[];$(".check_settingsload").each(function(a){1==$(this).prop("checked")&&(b++,c.push($(this).data("id")))});0==
b?$.user_message(configlang.NOOPTION,"warning"):($.open_suredialog(function(a){1==a&&$.post("/ajax/settingsdelete",{ids:JSON.stringify(c)},function(a){"0"<=a&&($("#settings_messagebar").append($("<div id='message0' class='alert-message success' data-alert></div>")),$("#message0").hide().html("<div class='panel panel-success'><div class='panel-heading'>"+configlang.SETTINGSDELETESUCCESS+"</div></div>").fadeIn("fast"),$("#message0").delay(3E3).fadeOut("slow",function(){$(this).remove()}))})}),a.close())}},
{icon:"glyphicon glyphicon-open",label:" "+configlang.LOAD,cssClass:"fullview-button-color",action:function(a){var b=0,c="";$(".check_settingsload").each(function(a){1==$(this).prop("checked")&&(b++,c=$(this).data("id"))});0==b?$.user_message(configlang.NOOPTION,"warning"):2<=b?$.user_message(configlang.ONLYONEOPTION,"warning"):($.post("/ajax/settingsload",{id:c},function(a){"0"<=a&&(settings=a.settings.settings,facetvals=a.settings.facetvals,answer.status="success",answer.message=configlang.SETTINGSLOADSUCCESS)},
"json"),a.close())}}],onhidden:function(){dialogs.pop();$.show_answer();a()},onshown:function(){$("#settingsname").focus();dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","settingsview");b.open()};
$.open_favors=function(){var a=new BootstrapDialog({message:'<div class="row" id="favors"></div><div id="favor_messagebar"></div>',title:"Merkliste "+config.softwarename,closable:!0,size:BootstrapDialog.SIZE_WIDE,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close()}},{id:"print",icon:"fa fa-print",label:" "+configlang.PRINT,action:function(a){$(this).blur();if(0<Object.keys(favorprint).length){a=window.open();a.document.write("<html><head><title>"+
xtitle+"</title></head><body><p><img src='"+urlport+window.location.host+"/"+config.printlogo+"' style='max-width:300px;' />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span><b>"+config.softwarename+" - "+urlport+window.location.host+"</b></span></p>");for(var b=Object.keys(favorprint),d=0,e=b.length;d<e;d++)a.document.write(favorprint[b[d]]),d<e-1&&a.document.write("<hr>");a.document.write("</body></html");a.document.close();a.focus();a.print();a.close()}}},{id:"mail",icon:"glyphicon glyphicon-envelope",
label:" "+configlang.MAIL,action:function(a){$(this).blur();""==usrconfig?$.login("LOGINFIRST",function(){""!=usrconfig&&$.open_mail(Object.keys(favors))}):$.open_mail(Object.keys(favors))}},{id:"export",icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,action:function(a){$(this).blur();$.open_export(Object.keys(favors))}},{icon:"fa fa-eraser",label:" "+configlang.CHECKLISTCLEAR,action:function(a){$(this).blur();favors={};favorprint={};favormail={};answer.status="success";answer.message=
configlang.CHECKLISTCLEARSUCCESS;a.close()}}],onhidden:function(){dialogs.pop();$.show_answer();$.focus_first()},onshown:function(){dialogs.push(a);$.update_favors()}});a.realize();a.getModalHeader().addClass("preview-header");config.button_export||a.getButton("export").hide();config.button_mail||a.getButton("mail").hide();config.button_print||a.getButton("print").hide();a.setData("name","favors");a.open()};
$.open_filters=function(a){var b="<div id='filterbody'><ul class='list-group'>";$.each({title:configlang.TITLE,author:configlang.AUTHOR,subject:configlang.SUBJECT,class:configlang.CLASS,publisher:configlang.PUBLISHER,toc:configlang.TOC,id:configlang.ID,series:configlang.SERIES,isn:configlang.ISN},function(a,c){b+="<li class='list-group-item'>";b+=c;b+="<div class='material-switch pull-right'>";b+="<input id='"+a+"Filter' value='"+a+"' class='"+a+"Filter filter' type='checkbox'";-1<filters.indexOf(a)&&
(b+=" checked");b+=" />";b+="<label for='"+a+"Filter' class='noUi-connect'></label>";b+="</div>";b+="</li>"});b+="</ul></div>";var c=new BootstrapDialog({message:b,title:configlang.MORESETTINGS,size:BootstrapDialog.SIZE_SMALL,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-triangle-bottom",label:" "+configlang.OK,cssClass:"fullview-button-color",action:function(b){filters=$("#filterbody").find(".filter:checked").map(function(){return this.value}).get();
a();b.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(c)}});c.realize();c.getModalHeader().addClass("preview-header");c.setData("name","filter");c.open()};
$.open_suredialog=function(a){var b=!1,c=new BootstrapDialog({title:configlang.AREYOUSURE,message:configlang.AREYOUSURE,size:BootstrapDialog.SIZE_SMALL,closable:!0,buttons:[{icon:"fa fa-ban",label:" "+configlang.NO,action:function(a){a.close();b=!1}},{icon:"fa fa-check",label:" "+configlang.YES,action:function(a){a.close();b=!0}}],onhidden:function(){a(b)}});c.realize();c.getModalHeader().addClass("preview-header");c.setData("name","sure");c.open()};
$.open_user=function(a){a=$('<div id="userbody"></div>').load("/ajax/userview/"+a);if("ERROR:"==$.trim(a).substr(0,6).toUpperCase())$.user_message($.trim(a).slice(6),"warning");else{var b=new BootstrapDialog({message:a,title:configlang.AREA+" "+usrconfig.firstname+" "+usrconfig.lastname,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-triangle-bottom",label:" "+
configlang.OK,cssClass:"fullview-button-color",action:function(a){a.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","user");b.open()}};
$.open_qrcode=function(){var a=window.location.href,b=new BootstrapDialog({message:'<div class="form-horizontal"><h4>'+configlang.QRCODELONG+':</h4><div id="qrcodeCanvas"></div><div id="qrcode_messagebar"></div></div>',title:configlang.QRCODE,size:BootstrapDialog.SIZE_SMALL,closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){status=-1;a.close()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshow:function(){},onshown:function(){$("#qrcodeCanvas").qrcode({text:a});
dialogs.push(b)}});b.realize();b.getModalHeader().addClass("preview-header");b.setData("name","qrcode");b.open()};
$.open_mail=function(a){if(""!=usrconfig){void 0!=usrconfig.email&&""!=usrconfig.email||$.user_message(configlang.PROVIDEMAIL,"warning");var b=usrconfig.email,c=(usrconfig.firstname+" "+usrconfig.lastname).trim(),d=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="mailto" class="col-sm-3 control-label">'+configlang.MAILRECIPIENT+'</label><div class="col-sm-9"><input type="mail" class="form-control" id="mailto" placeholder="'+configlang.MAILRECIPIENT+'"></div></div><div class="form-group"><label for="msg" class="col-sm-3 control-label">'+
configlang.YOURMESSAGE+'</label><div class="col-sm-9"><textarea class="form-control" rows="5" id="msg" placeholder="'+configlang.YOURMESSAGE+'"></textarea></div></div><div id="mail_messagebar"></div></div>',title:configlang.SENDMAIL,closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){status=-1;a.close()}},{icon:"glyphicon glyphicon-log-in",label:" "+configlang.SENDMAIL,cssClass:"fullview-button-color",action:function(d){$(this).blur();username=$("#username").val();
mailfrom=$("#mailfrom").val();mailto=$("#mailto").val();msg=$("#msg").val();if(""==mailto)return $.user_message(configlang.REQUIREDFIELD,"warning"),$("#mailto").focus(),-1;if(!$.validateEmail(mailto))return $.user_message(configlang.MAILWRONG,"warning"),$("#mailto").focus(),-1;$.post("/ajax/mailto",{ppnlist:JSON.stringify(a),username:JSON.stringify(c),mailfrom:b,mailto:mailto,msg:JSON.stringify(msg),fullbody:JSON.stringify(favormails)},function(a){"0"<=a&&($.user_message(configlang.MAILSUCCESS,"success"),
d.close())})}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(d);$("#username").focus()}});d.realize();d.getModalHeader().addClass("preview-header");d.setData("name","mail");d.open()}};
$.open_export=function(a){exportdialog=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label class="col-sm-2">Format</label><div class="col-sm-10"><div class="radio"><label><input type="radio" name="export" id="refworks" value="refworks" checked>refWorks</label></div><div class="radio"><label><input type="radio" name="export" id="citavi" value="citavi">Citavi</label></div><div class="radio"><label><input type="radio" name="export" id="endnote" value="endnote">Endnote</label></div><div class="radio"><label><input type="radio" name="export" id="bibtex" value="bibtex">BibTeX</label></div></div><div id="export_messagebar"></div></div></div>',title:configlang.EXPORT,
closable:!1,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){$(this).blur();status=-1;a.close()}},{icon:"glyphicon glyphicon-export",label:" "+configlang.EXPORT,cssClass:"fullview-button-color",action:function(b){$(this).blur();var c=$("input[name=export]:checked").val();"refworks"==c?$.post("/ajax/exportlink",{ppnlist:JSON.stringify(a),format:c},function(a){""!=a&&$.each(a,function(a,b){window.open(b,"_blank")})},"json"):window.open(urlport+window.location.host+
"/exportfilelist/"+a+"/"+c,"_blank");b.close()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(exportdialog)}});exportdialog.realize();exportdialog.getModalHeader().addClass("preview-header");exportdialog.setData("name","export");exportdialog.open()};
$.open_wait=function(){waitdialog=new BootstrapDialog({message:'<div class="outercircle"></div><div class="innercircle"></div>',cssClass:"wait",animate:!1,closable:!1});waitdialog.realize();waitdialog.getModalHeader().hide();waitdialog.getModalFooter().hide();waitdialog.open()};
$.open_password=function(){var a=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="kennung" class="col-sm-5 control-label">'+configlang.OLDPASSWORD+'</label><div class="col-sm-7"><input type="password" class="form-control keyenter" id="oldpassword" placeholder="'+configlang.OLDPASSWORD+'"></div></div><div class="form-group"><label for="passwort" class="col-sm-5 control-label">'+configlang.NEWPASSWORD1+'</label><div class="col-sm-7"><input type="password" class="form-control keyenter" id="newpasswort1" placeholder="'+
configlang.NEWPASSWORD1+'"></div></div><div class="form-group"><label for="passwort" class="col-sm-5 control-label">'+configlang.NEWPASSWORD2+'</label><div class="col-sm-7"><input type="password" class="form-control keyenter" id="newpasswort2" placeholder="'+configlang.NEWPASSWORD2+'"></div></div><div id="password_messagebar"></div></div>',title:configlang.CHANGEPASSWORD,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},
{icon:"fa fa-repeat",label:" "+configlang.CHANGEPASSWORD,cssClass:"fullview-button-color",id:"changepwbutton",action:function(a){$(this).blur();old=$("#oldpassword").val().trim();new1=$("#newpasswort1").val().trim();new2=$("#newpasswort2").val().trim();if(""==old||""==new1||""==new2)return $.user_message(configlang.REQUIREDALLFIELDS,"warning"),""==old?$("#oldpassword").focus():""==newpasswort1?$("#newpasswort1").focus():$("#newpasswort2").focus(),-1;if(new1!=new2)return $.user_message(configlang.PASSWORDSWRONG,
"warning"),$("#newpasswort1").val(""),$("#newpasswort2").val(""),$("#newpasswort1").focus(),-1;$.post("/ajax/changepw",{old:old,new:new2},function(b){"-2"!=b.status?(a.close(),answer.status="success",answer.message=configlang.PASSWORDSUCCESS):($.user_message(b.error,"warning"),$("#oldpassword").focus())},"json")}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(a);$("#oldpassword").focus();$(".keyenter").keypress(function(a){13==a.which&&($(this).blur(),$("#changepwbutton").focus().click())})}});
a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","password");a.open()};
$.login=function(a,b){var c="",d="",e=new BootstrapDialog({message:'<div class="form-horizontal"><div class="form-group"><label for="kennung" class="col-sm-3 control-label">'+configlang.USERNAME+'</label><div class="col-sm-9"><input type="text" class="form-control keyenter" id="kennung" placeholder="'+configlang.USERNAME+'"></div></div><div class="form-group"><label for="passwort" class="col-sm-3 control-label">'+configlang.PASSWORD+'</label><div class="col-sm-9"><input type="password" class="form-control keyenter" id="passwort" placeholder="'+
configlang.PASSWORD+'"></div></div><div id="login_messagebar"></div></div>',title:"Login "+config.softwarename,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-log-in",label:" "+configlang.LOGIN,cssClass:"fullview-button-color",id:"loginbutton",action:function(a){$(this).blur();user=$("#kennung").val().trim();pw=$("#passwort").val().trim();if(""==user||""==pw)return $.user_message(configlang.REQUIREDTWOFIELDS,
"warning"),""==user?$("#kennung").focus():$("#passwort").focus(),-1;$.post("/ajax/login",{user:user,pw:pw},function(b){"-1"!=b?(a.close(),$(".nologinarea").addClass("hide"),$(".loginarea").removeClass("hide"),usrconfig=b,timer=!0,$.startTimer(),answer.status="success",answer.message=configlang.LOGINSUCCESS.replace("{firstname}",b.firstname).replace("{lastname}",b.lastname),b.message&&(c="warning",d=b.messagetext)):($.user_message(configlang.LOGINERROR,"warning"),$("#kennung").focus(),usrconfig="");
$.focus_first()},"json")}}],onhidden:function(){dialogs.pop();$.show_answer();""!=c&&$.user_message(d,c,1E4);b()},onshown:function(){dialogs.push(e);"1"==config.devmode&&($("#kennung").val(config.devuser),$("#passwort").val(config.devpassword));$("#kennung").focus();$(".keyenter").keypress(function(a){13==a.which&&($(this).blur(),$("#loginbutton").focus().click())});void 0!=a&&""!=a&&$.user_message(configlang[a],"warning")}});e.realize();e.getModalHeader().addClass("preview-header");e.setData("name",
"login");e.open()};$.loginonly=function(){$.login("",function(){})};
$.logout=function(){var a=new BootstrapDialog({message:"<div>"+configlang.LOGOUTREALLY.replace("{system}",config.softwarename)+'<div id="logout_messagebar"></div></div>',title:"Logout "+config.softwarename,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"glyphicon glyphicon-log-out",label:" "+configlang.LOGOUT,cssClass:"fullview-button-color",action:function(a){$.post("/ajax/logout",function(b){a.close();$(".nologinarea").removeClass("hide");
$(".loginarea").addClass("hide");$.reset_session()},"json")}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(a)}});a.realize();a.getModalHeader().addClass("preview-header");a.setData("name","logout");a.open()};
$.shelve=function(a,b,c){var d=b="",e;for(e in c)"action"!=e&&"typ"!=e&&"id"!=e&&""!=c[e]&&(""==d&&(d=e.replace(/\d/g,"")),""!=d&&d!=e.replace(/\d/g,"")&&(d=e.replace(/\d/g,""),b+="<br />"),b+=c[e].replace(/%lt%/g,"&lt;").replace(/%gt%/g,"&gt;")+"<br />");b+='<br /><div id="shelve_messagebar"></div>';c=$("#"+a+" div.panel-heading").html();void 0==c&&(c=$("#related_"+a).html());var f=new BootstrapDialog({message:b,title:c,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,
action:function(a){a.close();$.focus_first()}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(f)}});f.realize();f.getModalHeader().addClass("preview-header");f.setData("name","shelve");f.open()};
$.reservation=function(a,b,c){if(void 0!=c.id){var d=b="";for(f in c)if("action"!=f&&"typ"!=f&&"id"!=f&&""!=c[f])if(""==d&&(d=f.replace(/\d/g,"")),""!=d&&d!=f.replace(/\d/g,"")&&("radio"!=d&&(b+="<br />"),d=f.replace(/\d/g,"")),"radio"==d)if("radio0"==f)b+=c[f]+"<br />";else{var e=c[f].split("|");b+="<div class='radio'><label><input type='radio' value='"+e[0]+"' name='counter'>"+e[1]+"</label></div>"}else b="hidden"==d?b+("<input class='hidden' type='text' value='"+c[f]+"' name='counter'>"):b+(c[f].replace(/%lt%/g,
"&lt;").replace(/%gt%/g,"&gt;")+"<br />");b+='<div id="reservation_messagebar"></div>';var f=$("#"+a+" div.panel-heading").html();void 0==f&&(f=$("#related_"+a).html());var k=new BootstrapDialog({message:b,title:f,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.RESERVATION,cssClass:"fullview-button-color",action:function(a){$(this).blur();var b="";if($("input[name='counter']").length)if($("input[name='counter']").is(":hidden"))b=
$("input[name='counter']:hidden").val();else{if(!$("input[name='counter']").is(":checked")){$.user_message(configlang.SELECTDESK,"warning");return}b=$("input[name='counter']:checked").val()}$.request(c.id,configlang.RESERVATIONSUCCESS,b,function(b){"warning"==b.status?($.user_message(b.message,b.status),b.message="",b.status=""):a.close()})}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(k)}});k.realize();k.getModalHeader().addClass("preview-header");k.setData("name",
"reservation");k.open()}};
$.order=function(a,b,c){if(void 0!=c.id){var d=b="";for(f in c)if("action"!=f&&"typ"!=f&&"id"!=f&&""!=c[f])if(""==d&&(d=f.replace(/\d/g,"")),""!=d&&d!=f.replace(/\d/g,"")&&("radio"!=d&&(b+="<br />"),d=f.replace(/\d/g,"")),"radio"==d)if("radio0"==f)b+=c[f]+"<br />";else{var e=c[f].split("|");b+="<div class='radio'><label><input type='radio' value='"+e[0]+"' name='counter'>"+e[1]+"</label></div>"}else b="hidden"==d?b+("<input class='hidden' type='text' value='"+c[f]+"' name='counter'>"):b+(c[f].replace(/%lt%/g,
"&lt;").replace(/%gt%/g,"&gt;")+"<br />");b+='<div id="order_messagebar"></div>';var f=$("#"+a+" div.panel-heading").html();void 0==f&&(f=$("#related_"+a).html());var k=new BootstrapDialog({message:b,title:f,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"fa fa-map-marker",label:" "+configlang.ORDER,cssClass:"fullview-button-color",action:function(a){$(this).blur();var b="";if($("input[name='counter']").length)if($("input[name='counter']").is(":hidden"))b=
$("input[name='counter']:hidden").val();else{if(!$("input[name='counter']").is(":checked")){$.user_message(configlang.SELECTDESK,"warning");return}b=$("input[name='counter']:checked").val()}$.request(c.id,configlang.ORDERSUCCESS,b,function(b){"warning"==b.status?($.user_message(b.message,b.status),b.message="",b.status=""):a.close()})}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(){dialogs.push(k)}});k.realize();k.getModalHeader().addClass("preview-header");k.setData("name",
"order");k.open()}};
$.request=function(a,b,c,d){""==usrconfig?$.login("LOGINFIRST",function(){$.post("/ajax/request",{uri:a,desk:c},function(a){0>a.status?(answer.status="warning",answer.message=configlang.PROCESSSTOPPED+"<br />"+a.error):(answer.status="success",answer.message=b);d(answer)},"json")}):$.post("/ajax/request",{uri:a,desk:c},function(a){0>a.status?(answer.status="warning",answer.message=configlang.PROCESSSTOPPED+"<br />"+a.error):(answer.status="success",answer.message=b);d(answer)},"json")};
$.mailorder=function(a,b,c){var d=$("#"+a+" div.panel-heading").html();void 0==d&&(d=$("#related_"+a).html());var e="ORDER",f="MAILORDER",k="Magazinbestellung",h=new BootstrapDialog({message:$('<div id="mailorderviewbody"></div>').load("/ajax/mailorderview/"+a+"/"+b,function(a,b,c){e=$(a).wrapAll($("<div>")).parent().find("#mailbutton").attr("value").toString();f=$(a).wrapAll($("<div>")).parent().find("#mailtyp").attr("value").toString();k=$(a).wrapAll($("<div>")).parent().find("#mailsubject").attr("value").toString();
h.getButton("mailbtn").html("<span class='bootstrap-dialog-button-icon fa fa-map-marker'></span> "+e)}),title:d,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{id:"mailbtn",icon:"fa fa-map-marker",label:" "+configlang.ORDER,cssClass:"fullview-button-color",action:function(b){$(this).blur();var d=$("input[name=mailto]:checked").val();void 0==d&&(d=$("#mailto").attr("value"));if(void 0==d)return $.user_message("Die MailTo-Adresse konnte nicht ermittelt werden!",
"warning"),-1;var e=$("input[name=mailfrom]:checked").val();void 0==e&&(e=$("#mailfrom").attr("value"));if(void 0==e)return $.user_message("Die MailFrom-Adresse konnte nicht ermittelt werden!","warning"),-1;if(""==usrconfig)$.login("LOGINFIRST",function(){var g={},h=$("input[name=volume]").val();void 0!=h&&(g.volume=h);h=$("#mail_"+(dialogs.length-2)).wrap("<p/>").parent().html();$.post("/ajax/mailorderto",{exemplar:JSON.stringify(c),fullbody:JSON.stringify(h),ppn:a,mailto:d,mailfrom:e,userinput:JSON.stringify(g),
mailtyp:f,mailsubject:k},function(a){if(0>a.status){if(-3==a.status)return $.user_message(a.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning")}else answer.status="success",answer.message=configlang.ORDERSUCCESS,b.close()},"json")});else{var g={},h=$("input[name=volume]").val();void 0!=h&&(g.volume=h);h=$("#mail_"+(dialogs.length-2)).wrap("<p/>").parent().html();$.post("/ajax/mailorderto",{exemplar:JSON.stringify(c),fullbody:JSON.stringify(h),ppn:a,mailto:d,mailfrom:e,
userinput:JSON.stringify(g),mailtyp:f,mailsubject:k},function(a){if(0>a.status){if(-3==a.status)return $.user_message(a.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning")}else answer.status="success",answer.message=configlang.ORDERSUCCESS,b.close()},"json")}}}],onhidden:function(){dialogs.pop();$.show_answer()},onshown:function(a){dialogs.push(h)}});h.realize();h.getModalHeader().addClass("preview-header");h.setData("name","mailorder");h.open()};
$.cancel=function(a,b){$.post("/ajax/cancel",{uri:a},function(a){if(0>a.status){if(-3==a.status)return $.user_message(a.error,"warning"),!1;$.user_message(configlang.PROCESSSTOPPED+"<br />"+a.error,"warning")}else $("#reservation_"+b).hide(),$.user_message(configlang.CANCELSUCCESS,"success")},"json")};
$.renew=function(){$(".status_renew").html("");$(".check_renew").each(function(a){if(1==$(this).prop("checked")){$(this).prop("checked",!1);a=$(this).data("item");var b=a.substring(a.lastIndexOf("$")+1);$.post("/ajax/renew",{uri:a},function(a){if(-3==a.status)return $.user_message(a.error,"warning"),!1;-2==a.status?($("#status_renew_"+b).html('<font color="red"><a href="#" data-toggle="tooltip" title="'+a.error+'"><i class="fa fa-exclamation" aria-hidden="true"></i></font>'),$("#checkbox_renew_"+
b).html("")):($("#status_renew_"+b).html('<font color="green"><i class="fa fa-check" aria-hidden="true"></i></font>'),$("#return_renew_"+b).html(a.endtime),0<maxrenewals?($("#renewals_renew_"+b).html(a.renewals+" / "+maxrenewals),parseInt(a.renewals)>=maxrenewals&&$("#checkbox_renew_"+b).html("")):$("#renewals_renew_"+b).html(a.renewals))},"json")}});$(".btn-renew").blur()};
$(function(){$.load_config();$.update_favs();$(".lang li a").click(function(){"ger"==$(this).data("value")?($(".lang_ger").removeClass("hide"),$(".lang_eng").addClass("hide")):($(".lang_ger").addClass("hide"),$(".lang_eng").removeClass("hide"));$.set_language($(this).data("value"),!0)});$(".layout li a").click(function(){$.set_layout($(this).data("value"),!0)});$(window).scroll(function(){Scroll&&$(window).scrollTop()+500>=$(document).height()-$(window).height()&&$.search_next_pack(function(){})});
window.scrollTo(0,0);var a=$(".typeahead");a.typeahead({source:function(a,c){if(void 0==a||""==a.trim())return c({});$.get("/ajax/getwords",{query:JSON.stringify(a)},function(a){return c(a)},"json")},autoSelect:!1,delay:300,afterSelect:function(a){$.new_search("init",a)}});a.keydown(function(a){if(13==a.keyCode||9==a.keyCode){a=$(".navbar:visible").find(".search_text").val().trim();var b=$("ul.typeahead.dropdown-menu:visible").find("li.active").text();void 0!=b&&(b=b.trim());b?b==a?$.new_search("init",
a):$.new_search("init",b):$.new_search("init",a);event.preventDefault()}});window.onpopstate=function(a){$.close_dialogs();$("#facets").fadeOut("fast").addClass("collapse");$("#results").addClass("collapse");$("#resultsonly").html("");$("#loading").fadeOut("fast").addClass("collapse");null!=a.state&&0<Object.keys(a.state).length?(appstate.first=!0,$.init_client(a.state.sets),$.new_search("initfacets",a.state.search),document.title=a.state.text+" | "+xtitle):($("#start").fadeIn("fast").removeClass("collapse"),
$("#searchtext_xs").val(""),$("#searchtext_md").val(""))};$(".search_text").keyup(function(){$(".search_clear").toggle(!!$(this).val())});$(".search_clear").click(function(){$(".search_text").val("").focus();$(this).hide()});$.focus_first()});
