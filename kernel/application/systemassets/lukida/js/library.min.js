var urlport=location.protocol+"//",configlang={},config={},messid=0,params={areas:[],start:moment().subtract(8,"days").format("YYYY-MM-DD"),end:moment().subtract(1,"days").format("YYYY-MM-DD")},chart="searches",bstacked=!1;$.go=function(a){"discover"==a&&(window.location.href=urlport+window.location.host)};$.refresh=function(){$.set_chart(chart)};
$.toggle_area=function(a){$("#"+a+"up").toggleClass("collapse");$("#"+a+"down").toggleClass("collapse");$("#library"+a).is(":hidden")?$("#library"+a).slideDown("slow"):$("#library"+a).slideUp("slow")};$.set_params=function(){params.areas="";$(".well").find(":checkbox").each(function(){"Stapel"==$(this).attr("name")?bstacked=this.checked?!0:!1:params.areas=""==params.areas?params.areas+(this.checked?$(this).data("value"):""):params.areas+(this.checked?","+$(this).data("value"):"")})};
$.set_chart=function(a){chart!=a&&($("#libraryoption").is(":visible")&&$("#libraryoption").slideUp("slow",function(){$("#optionup").toggleClass("collapse");$("#optiondown").toggleClass("collapse")}),$("#libraryoption").find(".well").hide(),$("#libraryoption").find("."+a).show(),$("#libraryhelp").is(":visible")&&$("#libraryhelp").slideUp("slow",function(){$("#helpup").toggleClass("collapse");$("#helpdown").toggleClass("collapse")}),$("#libraryhelp").find(".well").hide(),$("#libraryhelp").find("."+
a).show());chart=a;"searches"==a&&$.ajax({url:"/ajax/chart",method:"POST",dataType:"JSON",data:{typ:"searches",params:JSON.stringify(params)},success:function(a){void 0!==window.myChart&&window.myChart.destroy();var b=$("#chart");window.myChart=new Chart(b,{type:"bar",data:a.data,options:{title:a.title,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})}});"usage"==a&&$.ajax({url:"/ajax/chart",method:"POST",dataType:"JSON",data:{typ:"usage",params:JSON.stringify(params)},success:function(a){void 0!==window.myChart&&
window.myChart.destroy();var b=$("#chart");window.myChart=new Chart(b,{type:"line",data:a.data,options:{title:a.title,scales:{yAxes:[{ticks:{beginAtZero:!0},stacked:bstacked}]}}})}})};
$.set_language=function(a,c){$.post("/ajax/language",{language:a},function(b){configlang=b;$(".ger").html(configlang.GER);$(".eng").html(configlang.ENG);$(".selectlanguage").attr("title",configlang.SELECTLANGUAGE);config.language=a;"ger"==a?($(".lang_ger").removeClass("hide"),$(".lang_eng").addClass("hide")):($(".lang_ger").addClass("hide"),$(".lang_eng").removeClass("hide"));$.refresh();c||$.user_message(configlang.LANGUAGECHANGED,"success")},"json")};
$.user_message=function(a,c,b){void 0==b&&(b=3E3);var d="success"==c?"panel-success":"panel-danger";messid++;$("#statusbar_messagebar").append($("<div id='message"+messid+"' class='alert-message "+c+"' data-alert></div>"));$("#message"+messid).hide().html("<div class='panel "+d+"'><div class='panel-heading'>"+a+"</div></div>").fadeIn("fast");$("#message"+messid).delay(b).fadeOut("slow",function(){$(this).remove()})};
$(function(){$(".lang li a").click(function(){$.set_language($(this).data("value"),!1)});$(".chart li a").click(function(){$.set_chart($(this).data("value"))});$.set_params();$(".well").find(":checkbox").click(function(){$.set_params();$.refresh()});$("#daterange").daterangepicker({showISOWeekNumbers:!0,autoApply:!0,dateLimit:{months:6},ranges:{Heute:[moment().format("DD.MM.YYYY"),moment().format("DD.MM.YYYY")],Gestern:[moment().subtract(1,"days").format("DD.MM.YYYY"),moment().subtract(1,"days").format("DD.MM.YYYY")],
"Letzten 7 Tage":[moment().subtract(8,"days").format("DD.MM.YYYY"),moment().subtract(1,"days").format("DD.MM.YYYY")],"Letzten 30 Tage":[moment().subtract(31,"days").format("DD.MM.YYYY"),moment().subtract(1,"days").format("DD.MM.YYYY")],"Letzten 60 Tage":[moment().subtract(61,"days").format("DD.MM.YYYY"),moment().subtract(1,"days").format("DD.MM.YYYY")],"Letzten 90 Tage":[moment().subtract(91,"days").format("DD.MM.YYYY"),moment().subtract(1,"days").format("DD.MM.YYYY")],"Dieser Monat":[moment().startOf("month").format("DD.MM.YYYY"),
moment().subtract(1,"days").format("DD.MM.YYYY")],"Letzter Monat":[moment().startOf("month").subtract(1,"months").format("DD.MM.YYYY"),moment().startOf("month").subtract(1,"days").format("DD.MM.YYYY")]},locale:{format:"DD.MM.YYYY",separator:" - ",applyLabel:"Fertig",cancelLabel:"Abbrechen",fromLabel:"Von",toLabel:"Bis",customRangeLabel:"Eigener Zeitraum",weekLabel:"W",daysOfWeek:"So Mo Di Mi Do Fr Sa".split(" "),monthNames:"Januar Februar M\u00e4rz April Mai Juni Juli August September Oktober November Dezember".split(" "),
firstDay:1},startDate:moment().add(-8,"days").format("DD.MM.YYYY"),endDate:moment().add(-1,"days").format("DD.MM.YYYY")},function(a,c,b){params.start=a.format("YYYY-MM-DD");params.end=c.format("YYYY-MM-DD");$.refresh()});$(".open-daterange").click(function(a){a.preventDefault();$("#daterange").click()});config.lang="ger";$.set_language(config.lang,!0)});
