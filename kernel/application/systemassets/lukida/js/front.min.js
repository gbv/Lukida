var facetvals={datapool:"",yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",typ:"total",formats:{}},urlport=location.protocol+"//",dialogs=[],config,configlang;$.load_config=function(){$.post("/ajax/config",function(a){config=a;$.set_language(config.language,!0)},"JSON")};$.set_language=function(a,d){$.post("/ajax/language",{language:a},function(c){configlang=c;config.language=a;$.focus_first()},"json")};
$.front_search=function(a){a=$(a).val();facetvals={datapool:facetvals.datapool,yearrange:"",yearmin:"",yearmax:"",yearminstart:"",yearmaxstart:"",typ:"total",formats:{}};a=a.replace(/:/g,"{colon}");""==a.trim()&&(a="{star}");window.location=urlport+window.location.host+"/"+a+"/"+window.btoa(unescape(encodeURIComponent(JSON.stringify(facetvals))))};$.focus_first=function(){768<=$(window).width()?$('[type="text"]:input:enabled:visible:first').focus():$("button:enabled:visible:first").focus()};
$.cleanArray=function(a){for(var d=0;d<a.length;d++)if(void 0==a[d].trim()||""==a[d].trim())a.splice(d,1),d--;return a};
$.open_assistant=function(){var a=dialogs.length,d=new BootstrapDialog({message:$('<div id="assistant_'+a+'"></div>').load("/ajax/assistant/"+a),title:configlang.ASSISTANT,size:BootstrapDialog.SIZE_WIDE,closable:!0,buttons:[{icon:"glyphicon glyphicon-menu-up",label:" "+configlang.CANCEL,action:function(a){a.close();$.focus_first()}},{icon:"fa fa-eraser",label:" "+configlang.CLEAR,action:function(c){$("#title_"+a+" textarea").val("");$("#author_"+a+" textarea").val("");$("#subject_"+a+" textarea").val("");
$("#class_"+a+" textarea").val("");$("#toc_"+a+" textarea").val("");$("#year_"+a+" textarea").val("");$("#publisher_"+a+" textarea").val("");$("#isn_"+a+" textarea").val("");$("#series_"+a+" textarea").val("");$("#id_"+a+" textarea").val("");$.focus_first()}},{icon:"glyphicon glyphicon-search",label:" "+configlang.STARTSEARCH,cssClass:"fullview-button-color",action:function(c){var b=c="",b=$.cleanArray($("#title_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" title("+b.join(",")+")");b=$.cleanArray($("#author_"+
a+" textarea").val().split("\n"));0<b.length&&(c+=" author("+b.join(",")+")");b=$.cleanArray($("#subject_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" subject("+b.join(",")+")");b=$.cleanArray($("#class_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" class("+b.join(",")+")");b=$.cleanArray($("#toc_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" toc("+b.join(",")+")");b=$.cleanArray($("#year_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" year("+b.join(",")+")");b=$.cleanArray($("#publisher_"+
a+" textarea").val().split("\n"));0<b.length&&(c+=" publisher("+b.join(",")+")");b=$.cleanArray($("#isn_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" isn("+b.join(",")+")");b=$.cleanArray($("#series_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" series("+b.join(",")+")");b=$.cleanArray($("#id_"+a+" textarea").val().split("\n"));0<b.length&&(c+=" id("+b.join(",")+")");$(".search_text").val(c);$.front_search(".search_text")}}]});d.realize();d.getModalHeader().addClass("preview-header");
d.setData("name","assistant_"+a);d.open()};$(function(){$.load_config();$.focus_first()});
